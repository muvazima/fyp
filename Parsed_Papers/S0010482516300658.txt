@&#MAIN-TITLE@&#Automatic segmentation of cartilage in high-field magnetic resonance images of the knee joint with an improved voxel-classification-driven region-growing algorithm using vicinity-correlated subsampling

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Voxel-classification-based segmentation suffers from high dimensionality of MR images.


                        
                        
                           
                           Subsampling of voxels and feature selection can reduce complexity of classification.


                        
                        
                           
                           Random voxel subsampling in training data causes poor cartilage segmentation results.


                        
                        
                           
                           Vicinity-correlated subsampling of voxels improves cartilage segmentation accuracies.


                        
                        
                           
                           A small subset of significant features is adequate to segment cartilage compartments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Knee joint

Cartilage

High-field MR images

Classification

Region-growing

Subsampling

@&#ABSTRACT@&#


               
               
                  Anatomical structures that can deteriorate over time, such as cartilage, can be successfully delineated with voxel-classification approaches in magnetic resonance (MR) images. However, segmentation via voxel-classification is a computationally demanding process for high-field MR images with high spatial resolutions. In this study, the whole femoral, tibial, and patellar cartilage compartments in the knee joint were automatically segmented in high-field MR images obtained from Osteoarthritis Initiative using a voxel-classification-driven region-growing algorithm with sample-expand method. Computational complexity of the classification was alleviated via subsampling of the background voxels in the training MR images and selecting a small subset of significant features by taking into consideration systems with limited memory and processing power. Although subsampling of the voxels may lead to a loss of generality of the training models and a decrease in segmentation accuracies, effective subsampling strategies can overcome these problems. Therefore, different subsampling techniques, which involve uniform, Gaussian, vicinity-correlated (VC) sparse, and VC dense subsampling, were used to generate four training models. The segmentation system was experimented using 10 training and 23 testing MR images, and the effects of different training models on segmentation accuracies were investigated. Experimental results showed that the highest mean Dice similarity coefficient (DSC) values for all compartments were obtained when the training models of VC sparse subsampling technique were used. Mean DSC values optimized with this technique were 82.6%, 83.1%, and 72.6% for femoral, tibial, and patellar cartilage compartments, respectively, when mean sensitivities were 79.9%, 84.0%, and 71.5%, and mean specificities were 99.8%, 99.9%, and 99.9%.
               
            

@&#INTRODUCTION@&#

Automated segmentation and three-dimensional (3-D) modeling of anatomical structures in medical images has attracted significant interest from researchers since the invention of volumetric medical imaging modalities, such as computed tomography (CT) and magnetic resonance (MR) imaging. These technologies have paved way for possibilities of quantitative and visual analyses that can benefit clinical diagnoses and treatments, surgical interventions, pharmaceutical research, and educational activities [1–3]. One such particular anatomical region of interest has been the knee joint. Because structural changes in the joint compartments, especially deterioration of cartilaginous tissues, indicate strong correlation with osteoarthritis, quantification and visualization of the cartilage can establish evidence or the progression of this disease as well as the effectiveness of therapeutic or surgical practices.

The reliability of MR imaging in morphological assessment and quantification of cartilage has been proven by a number of segmentation studies validated through the method of water displacement of surgically retrieved tissues using cadaveric or amputated joints or patient joints prior to total knee arthroplasty [4]. Particularly effective for representing cartilage tissue are high-field MR images, which are generated by scanners with magnetic strength greater than 1.5T, and some MR imaging standards, which involve fat-suppressed (FS) T1-weighted spoiled gradient echo (SPGR), or water-selective excitation 3-D double echo in the steady state (DESS) [5]. Consequently, with better inter-tissue contrast and high-quality imaging capabilities, MR images have been widely preferred in the literature to realize the segmentation of articular cartilage in the knee joint.

Osteoarthritis is a joint disease that leads to articular pain, stiffness, and swelling due to significant deterioration or destruction of cartilage, which enables efficient movement of the joint by reducing the friction between the bones in the joint. The disease is mainly caused by aging, injury, poor posture, and excess weight, so more prevalent in developed countries with large populations of the elderly and obese people.

One of the joints mostly affected by osteoarthritis is the knee joint that is also one of the largest and strongest joints in the human body. Some of the anatomical structures of the knee joint include the bones of femur, tibia, and patella, cartilage tissue compartments that surround articular surfaces of these bones, synovial fluid, ligaments, muscles, and menisci. Cartilaginous compartments of the knee joint are femoral cartilage (FC) that covers the surface of inferior femur, tibial cartilage (TC) that covers the surface of superior tibia, and patellar cartilage (PC) that covers the surface of posterior patella. TC consists of two components called the lateral tibial cartilage (LTC) and medial tibial cartilage (MTC). Similarly, medial and lateral parts of FC are called as medial femoral cartilage (MFC) and lateral femoral cartilage (LFC). A greater portion of FC interacts with LTC and MTC in tibiofemoral joint while a small portion of FC interacts with PC in patellofemoral joint. 
                        Fig. 1 depicts these cartilaginous compartments that were segmented semi-manually in MR images, as 3-D models and in an MR image slice with a sagittal view, cross-sectional view orthogonal to the left-right directions of the human body.

Studies aimed at reliable systems for monitoring the evidence or progression of osteoarthritis segment some or all of these cartilage compartments in knee MR images. In addition, segmentation of the bones may be performed to aid the delineation of the cartilage. Synovial fluid and ligaments, and menisci are mostly anatomical structures of no interest for such segmentation systems. Nonetheless, since they are located very close to the cartilage compartments, or may have similar appearance to the cartilage in MR images, they may be easily confused with the cartilage tissue increasing the number of false positives. Therefore, their accurate separation from the cartilage compartments is an important issue for increase of system robustness.

@&#RELATED WORKS@&#

The first fully automatic knee cartilage segmentation study was by Folkesson et al. [6], who segmented only the medial articular cartilage between the femur and tibia with a voxel classification approach in 114 sagittal low-field Turbo 3-D T1 MR images (170×170×104) of healthy and osteoarthritic populations. Their approach involved a region-growing algorithm based on the binary classifiers of approximate k-nearest neighbors (k-NN) that used around 40 significant features of voxels selected among position, blurred intensities at various scales, the first, second, and third derivatives of the blurred intensities, and eigenvalues and eigenvectors of the Hessian and structure tensor matrices [7]. Then, randomly sampled central voxels in a test MR image were used as seed points for region-growing if and only if they were classified as cartilage according to their approximate k-nearest neighbors among the voxel samples of 25 training MR images. The average Dice similarity coefficient (DSC) measures between the automatic and manual segmentations of the FC and TC after the enhancement of position alignment were 77±8% and 81±6%, respectively. Presence of oversegmented protrusions on the surfaces of the segmented cartilage compartments was indicated as the main drawback of the method. Even though they mentioned that their segmentation system lasted about 10min on a standard desktop computer, Dam and Loog [8] pointed out the inefficient classification procedure of the study by Folkesson et al., and proposed sample-expand and sample-surround algorithms to solve the problem of classifying all voxels in an MR image for a segmentation task with the original algorithm. The original algorithm and the two algorithms all yielded the same segmentation accuracies, but 2.5-h segmentation duration of the original algorithm was decreased to approximately 16min with the proposed algorithms. Dam et al. [9] modified the work of Folkesson et al. with the removal of the position alignment stage and introduction of a preprocessing stage of rigid multi-atlas registration instead, to eliminate the differences between the training and testing MR images. Accordingly, rectangular regions of interest for the cartilage compartments and menisci were determined, and a similar voxel classification approach was applied within these interest regions. Experimentation of their method was performed on 1907 low-field and high-field MR images of three distinct data sets including the OAI data set. Having improved the DSC accuracies in comparison to the work by Folkesson et al. their method could not solve the oversegmentation problem at the periphery of the cartilage compartments.

In some studies, segmentation of the knee bones and determination of the parts of the bone surfaces that interact with the cartilage, which are so-called the bone-cartilage interface (BCI), were required in preprocessing stage to facilitate the reliable segmentation of the cartilage compartments [10–12]. Yin et al. [10] identified initial volumes of interest for each bone and its associated cartilage using AdaBoost classifiers based on 3-D Haar features. The bone surfaces in volumes of interest were determined by graph searching of mean bone surface meshes of the three bones based on trained random forest classifiers, and BCIs on bone surfaces were extracted through AdaBoost classification of some geometrical and local appearance-based features. Then, they simultaneously segmented the bone and corresponding cartilage surfaces of the femur, tibia, and patella in 60 sagittal 3-D DESS MR images of the knee joint obtained from OAI, again with a graph-based approach oriented by random forest classifiers. Their method satisfied some constraints established on the non-intersection of different surfaces and different objects. Fripp et al. [11] compared performances of support vector machine (SVM) based tissue classification approach inspired by the work of Folkesson et al. and their hybrid deformable model (HDM) in 20 FS SPGR MR images of healthy volunteers for delineating the articular cartilage tissues of the knee joint. Both methods worked in a localized region close to BCI extracted beforehand through segmentation of the bones by 3-D active shape models. The HDM method segmented the cartilage through a 3-D deformable model depending on localization, patient specific tissue estimation, and a model of the thickness variation. However, experiments showed that the two methods had no statistical difference in between their average DSC measures of FC, TC, and PC. Lee et al. [12] segmented the knee bones using constrained branch-and-min-cut method to find the minimum energy on a Markov random field based on bone shape priors, and determined BCI voxels via classification of the voxels on bone surfaces with binary classifiers of position and local appearance. For cartilage segmentation, a set of reference patches from training set, which correspond to each local patch centered on sampled BCI voxels of the testing MR image, were identified to compute regional probabilities for each voxel and boundary probabilities for neighboring voxel pairs. Then, Markov random field optimization of local patch labels was accomplished by graph-cut technique using these regional and boundary probabilities. Their approach was assessed to have tailored representations for objects of interest due to its ability to model local appearance and shape characteristics flexibly. Nevertheless, their experimental results, which involved leave-one-out cross-validation on 10 MR images of OAI data set, were not significantly different from those of other proposed methods.

Similarly, some other studies also required segmentation of the bones prior to cartilage segmentation, but did not focus on BCI determination [13–18]. Vincent et al. [13] developed an AAM-based method for segmenting the bones and cartilage of the knee. The AAM model was built using 80 3-D DESS MR images of OAI data set, and the model correspondences were determined with minimum description length image registration method. The model was matched to new images with multiple initial estimates at a grid of starting points. A hierarchical modeling scheme that involved a single model of femur and tibia, and individual models of femur, tibia, FC, and TC was used to enhance the segmentation results. Testing of the models was performed on SKI10 data set [19] without additional tuning of the models. Shan et al. [16] developed a multi-atlas segmentation method with non-local patch-based label fusion, and used this to segment FC and TC compartments on 706 longitudinal T1-weighted SPGR MR scans of 155 participants. For a testing MR image, shape priors of femur and tibia determined with multiple-atlas registrations, and local bone likelihoods computed through a simple mathematical model were integrated into three-label formulation for optimal bone segmentation. Likewise, shape priors for the cartilage compartments determined through affine bone transforms between the multiple atlases and computed bone segmentations, and local cartilage likelihoods obtained from SVM classifications were combined to optimize the three-label cartilage segmentation energy. Their three-label segmentation method formulated the segmentation as a convex optimization problem, which enabled globally optimal solutions for femur-tibia and FC–TC segmentations, but it was not appropriate for the segmentation problems with more than two objects of interest. Wang et al. [17] used statistical shape models with boundary refinement by random walks algorithm for bone segmentation. Intensity values, gradients, spatial relations between the bones and cartilage compartments according to anatomical landmarks on bone surfaces, and contextual information with intensity differences between the image voxels and their neighbors at random distances were used as the features in an iterative classification scheme that ran random forests algorithm. After each pass of the classification, semantic context features based on voxel classification probabilities were combined with the feature set to enhance classification performance in the next pass. Their experiments were conducted using 3-fold cross-validation on 176 MR images of OAI data set for two visits of 88 participants at progression group. Results indicated that context-depended features and distances to landmarks were very informative to embed spatial constraints, and 2-pass random forests classification significantly improved the DSC accuracies. Lee et al. [18] developed a segmentation algorithm, which consisted of mainly three procedures; multiple atlas building, locally-weighted voting, and region adjustment. Multiple atlas building involved non-rigid registration of all training MR images to a target image, and selection of the best matching atlases. On a testing MR image, the results of selected atlas registrations were merged by locally-weighted voting algorithm. For region adjustment, seed points inside and outside the bone regions were determined using the statistical information of bone, cartilage, and surrounding regions in the initial segmentation result. Then a graph-cut method depending on these seed points enabled revision of outliers, and inclusion of abnormal bone regions. Experimentation of the approach was on 150 MR images of SKI10 data set using two thirds of the images for the training, and the rest for the testing. DSC values obtained for femoral and tibial cartilage compartments were the least among all studies.

Unlike most of other works in the literature, few studies depended on the use of multi-modal MR images of the participants, which decreases the overlap between tissue intensity distributions, so structures such as bones, muscles, or cartilage can be well separated [15,20,21]. However, since the scanning of multiple MR images at a time for a patient is an uncommon clinical practice, such approaches may not be convenient for automatic segmentation of articular cartilage. Zhang et al. [15] handled four MR image sequences of the participants, which included T1-w FS SPGR, T2/T1-w FIESTA, T2/T1-w IDEAL GRE water scan, and T2/T1-w IDEAL GRE fat scan, to obtain multi-modal voxel intensities. After a preprocessing stage of inter-subject multi-modal image registration and inter-subject histogram matching, some geometrical features computed according to the bone segmentations, local image structure-related features as well as the multi-modal image intensities were used to find parameters of a combined SVM and discriminative random field (DRF) classification model. During testing, optimal voxel labels were predicted by an inference graphical model with loopy belief propagation depending on the learned SVM-DRF model. Experiments performed with 11 participants using leave-one-out cross-validation showed that employment of geometrical features in combination with other features in SVM-DRF classifier yielded the best segmentation accuracies for all compartments. Hani et al. [20,21] tried to solve inhomogeneous intensity and low-contrast issues of proton-based MR images with fusion of sodium and proton MR images. Automatic segmentation of articular cartilage was determined through histogram equalization, connected components selection, convexity measurement of region areas, and edge detection in fused MR images without compartmental separation such as FC or TC. The segmentation results of articular cartilage yielded sensitivity of 80% and specificity of 99.6% with respect to the manual segmentations on fairly limited data sets of three sodium-proton [21] and four sodium-proton [20] MR images.

This study focuses on the classification-driven region-growing algorithm proposed by Folkesson et al. [6], because this algorithm is an appropriate segmentation method for the degenerative nature of cartilage with its voxel-based approach compared to methods strictly depending on the shape information of the compartments of interest such as statistical shape models [22–26] or atlases [27]. However, deformable approaches [28–31] or graph-based approaches [32] may handle the cartilage segmentation problem as accurately by using some contour or image dynamics such as curvature, intensities, or derivatives. But, for all approaches the initialization step of the segmentation method should be designed so that the automatic operation of the system is sustained. Consequently, some researchers have used shape-based methods to segment the knee bones with rigid shapes, and proposed local solutions to segment the cartilage compartments via individual or combined classification, deformable, or graph-based approaches [10–12,14,16–18]. Unlike such segmentation approaches, the focused classification-driven region-growing algorithm requires neither segmentation of bones nor determination of BCI, which makes it rather practical to apply.

Nonetheless, Folkesson et al. [6] did not clearly explain how the background voxels in the training MR images were handled in their work. Dam and Loog [8] noted their use of the original work by Folkesson et al., and that the original work combined two binary classifiers which used around 500,000 training voxels for background, 120,000 voxels for TC, and 300,000 voxels for FC. This indicates that the original work also suffered from the abundance of MR image voxels, and somehow reduced their amount. Moreover, the classification-driven region-growing algorithm had the oversegmentation problem around the surfaces of cartilage compartments, which could not totally be solved even by a more localized implementation of the method by Dam et al. [9].

If all voxels in the training MR images are included into the training models, models become more general, but this can result in an infeasible segmentation problem especially for high-field MR images with a great deal of voxels, and systems with limited memory or processing power. Subsampling of the MR image voxels can cure this problem with the cost of loss of generality [9]. However, running effective techniques for selecting the voxels can preserve the segmentation accuracies of most of the works in the literature by enabling a trade-off between the oversegmentation and undersegmentation issues. Therefore, investigation of the effects of various subsampling techniques in segmentation accuracies, as in this study, is important to guide the researchers interested in MR image segmentation through classification, and we believe that our study makes an incremental contribution in this respect.

In this study, high-field MR images in the 3-D DESS standard obtained from the Osteoarthritis Initiative (OAI) database were processed to automatically segment the whole FC, LTC, MTC, and PC tissues of the osteoarthritic knee joints using a variation of a voxel-classification-driven region-growing algorithm [6] with sample-expand method [8]. In consideration of systems with limited resources concerning memory or processing power, the infeasibility of classification that depends on training models composed of millions of voxel samples with high dimensions was eliminated. This was achieved via reduction of the background voxels through Gaussian, uniform, vicinity-correlated (VC) sparse, or VC dense subsampling techniques, and determining a subset of significant features through feature selection. Four training models were generated by various subsampling techniques, and their effects on the final segmentation accuracies were investigated for cartilaginous compartments of interest in test image sequences.

The remaining of this paper is organized as follows. Section 2 clarifies the materials handled and methods implemented in realization of the training phase (Subsection 2.3) and the testing phase (Subsection 2.4) of the automatic cartilage segmentation system. Section 3 elaborates on the subsampling techniques applied when generating the training models. Section 4 presents the experiments performed and the results obtained for the OAI data sets. Subsection 4.1 analyzes computationally most intensive procedure of the system as well as segmentation durations, and Subsection 4.2 discusses the approach and results of the implemented system in comparison to related works. Finally, Section 5 concludes with the contributions of the study and a few suggestions for future work.

Morphological analysis of cartilage for healthy populations may have significance for some studies, such as those targeting the determination of population statistics on cartilage measurements [33]. However, in clinical or surgical practice, it is more probable to encounter patients with frequent knee symptoms due to degenerated articular cartilage, which makes analysis of osteoarthritic knees in MR images crucial. Consequently, this study was conducted using MR images of knee joints that were categorically assessed as osteoarthritic with Kellgren and Lawrence (K–L) grade ≥2 but visually evaluated not to have large full-depth deterioration of the cartilage, especially in the FC and TC compartments. The latter condition was due to the use of one third of these MR images for training and to reflect the features of the cartilage voxels properly.

The data were obtained from the OAI database, which is publicly accessible at http://www.oai.ucsf.edu/. In total, 33 MR images of participants in the progression subcohort [34], which were scanned at baseline, and their corresponding data files of cartilage and meniscus semi-manually segmented with EndPoint software were used in this study. For OAI data sets, semi-manual segmentations of cartilage compartments in each MR image were performed by a trained segmenter, who could repeatedly segment these compartments with an intraobserver coefficient of variation of less than 3%, and reviewed by two experts. Because the same segmenter segmented all images of a subject through quality assurance of the segmentations by the experts, the effects of interobserver variation were minimized [35].

10 MR images were processed in training phase of the study, and 23 MR images were processed in testing phase. The original size of the image sequences was 384×384×160 with resolutions along the z, y, and x axes of rz
                     =0.36, ry
                     =0.36, and rx
                     =0.7mm, respectively. The labeling of dimensions is based on the reference frame of the MR scanner designated in Fig. 1.

A flowchart of the implemented cartilage segmentation system for the training and testing phases is shown in 
                     Fig. 2 in an integrated manner. The arrows, dashed blocks, and solid blocks in the chart indicate the course of data flow and system procedures for which the potential of a multi-core processor was exploited and was not exploited. The green blocks represent offline procedures with output data that were recorded on a hard disk, and white blocks represent online procedures retrieving this recorded data from the hard disk on demand. Additionally, the training and testing procedures are separately depicted in 
                     Figs. 3 and 6 for further clarification of this chart. The following subsections elaborate on these procedures in an order that is close to the course of data flow.

Initially, all MR images were cropped to a size of 280×280×143 both to reduce the burden of the feature extraction process and to remove noisy voxels near the image borders. The cropped region was determined using semi-manual segmentations of the cartilage compartments so that the information pertaining to any compartments in any MR images was retained. The next step was normalization of intensities of each MR image in between values of [0, 1]. Lastly, MR images of right knees were flipped along the x axis to relocate cartilage compartments to relatively consistent positions among all image sequences.

In total, 150 features were computed for each voxel of every MR image, which can be denoted as 
                           I
                        , using three scales of the physical world as 
                           
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                           
                        ={0.65mm, 1.1mm, 2.5mm}. These scales were also found to be reasonable according to the means and standard deviations of the subcompartmental cartilage thicknesses of healthy and osteoarthritic populations measured by Williams et al. [33] based on manual segmentations of the cartilage in MR images. The features consisted of voxel coordinates 
                           
                              
                                 c
                              
                              
                                 =
                              
                              
                                 
                                    
                                       
                                          (
                                       
                                       
                                          c
                                       
                                    
                                    
                                       z
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       x
                                    
                                 
                              
                              
                                 )
                              
                           
                        , smoothed intensities 
                           
                              
                                 
                                    I
                                 
                                 
                                    s
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ; first-order derivatives 
                           
                              
                                 
                                    I
                                 
                                 
                                    x
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    y
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    I
                                 
                                 
                                    z
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ; second-order derivatives 
                           
                              
                                 
                                    I
                                 
                                 
                                    xx
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    xy
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    xz
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    yy
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    yz
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    I
                                 
                                 
                                    zz
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ; third-order derivatives 
                           
                              
                                 
                                    I
                                 
                                 
                                    xxx
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    I
                                 
                                 
                                    yyy
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ,and 
                           
                              
                                 
                                    I
                                 
                                 
                                    zzz
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ; eigenvalues and eigenvectors of Hessian matrix 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        ; and eigenvalues and eigenvectors of structure tensor matrix 
                           
                              
                                 
                                    ST
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          o
                                       
                                    
                                    
                                       
                                          ,
                                          
                                             σ
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        .

The corresponding digital standard deviations on the axes for each value of scale 
                           
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                           
                         were calculated as 
                           
                              
                                 
                                    (
                                    
                                       σ
                                    
                                 
                                 
                                    z
                                 
                              
                              
                                 =
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 /
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       z
                                    
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       y
                                    
                                 
                              
                              
                                 =
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 /
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       y
                                    
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       x
                                    
                                 
                              
                              
                                 =
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 /
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       x
                                    
                                 
                              
                              
                                 )
                              
                           
                        . Then, smoothed intensities of the voxels were found by convolution of the MR image with the 3-D Gaussian filter 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , the values of which are computed according to a multivariate Gaussian function in (1), where 
                           Σ
                         is a 3×3 covariance matrix with diagonal values of 
                           
                              
                                 
                                    (
                                    
                                       σ
                                    
                                 
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                           
                        , 
                           
                              
                                 
                                    σ
                                 
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           
                        , 
                           
                              
                                 
                                    σ
                                 
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                                 )
                              
                           
                        , and 
                           
                              v
                           
                         is the vector of variables 
                           
                              
                                 
                                    (
                                    v
                                 
                                 
                                    z
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    v
                                 
                                 
                                    y
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              
                                 )
                              
                           
                         indicating coordinates of the filter elements.
                           
                              (1)
                              
                                 
                                    G
                                    
                                       σ
                                       i
                                    
                                 
                                 
                                    
                                       v
                                       ,
                                       Σ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             3
                                          
                                          |
                                          Σ
                                          |
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 exp
                                 
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                       v
                                       
                                          Σ
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          v
                                          T
                                       
                                    
                                 
                              
                           
                        
                     

First, second, and third-order derivatives were computed by convolution of smoothed MR images 
                           
                              
                                 
                                    I
                                 
                                 
                                    s
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         with the Prewitt filters of related axes shown in 
                        Fig. 4, consecutively when necessary. Eigenvalues and eigenvectors of 
                           
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ST
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          o
                                       
                                    
                                    
                                       
                                          ,
                                          
                                             σ
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         for each voxel were estimated by decomposition of the matrices given in Eqs. (2) and (3), respectively. As a result of this decomposition, 12 features comprising 3 sorted eigenvalues and their corresponding eigenvectors each of length 3 were obtained. The scale 
                           
                              
                                 
                                    σ
                                 
                                 
                                    o
                                 
                              
                           
                         for the structure tensor matrix determined the standard deviations of the 3-D Gaussian filter 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          o
                                       
                                    
                                 
                              
                           
                         applied to the image sequences of multiplied first-order derivatives before the decomposition operation. Values of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    o
                                 
                              
                              
                                 =
                                 
                                    {
                                 
                                 1
                                 .
                                 1
                                 
                                 mm
                                 ,
                                 2
                                 .
                                 5
                                 
                                 mm}
                              
                           
                         led to six combinations of the (
                           
                              
                                 
                                    σ
                                 
                                 
                                    o
                                 
                              
                           
                        , 
                           
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                           
                        ) tuple.
                           
                              (2)
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          [
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         xx
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         xy
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         xz
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         xy
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         yy
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         yz
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         xz
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         yz
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         zz
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ]
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ST
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             ,
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          G
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                    
                                       *
                                    
                                    
                                       
                                          [
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ]
                                       
                                    
                                 
                              
                           
                        
                     

Computational complexity was greatest for the features of eigenvalues and eigenvectors of the structure tensor matrix. Although such features could have been computed for only a subset of voxels after subsampling (Subsection 2.3.2) on each training MR image, they were computed for all voxels both to enable regeneration of training models and feature visualization. On the other hand, computation of only the significant features selected (Subsection 2.3.3) sufficed for the test MR images.

All features of each training MR image were max-min normalized to be in between values [−1, 1] except position features that were normalized to be in between values [0, 4]. This was because they were selected as significant features, so position error during classification can be penalized a little bit more. The feature normalization parameters for every training image sequence were also stored for use during the automatic segmentation of voxels of test MR images.

To construct the training models, using 10 MR images overall composed of approximately 110 million voxels with 150 features each leads to a system that cannot be feasibly realized in case of limited resources concerning memory or processing power. Even storage of such a large amount of data in memory of typical size is impossible, not to mention the overhead of constructing a parametric model of data or of dealing with the all of the data as the model. Consequently, abundance of the voxels was eliminated for each MR image via uniform, Gaussian, VC sparse, or VC dense background subsampling techniques, and the high dimensionality of the voxel samples was reduced by feature selection to overcome this problem. Then, the training data sets decreased in size and dimension were directly treated as the models through a non-parametric one-versus-all classification approach enabling parallelization, which is further explained in Subsection 2.4.2.

After preprocessing sequences of training images, central coordinates of each cartilage compartment were calculated by evaluating the training MR images both individually and collectively. To compute the individual central coordinate of a cartilage compartment, 3-D coordinates of the voxels within volume of the compartment, which was delineated by a trained segmenter beforehand, were averaged in the axes for a single training MR image. To compute the collective central coordinate of a cartilage compartment, the same averaging operation was performed by taking voxel coordinates of the compartment in all of 10 training MR images into consideration. Individual central coordinates of the compartments over MR images were useful in Gaussian subsampling of background voxels, and collective central coordinates were useful in seed selection and position alignment in test image sequences.

When constructing the training models of each cartilage compartment in each training MR image for one-versus-all classification of the cartilage voxels, all cartilage voxels of the related compartment were labeled as positive samples, whereas the rest were labeled as negative. Nevertheless, since the number of cartilage voxels in an MR image is much lower than the number of background voxels, all cartilage voxels were included in a training model whereas equal number of background voxels were selected via uniform, Gaussian, VC sparse, or VC dense background subsampling techniques. Hence computational infeasibility of the classification problem could be resolved substantially. The four background subsampling techniques enabled construction of four different training models for each cartilage compartment of each training MR image. The subsampling strategies of these techniques are separately explained in Section 3, because the main contribution of this paper is based on investigation of the subsampling techniques introduced.

The dimension of voxel features was reduced from 150 to 18 for each cartilage compartment. This was done by comparing the features selected by a forward feature selection algorithm in Gaussian subsampled training models of 3 MR images. The algorithm ran separately for each of those MR images using 10-fold cross-validation of their training models and the classification procedure described in Subsection 2.4.2. Due to long response times of the classification algorithm for high dimensions, feature selection was forwardly run for only up to 20 features by treating all features individually.

Next, among the features selected in the training models, significant features for the respective cartilage compartment were identified as those that are exactly the same for at least 2 MR images, those differing only in scale for at least 2 MR images, and those highly discriminative for any of the 3 MR images, in order of decreasing priority. 
                           Table 1 lists the 18 significant features for each cartilaginous compartment of interest without indicating any priority of significance. Numbers at the lower right corner of the Hessian and structure tensor matrices refer to one of their 12 eigenvalue and eigenvector features in the order stated in Subsection 2.2. 
                           Fig. 5(a) through (d) visualize some significant features selected for FC, LTC, MTC, and PC, respectively. Because MTC and LTC were visible in only the first and second halves of the image sequences, (c) depicts slice number 50, while (a), (b), and (d) depict slice number 110 of the same MR image.

An exhaustive search could not be performed when selecting the features owing to computational constraints, but features found as significant were sufficiently effective in their corresponding classifiers of cartilage compartments. Furthermore, selecting features on the training models of other subsampling techniques did not affect the primarily identified significant features.

Segmentation of cartilage in test MR images involved a blind approach in a way that no prior information related to entries on the position of cartilage or manual interventions was assumed other than the information derived from the training data sets. To realize the automatic segmentation, the seed selection and position alignment procedures relied on the central coordinates of cartilage compartments, while the classification procedure relied on the training models of various subsampling techniques (
                        Fig. 6).

The classification-driven region-growing algorithm involved the sample-expand method, which enables efficient segmentation of objects of interest with large surface area-to-volume ratio [8]. The algorithm was initialized through determination of at least 100 seed points that belong to the cartilage compartment to be segmented. To achieve this, voxels were randomly chosen using a 3-D Gaussian image with the center shifted to the collective center of the respective cartilage compartment in the entire training data sets as the weights. The chosen voxels were classified with respect to the corresponding training model of a subsampling technique. Then, the voxels classified as cartilage became the seed points of the region-growing algorithm and were grown iteratively by integrating them with the cartilage voxels in their 26-neighborhood until all of the neighbors were background. During the region-growing procedure, classification probabilities of the voxels were also maintained for each classifier to resolve the issue of multi-labeled voxels in the post-processing procedure.

The four cartilage compartments of interest have relative positional and morphological differences. However, they have the same structural components and resembling local morphologies, making their appearance similar in MR images. Hence, distinguishing all of these compartments at once with a multi-class classifier was considered to be more prone to failure than distinguishing them separately with one-versus-all classifiers each trained for a cartilage compartment. Four classifiers of FC-versus-all, LTC-versus-all, MTC-versus-all, and PC-versus-all were run to segment the respective cartilage compartment using the selected features of the training model generated by one of the subsampling techniques. The classifiers depended on the approximate k-NN algorithm in the statistical learning toolbox [36] implemented by Mount and Arya [37,38]. For a training data set of size n and dimension d, the approximate k-NN algorithm constructs a data structure of size 
                              
                                 O
                              
                              
                                 (
                                 
                                    dn
                                 
                                 )
                              
                            in 
                              
                                 O
                              
                              
                                 (
                                 
                                    
                                       dn
                                    
                                    
                                       log
                                    
                                    
                                       n
                                    
                                    
                                       )
                                    
                                 
                                 )
                              
                            time. For any query sample, the approximate k-NN are determined with a relative error bound ϵ from the exact k-NN in 
                              
                                 O
                              
                              
                                 (
                                 
                                    
                                       (
                                    
                                    
                                       
                                          c
                                       
                                       
                                          d
                                          ,
                                          ϵ
                                       
                                    
                                    
                                       +
                                       kd
                                       )
                                    
                                    
                                       log
                                    
                                    
                                       n
                                    
                                    
                                       )
                                    
                                 
                                 )
                              
                            time, where 
                              
                                 
                                    c
                                 
                                 
                                    d
                                    ,
                                    ϵ
                                 
                              
                            is a constant that depends on parameters d and ϵ. These parameters were given as 100 and 3 in this study so that the approximate 100-NN of the queried samples, which had error bound of 3 from the exact 100-NN, were retrieved [39].

Even after subsampling, roughly 300 thousand, 100 thousand, and 70 thousand data samples were available for the training models of FC, TC, and PC, respectively, for a training MR image. When 10 MR images were processed for the training phase, the computational or memory-related capabilities of a resource-limited system would be overwhelmed if a predictive model out of so much data via parametric approaches was built or if all of the data was handled for every query sample in a test image sequence via standard nonparametric approaches. The approximate k-NN algorithm performs quite efficiently on data sets composed of hundreds of thousand samples with dimensions as high as 20 [37]. Consequently, parallelization of the classification procedure on multi-core systems was considered by assigning to each core the task of classification of query samples depending on the training model and feature normalization parameters of only a single MR image. Then, 100 approximate neighbors of the query samples were identified in each task, and the nearest 100 among one thousand neighbors were later determined again. If at least 90% of these neighbors were cartilage of a compartment, then the query samples were labeled as cartilage of that compartment. Otherwise, they were labeled as background. This threshold is indicated by 
                              
                                 
                                    
                                       t
                                    
                                    
                                       c
                                    
                                 
                                 
                                    =
                                    0.9
                                 
                              
                            and was essential to remove most of the oversegmented fragments of the main cartilage component. Its value was set empirically to maximize the DSC measure of automatic segmentations on a subset of 5 test MR images.

The result of the classification-driven region-growing algorithm was a number of components that represent a cartilage compartment. However, small components were generally false positives, while large components were true positives. Therefore, a connected component-finding algorithm was run, and size of each component was estimated by voxel counting. The component with the greatest size was accepted as the true segmentation result of the compartment, since this was a relatively robust approach.

When all cartilaginous compartments were segmented, multi-labeled voxels were assigned to a single label based on their probabilities of classification for different compartments. For this purpose, the intersection of the segmented tuples of LTC-MTC, FC-LTC, FC-MTC, FC-PC, LTC-PC, and MTC-PC were investigated in order, and multi-labels were cleared. This operation required the connected component-finding algorithm to be run a second time separately on the segmentation result of each cartilage compartment to remove small isolated components and obtain the greatest component as the final segmentation result.

Positional differences of the knee joints among MR images could affect the accuracies of segmentation negatively since features related to position were significant for most of the classifiers. To tolerate these differences, test MR images can be shifted so that the cartilage compartment to be segmented becomes closer to its counterparts in the training data sets. The amount of shift for each cartilage compartment in a testing image sequence was computed by subtracting the central coordinate of the automatically segmented region of cartilage before position alignment (BPA) and the collective central coordinate of the corresponding cartilage compartment in the training MR images. Because feature extraction procedure was performed offline in this study, position alignment was realized through only relocation of the features other than the position according to the shifting amount instead of shifting the test image sequence itself and computing the significant features as required. Subsequently, the procedures of Subsections 2.4.1–2.4.3 were repeated, and automatic segmentation of cartilage after position alignment (APA) was achieved.

The principle of the subsampling procedure described in Subsection 2.3.2 is to select a reasonable subset of background voxels in each training MR image for each compartment to solve the infeasibility problem of classification. Although partial representation of large amount of background voxels may affect the segmentation accuracies negatively, effective selection of these voxels rather than performing only a random selection can compensate this.

In this study, first of all, uniform subsampling (Subsection 3.1) of background voxels was implemented for construction of the training models, but this technique did not result in satisfactorily high segmentation accuracies as expected, especially for smaller compartments such as LTC, MTC, and PC. Then, Gaussian subsampling (Subsection 3.2) of the background voxels was realized, which yielded better segmentation accuracies yet poorer representations for the compartments with highly curved and large shapes such as FC. Therefore, a cartilage vicinity-correlated subsampling technique (Subsection 3.3) was designed to generate proper representations by flexibly adapting to the shape of the object of interest, and was used to derive VC sparse and VC dense representations for each compartment in the training MR images.

Each subsampling technique adopted a different strategy to determine the selection weights of the background voxels, and then similarly performed a random selection of these voxels depending on the weights. The pseudo-code of the generic algorithm that was run to apply one of the subsampling techniques is as in Algorithm 1. This algorithm common for all techniques first determines the background volume (
                        V
                     
                     bg) that surrounds a cartilage compartment (
                        V
                     
                     obj), and the number of voxels in this compartment (n
                     obj). Second, the selection weights of the background voxels (
                        W
                     ) are computed depending on the choice of subsampling technique. Then, n
                     obj unique voxels with the label of 1 in 
                        V
                     
                     bg are randomly selected among the background voxels using 
                        W
                     . Finally, the algorithm integrates the cartilage voxel coordinates 
                        C
                     
                     obj and subsampled background voxel coordinates 
                        C
                     
                     bg as well as the corresponding labels of these voxels to generate the training model of the cartilage compartment for a training MR image and a subsampling technique.

Subsampling strategies of the techniques are demonstrated in 
                     Fig. 7 through slicewise visualization of some voxels included in the models of FC for a training image sequence in the first row, and 3-D visualization of all voxels included in the FC training models of a training MR image in the second row. The voxels of FC compartment are depicted in red, as background voxels are in blue in this figure.
                        Algorithm 1
                        Subsample

Uniform subsampling is the simplest technique, since it used uniform weights during random selection of the background voxels. As Fig. 7(a) and (e) shows, subsampled background voxels are widely distributed throughout the MR image with uniform subsampling. Algorithm 2, which is called within Algorithm 1, presents the pseudo-code of the weight generation process of this subsampling technique for the background voxels. A training model generated with uniform subsampling technique is strong to represent the background voxels in the entirety of MR image. However, it is weak to represent the background voxels in a localized sub-volume of the same MR image. Therefore, representation of surrounding background voxels of especially small objects of interest in an MR image is insufficient with this technique.
                           Algorithm 2
                           Uniform Weights

Gaussian subsampling technique weighted background voxels according to the intensities of a 3-D Gaussian image, which has the same size as the MR images and a center shifted to the center of the cartilage compartment of interest. The weight generation process of this technique is explained in Algorithm 3. Gaussian subsampling samples in a more localized volume in comparison to uniform subsampling so can generate better representations for objects that can be fully bounded by the constructed Gaussian sphere. However, it can fail to represent the objects with large and curved shapes properly. This problem is well-defined in Fig. 7(b) and (f) for FC compartment. Central coordinate of FC compartment do not exactly coincide with the compartment itself due to curved shape of FC. In addition to this, FC is the largest compartment of all, so the sphere in 3-D Gaussian image cannot envelope this compartment. Consequently, the background voxels near central coordinate of FC are frequently selected, whereas those distant from the center are rarely selected. Although modifying the values of the covariance matrix of the Gaussian function to adjust the shape of Gaussian according to the shape of the object of interest as much as possible might mitigate this problem, a more flexible solution is required as presented in the next subsection.
                           Algorithm 3
                           Gaussian Weights

A subsampling approach that can be conveniently adaptable for objects with any shape and size is necessary for generation of effective representations, and vicinity-correlated subsampling was designed for this purpose. The background voxel-weighting algorithm of vicinity-correlated subsampling is presented in Algorithm 4, which is the basis of both VC sparse and VC dense subsampling techniques. To weight the background voxels, VC subsampling iteratively dilates the volume of the cartilage compartment by a spherical morphological operator with a diameter of 5 voxels until the full size of the MR image was reached, and assigns each dilated portion to a weight that constantly decreases with the number of iterations. The difference between the VC sparse and VC dense subsampling techniques is related to the rate of change of these assigned weights. As Algorithm 1 lines 13 and 15 define, sparse and dense techniques apply decreases of 10% and 33% in the weight of the previous iteration, respectively, through the sparseness parameter in the Algorithm 4. Fig. 7(g) and (h) shows how the background volume around FC can be represented as intended with vicinity-correlated subsampling approach. Background voxels that surround FC are selected within a wider volume for VC sparse subsampling, and within a narrower volume for VC dense subsampling.
                           Algorithm 4
                           Vicinity-Correlated Weights

@&#EXPERIMENTAL RESULTS@&#

The automatic segmentation results of FC, LTC, MTC, and PC for 23 test MR images were validated against their manual segmentations by computing the measures of DSC, sensitivity, and specificity according to Eqs. (4)–(6), where A and B denote the set of voxels in automatically and semi-manually segmented regions of cartilage, respectively. Sensitivity and specificity measures are true classification ratios of cartilage and background classes. However, DSC is maximized in the case of a good compromise of sensitivity and specificity, so it is an important indicator of segmentation accuracy.
                        
                           (4)
                           
                              
                                 
                                    DSC
                                 
                                 
                                    
                                    (
                                 
                                 
                                    A
                                 
                                 
                                    ,
                                 
                                 
                                    B
                                 
                                 
                                    )
                                    =
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          |
                                          
                                             
                                                A
                                             
                                             
                                                ∩
                                             
                                             
                                                B
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          
                                             A
                                          
                                          |
                                       
                                       
                                          +
                                       
                                       
                                          |
                                          
                                             B
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    Sensitivity
                                 
                                 
                                    
                                    (
                                 
                                 
                                    A
                                 
                                 
                                    ,
                                 
                                 
                                    B
                                 
                                 
                                    )
                                 
                                 
                                    =
                                 
                                 
                                    
                                       |
                                       
                                          
                                             A
                                          
                                          
                                             ∩
                                          
                                          
                                             B
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          B
                                       
                                       |
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    Specificity
                                 
                                 
                                    
                                    (
                                 
                                 
                                    A
                                 
                                 
                                    ,
                                 
                                 
                                    B
                                 
                                 
                                    )
                                 
                                 
                                    =
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                A
                                             
                                             
                                                c
                                             
                                          
                                          
                                             ∩
                                          
                                          
                                             
                                                B
                                             
                                             
                                                c
                                             
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             
                                                B
                                             
                                             
                                                c
                                             
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        
                     
                  


                     
                     Table 2 presents the means and standard deviations of these measures for each compartment of cartilage in all test image sequences before and after the enhancement of position alignment for the four different training models. The results demonstrate that uniform subsampling enabled the highest sensitivity values when VC dense subsampling produced the highest specificity values for all cartilage compartments. Most of the best DSC values were observed in the case of VC sparse subsampling, which had relatively balanced sensitivity and specificity values. The reasons for these results can be clarified through the classification trade-off between background and cartilage voxels for the various subsampling techniques. The degree of separability of the classifier affects the accuracy of segmentation now that there is no other restriction on termination of the growing cartilage volume other than the neighboring voxels classified as background in this segmentation approach.

When uniform subsampling collected excessively distributed background samples for the training models, the representation of background samples was weaker in the vicinity of cartilage. Thus, there was oversegmentation of the respective cartilage compartments combined with other similar structures. This resulted in maximization of sensitivity and minimization of specificity measures. The situation was reversed when VC dense subsampling intensely collected background samples near cartilage. Then, the bias toward strong representation of those background samples caused undersegmentation of the cartilage. However, it should be noted that augmentation of DSC measures could be possible for these two techniques if the classification threshold 
                        
                           
                              t
                           
                           
                              c
                           
                        
                      is assigned proper values so that 
                        
                           
                              
                                 t
                              
                              
                                 c
                              
                           
                           
                              >
                              0.9
                           
                        
                      for uniform subsampling and 
                        
                           
                              
                                 t
                              
                              
                                 c
                              
                           
                           
                              <
                              0.9
                           
                        
                      for VC dense subsampling. But even then the DSC measures for VC sparse subsampling with 
                        
                           
                              
                                 t
                              
                              
                                 c
                              
                           
                           
                              =
                              0.9
                           
                        
                      remained optimal.

The training models of the VC sparse subsampling technique enabled an effective representation of the voxels in training data sets. Consequently, they resulted in the highest DSC measures especially APA, and resolved both problems of oversegmentation and undersegmentation to some extent. This implies that the VC sparse subsampling technique can be appropriate for similar classification-based segmentation approaches both to reduce the computational complexity of handling all voxel samples of an MR image and to accomplish robust delineation of an object of interest.

Superiority of the DSC measures APA for VC sparse subsampling technique was also indicated with paired t-tests performed at 5% significance level. As shown in 
                     Table 3, compartmental DSC measures APA for VC sparse are statistically significantly better than DSC measures BPA for VC sparse, and DSC measures BPA or APA for the other techniques. However, the difference of DSC measures APA for Gaussian subsampling technique in segmentation of MTC and PC were insignificant, which means that Gaussian subsampling can approximate to VC sparse subsampling for such small and ellipsoid structures.


                     
                     Fig. 8 shows the plots of the individual DSC measures of the segmented compartments in each test MR image BPA and APA for the subsampling techniques. The information related to DSC means and standard deviations in Table 2 was overlaid on the plots. The blue and red dots point out individual DSC measures BPA and APA, the blue and red solid lines connect the mean DSC measures BPA and APA, and dashed blue and red lines parallel to the horizontal axis designate mean±standard deviation BPA and APA, respectively. The position alignment procedure improved the average DSC for all compartments of cartilage, with the greatest improvement for PC. The only exception was tibial compartments for the training models of uniform subsampling. These compartments are smaller volumes so closely positioned to each other and FC that position alignment increased false positive rate more than increasing true positive rate due to random subsampling of background. The poorer DSC values and larger standard deviations for PC revealed in Table 2 indicate relative inadequacy of PC-versus-all classifier. This may be due to severe osteoarthritic deteriorations of cartilage for this compartment or similarity of the significant features of PC to the corresponding features of other nearby anatomical structures such as synovial fluid.


                     
                     Fig. 9 presents the 3-D views of semi-manually and automatically segmented compartments of interest for one of the test MR images. The system again achieved highest DSC measures when the training models of the VC sparse subsampling were used for this MR image, and these measures were 85%, 82%, 83%, and 82% for FC, LTC, MTC, and PC, respectively.

The principal problems encountered during experimentation of the automatic segmentation system were solved as follows. Because some MR images were composed of a wide range of intensities due to noise, especially near the borders of the images, such images had low inter-tissue contrast after normalization. Therefore, use of uncropped full MR images prevented the system from distinguishing between the cartilage regions and background for such images. This problem was eliminated by cropping the MR images. Another problem was related to accepting the largest component as the segmentation result of a cartilage compartment in the post-processing procedure. For instance, when a cartilage compartment was detected in the form of several connected components due to worn-out regions of the cartilage, the largest component was only a partial representation of the whole compartment. In another instance, when some misclassified large components were grown, the truly classified cartilage component was totally eliminated. However, these difficulties were mostly overcome by optimization of the system parameters. Some other observations emerged from sub-experiments are that an increase in the number of training MR images affected DSC measure positively, random subsampling of training models to improve system performance resulted in lower DSC values, and adding more features for the training models did not contribute to average segmentation accuracies.

The system described in Section 2 was experimented on a 4-core 2.8GHz laptop with 6GB of RAM and a 500GB hard disk using MATLAB, which facilitated the implementation with its toolboxes. The computationally most intensive procedure was one-versus-all classification based on approximate k-NN, which was a C++ application called by MATLAB. For instance, according to the computational complexities of approximate k-NN in Subsection 2.4.2, classifying a voxel as cartilage or background depending on the FC model of 10 training image sequences would require preprocessing time of 
                           
                              O
                              (
                              350
                           
                           
                              ×
                           
                           
                              
                                 10
                              
                              
                                 6
                              
                           
                           
                              )
                           
                         for data structure construction and 
                           
                              O
                              (
                              12
                              ×
                           
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                           
                              )
                           
                         time to find the approximate 100-NN while ignoring the constant 
                           
                              
                                 
                                    c
                                 
                                 
                                    
                                       d
                                    
                                    ,
                                    
                                       ϵ
                                    
                                 
                              
                           
                        . However, the computation time of the same task with classification procedure in parallel on 4 cores was 
                           
                              ⌈
                              
                                 10
                                 /
                                 4
                              
                              ⌉
                           
                           
                              [
                              
                                 
                                    O
                                    (
                                    30
                                    ×
                                 
                                 
                                    
                                       10
                                    
                                    
                                       6
                                    
                                 
                                 
                                    )
                                 
                                 
                                    +
                                 
                                 
                                    O
                                    (
                                    10
                                    ×
                                 
                                 
                                    
                                       10
                                    
                                    
                                       3
                                    
                                 
                                 
                                    )
                                 
                              
                              ]
                           
                        . Therefore, the parallel version was slightly more advantageous in this approach as long as not too many query samples were tested at a time frequently.

The automatic segmentation durations were greatest for FC, which is the largest compartment among all, as listed in 
                        Table 4. The durations increased proportionally to the sensitivity of the subsampling techniques for all cartilage compartments because generally the cartilage region had been grown larger than before in the case of increased sensitivity. Also, segmentation durations APA were twice the durations BPA, since the position alignment procedure used the central coordinate information of a cartilage component produced as a result of the first run of the segmentation algorithm. However, those durations can be reduced further by increasing the error bound ϵ and decreasing the number of nearest neighbors k in the approximate k-NN algorithm. The probable consequence is that the segmentation accuracies will be affected. For example, when k was 10 and ϵ was 2, average DSC for FC APA decreased to 15min for the training models of VC sparse subsampling with approximately 4% decline in average DSC. Increasing the value of ϵ affected the average segmentation accuracies less negatively than decreasing the value of k.

@&#DISCUSSION@&#

Direct comparison of the results of the related studies in the literature is generally unreasonable because of their dependence on distinct data sets of MR images. These data sets are constructed through different standards with various sizes or qualities by scanning participants who have specific symptoms of osteoarthritis or do not have any symptoms at all. Moreover, manual segmentations used for validation of the automatic segmentations are always affected by segmenter variability. Nonetheless, taking these factors into account, the results of the studies mentioned in Subsection 1.2 and our study can be mutually assessed.

Since most of the related studies used DSC measure to validate the automatic segmentations, 
                        Table 5 lists the DSC means and standard deviations of segmented cartilage compartments for these studies to facilitate the assessments. The studies were grouped in the table according to their requirement to find a volume of interest (VOI), segment a bone, or determine BCI before segmentation of a cartilage compartment. The average DSC values for the study by Vincent et al. [13], which came first in the SKI10 challenge [19], were given as presented by Shan et al. [16].

Because deterioration of cartilage can affect the segmentation accuracies negatively [9,33], high DSC values obtained in some studies may be attributed to their conduct of the experiments on MR images of only healthy participants [11]. Zhang et al. [15] processed MR images of participants with unknown health status. Some studies [6,10,14,16] partially involved osteoarthritic participants, whereas some others [9,12,17] included osteoarthritic participants exclusively as our study did. Studies that used SKI10 data set [13,18] segmented MR images scanned before knee surgeries, so they handled purely pathological cases.

In addition to this, validation was performed partially for some studies by using the selected slices of MR images due to large labor intensity of 3-D manual segmentations [10,12], or evaluating parts of the cartilage compartments [6,13,16,18]. Studies that used SKI10 data set [13,18] segmented only load-bearing regions of articular cartilage in tibiofemoral joint, and Shan et al. [16] segmented load-bearing regions of FC. Consequently, accuracies of the whole 3-D cartilage compartments could not be provided by these studies. Although segmentation of only load-bearing regions that have higher probability of cartilage deterioration can lead to a fall in average accuracies, pieces of the cartilage compartment boundaries, where segmentation errors mostly occur due to oversegmentation, were eliminated with partial validation.

Furthermore, an increase in the number of training MR images can improve system accuracies [12] bringing about yet longer segmentation durations. Therefore, studies that trained their system using a greater number of MR images were more probable to obtain higher DSC values, e.g. [17] with 58, [13] with 80, and [9] with 44 training MR images. Leave-one-out cross-validation method, which enables use of most of the MR images for training while achieving testing of all MR images, was applied in [11,12,14,15]. The studies with limited data sets were Lee et al. [12] with 10 MR images, Tamez-Pena et al. [14] with 6 images, Zhang et al. [15] with 11 images, and Hani et al. [21] with 3 images. In spite of being an uncommon practice, processing of multi-modal images for each participant can highlight the cartilaginous tissues so that notable accuracies can be obtained as in the study by Zhang et al. [15], which processed four MR images with different modalities for a participant.

It is hard to mention if any method is significantly superior to another overall. Though, as can be understood from Table 5 that accuracies of PC compartment considerably increased for the methods that had localized segmentation strategies. Among the other studies, our work is mostly comparable to the work by Dam et al. [9], which used the same MR image data sets of OAI as ours. But, they could improve the accuracies approximately 2% for LTC and 1% for PC compartments despite of their heavy preprocessing with multi-atlas registration. Consequently, it can be inferred that our study has attained comparable segmentation accuracies with respect to some previous studies, especially when application of our approach on exclusively knee MR images of symptomatic participants is taken into consideration.

Similarly, due to the fact that our work and the other works processed MR images with different sizes, segmented some or parts of cartilage compartments in the knee joint, or were run on different platforms, a direct computational performance comparison among them cannot be made. Moreover, most of the researchers did not clearly explain if the provided measures were for the entire cartilage segmentation procedure including the VOI, bone, or BCI determination, and segmentation of all cartilage compartments. As to computational performances of the studies in Table 5, Folkesson et al. [6] noted that they had achieved automatic segmentation of MFC and MTC in a testing MR image in 10min on a 2.8GHz standard desktop. But, Dam and Loog [8] stated that their efficient algorithms dropped 2.5-h computation time of the original work by Folkesson et al. [6] to 16min. Some researchers made no mention of the segmentation durations of their possibly computationally demanding approaches requiring multi-atlas registrations or statistical shape model searches [9,14,17]. The studies that had segmentation durations for an MR image above the average were Zhang et al. [15] with 33min when using a 48-core high performance computer and Shan et al. [16] with at least 10 hours. Other studies that had roughly close performances provided the following details on their approximate segmentation durations and experimental platforms; Yin et al. [10] in 20min with Intel Core 2 Duo 2.6GHz processor and 4 GB RAM, Fripp et al. [11] 15min for SVM-based and 15–30min for HDM-based methods, Vincent et al. [13] in 15min with Intel Core 2 Duo and Core 2 Quad processors, Lee et al. [12] in 15–21min, and Lee et al. [18] in 40min with 2.4GHz 2 Quad processor and 2GB RAM. Our study can be ranked among these studies with its 29-min mean segmentation duration in total for training models of VC sparse subsampling (Table 4).

@&#CONCLUSIONS@&#

It is necessary to deal with large number of voxels in MR images either using localized approaches or subsampling methods to implement efficient MR image segmentation systems based on voxel-classification approaches. In this study, we experimentally showed that vicinity-correlated background voxel subsampling method is a better choice than uniform or Gaussian subsampling to distinguish objects of interest from other similar and close structures frequently encountered in MR images, especially for objects with highly curved and complex shapes. Furthermore, it was possible to obtain reasonable accuracies with respect to the studies in the literature for segmentation of cartilage compartments in high-field knee MR images through voxel-classification-driven region-growing algorithm, when training models of VC sparse subsampling and a proper set of values for the system parameters were used. Consequently, the findings of this study can provide a basis for other researches that focus on segmentation of anatomical structures in MR images with voxel-classification.

The performance of the classification procedure could be substantially increased due to elimination of a great deal of background voxels in the training models and reduced number of features. Additionally, the proposed system could segment the cartilage compartments without prior segmentation of bones or determination of BCI, and requiring multiple MR images of a participant. Therefore, the system can be applied efficiently without significant loss of accuracies even for MR images of osteoarthritic participants, which makes it promising from clinical point of view.

Although classification-driven region-growing is an appropriate approach for the degenerative nature of cartilage, it may be prone to inaccurate segmentations especially in the case of severe full-depth deteriorations. For future work, high level cues such as relative positions and shapes of the cartilage compartments may be integrated with this approach in order to address the segmentation problems. Cartilage voxels determined by the presented approach may be regulated with the spatial information derived from multi-object atlas registration algorithms [9]. Processing images of coarser scale, which can properly represent the cartilage compartments, may be considered to further expedite the computationally demanding segmentation procedures.

None declared.

@&#ACKNOWLEDGEMENT@&#

The OAI is a public-private partnership comprised of five contracts (N01-AR-2-2258; N01-AR-2-2259; N01-AR-2-2260; N01-AR-2-2261; N01-AR-2-2262) funded by the National Institutes of Health, a branch of the Department of Health and Human Services, and conducted by the OAI Study Investigators. Private funding partners include Merck Research Laboratories; Novartis Pharmaceuticals Corporation, GlaxoSmithKline; and Pfizer, Inc. Private sector funding for the OAI is managed by the Foundation for the National Institutes of Health. This manuscript was prepared using an OAI public use data set and does not necessarily reflect the opinions or views of the OAI investigators, the NIH, or the private funding partners.

@&#REFERENCES@&#

