@&#MAIN-TITLE@&#The maximin HAZMAT routing problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new approach for treatment of HAZMAT transportation in urban areas.


                        
                        
                           
                           The approach maximises the distance between a HAZMAT route and its closest vulnerable population centre.


                        
                        
                           
                           An exact model is proposed, including a method of reduction of variables, and an optimal, polynomial heuristic.


                        
                        
                           
                           A real-like large instance is solved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Networks

Routing

HAZMAT

@&#ABSTRACT@&#


               
               
                  The hazardous material routing problem from an origin to a destination in an urban area is addressed. We maximise the distance between the route and its closest vulnerable centre, weighted by the centre’s population. A vulnerable centre is a school, hospital, senior citizens’ residence or the like, concentrating a high population or one that is particularly vulnerable or difficult to evacuate in a short time. The potential consequences on the most exposed centre are thus minimized. Though previously studied in a continuous space, the problem is formulated here over a transport (road) network. We present an exact model for the problem, in which we manage to significantly reduce the required variables, as well as an optimal polynomial time heuristic. The integer programming formulation and the heuristic are tested in a real-world case study set in the transport network in the city of Santiago, Chile.
               
            

@&#INTRODUCTION@&#

The hazardous material (HAZMAT) routing problem has been extensively studied in recent decades. For the most part it has been treated as a least cost routing problem between an origin and a destination, in which cost is a combination of transport costs and a risk function.

Although there is no consensus on the best way to model risk, it is generally agreed that any formulation will include two elements: the probability of an accidental HAZMAT release, and its associated consequences. Very few of the risk measures take into account the distance between a population centre and the HAZMAT route except in order to define distance thresholds within which the consequence or risk is total and beyond which it is non-existent. In reality, however, the closer a HAZMAT vehicle passes to a population centre within such a threshold, the greater is the centre’s exposure to hazard (where hazard is understood as the potential for producing an undesired consequence without regard to the probability of its occurrence). This observation also fits with public perceptions, strongly suggesting that the distance between routes and populated centres warrants greater attention in HAZMAT route modelling, since it is a good proxy for hazard.

Our contribution is oriented to propose an approach oriented to the protection of vulnerable centres, together with a new model and an optimal heuristic for HAZMAT transportation in urban areas. The approach assumes that population in residential or low-rise commercial areas is easier to evacuate, but there are vulnerable centres concentrating high populations of children, senior citizens or ill people, for which is difficult to evacuate or can slowly do so. These vulnerable centres are represented as points on a plane. We incorporate in a new model, the distance between a vulnerable centre and a HAZMAT transport route. A maximin objective is used here that, to the best of our knowledge, has not previously been used in the HAZMAT or routing literature in a network context. This objective maximises the minimum Euclidean distance between the route and the nearest vulnerable centre, the distance being weighted by the centre’s population. We remark that any other distance and hazard measure could be trivially used, as long as it is non-increasing with distance. Since we explicitly assume that hazard is an attribute of each vulnerable centre and depends on the centre’s distance from a HAZMAT route, by using this maximin approach we minimize the hazard facing the centre closest to the route (the most exposed centre). By using this approach, we obviate the need to set risk or risk difference thresholds, or to compute probabilities. Moreover, the formulation we develop designs a route instead of choosing one from a set.

Maximal values of risk or hazard have seldom being minimized in the HAZMAT literature. In general, the average or total risk or hazard has been the objective to be minimized. Exceptions are some works that locate either straight or broken lines in a plane. However, HAZMAT transport in practice takes place over a network. Modelling the routing problem in a network context, with an integer programming formulation, requires the application of constraints that will relate each population centre to its closest link in the route (i.e., the link imposing the greatest hazard). This type of constraints is used in discrete location problems, e.g., assigning customers to the closest plant of a multi-plant firm.

The new exact model we formulate here (our first solution method) potentially requires a large number of closest assignment constraints. Normally, this would also mean a large number of decision variables, significantly complicating the solution of the problem. Since the route is not known a priori, a variable associating each vulnerable centre with each network link has to be added, implying a total of O(mq) variables where m is the number of network links and q the number of vulnerable centres. In our exact model, however, each vulnerable centre needs only a subset of these variables identified by the sections of route within the centre’s danger area. The result is a major reduction in the required number of variables and constraints. Although the problem can be solved using an optimal heuristic also presented here, we offer both procedures, as the variable reducing technique could be applied to harder problems.

Our second approach corresponds to an optimal heuristic, which solves the problem in polynomial time and can be used easily for large real instances.

The remainder of this article is organised into four sections. In Section 2, we offer a Literature review. Section 3 formulates the maximin problem for hazardous materials routing as an exact formulation and includes an optimal heuristic; Section 4 describes a practical application of the proposed methodology and analyses the results; and finally, Section 5 presents our conclusions and some possibilities for future research.

@&#LITERATURE REVIEW@&#


                        Erkut, Tjandra, and Verter (2007) have identified nine different risk estimators: the exposed population (ReVelle, Cohon, & Shobrys, 1991); the probability of an accident (Abkowitz, Lepofsky, & Cheng, 1992; Saccomanno & Chan, 1985; Marianov & ReVelle, 1998); the expected consequence, defined as the product of the probability of an accident and its associated consequences (Alp, 1995; Batta & Chiu, 1988; Pijawka, Foote, & Soesilo, 1985; Erkut & Verter, 1995); the expected consequence given that an accident has occurred along the route (Sivakumar, Batta, & Karwan, 1993, 1995; Sherali, Brizendine, Glickman, & Subramanian, 1997); risk aversion, the perceived risk along a link being measured as pCq
                        , where p is the probability of an accident on the link, C is the consequence of an accident and q is a risk preference parameter (Abkowitz et al., 1992); a demand satisfaction model proposed by Erkut and Ingolfsson (2005) in which an accident terminates a trip, necessitating a new shipment to fulfil demand; the maximum exposed population (Erkut & Ingolfsson, 2000); simultaneous consideration of the expected value and variance of the number of people affected by an accident (Erkut & Ingolfsson, 2000); and expected disutility, using a disutility function of the form u(X)=exp(αX) where X is the affected population and α
                        >0 a constant measuring catastrophe aversion (Erkut & Ingolfsson, 2000).

In addition to these nine estimators, Jin and Batta (1997) propose six ways of modelling risk based on expected consequence in terms of the number of HAZMAT shipments or trips S to be made and the threshold number of accidents Q. In these formulations, shipments cease once a number Q of accidents have occurred or when S trips have been made, whichever comes first. The shipments are considered as a sequence of independent Bernoulli trials and a trip terminates if either an accident occurs or the destination is reached.

Some authors incorporate equity into the spatial distribution of risk in HAZMAT routing. For example, Zografos and Davis (1989) include the concept indirectly by placing flow capacity constraints on the various links in the transport network. Marianov and ReVelle (1998) propose stipulating an upper bound on the total risk associated with each link. Gopalan, Batta, and Karwan (1990a) consider a route defined by an origin–destination pair to be equitable if the difference between the risk levels imposed on any pair of zones in the neighbourhood of the route stays below a preset threshold. They calculate the risk associated with a link in the route as the sum of the risks imposed on the various zones in the link’s neighbourhood, an approach that could double-count part of the population. The same authors extend their model in Gopalan, Kolluri, Batta, and Karwan (1990b) to identify a set of routes for making T trips between a single origin–destination pair. They minimize the total risk over the T trips while maintaining the difference in total risk between every zone pair under a certain equity threshold, the latter given for any pair by the differences in risk summed over the T trips. Lindner-Dutton, Batta, and Karwan (1991) take this model further, focusing on the search for an equitable sequence for the T trips. They minimize the sum of the maximum differences in risk between any zone pair accumulated over t trips (t
                        =1,…,
                        T). Other approaches to the equitable risk distribution for a set of trips between a given origin–destination pair may be found in Dell’Olmo et al. (2005) and Caramia, Giordani, and Iovanella (2010).

All of the above-mentioned works use subjective risk thresholds without defining any standard. Moreover, they all consider risk as an attribute of the route links rather than the population centres along it. This approach, if not used carefully, could lead to under-or overestimation of both risk itself and the differences in risk between population centres.

Risk measures do not incorporate distance. However, hazard, defined by Rasmussen (1981) as the potential for producing an undesired consequence without regard to the probability of its occurrence does depend on distance. The phenomenon is acknowledged by Saccomanno and Shortreed (1993), Jonkman, van Gelder, and Vrijling (2003), Fernández, Fernández, and Pelegrín (2000) and Karkazis and Boffey (1995), who note that distance should be a factor to incorporate in models dealing with HAZMAT transportation.

Three studies which do incorporate distance into their formulations are Erkut and Verter (1995), Carotenuto, Giordani, and Ricciardelli (2007) and List and Mirchandani (1991). In the first one, two models are proposed. The first model assumes population concentrated at points on a plane, while the second treats population centres as two-dimensional objects. Both models use probabilities (of an accident, of an incident given an accident, and probability of a material release) that are difficult to estimate. In the paper, the models are used to choose among several routes. In Carotenuto et al. (2007), assuming the population is located on the transport network links (populated links), the authors calculate, for each unit-length segment x of a link, the risk imposed by its use for HAZMAT transport on each populated segment y in the network. The calculation is made only within a threshold distance measured from the centre of segment x. For each populated segment y within that distance, the authors multiply the population along that segment by a function that decreases exponentially with the distance between the two segments and the probability of an incident on segment x. The sum of the risks imposed by the use of each segment x of a link gives the total risk associated with that link, and by the same token, the total risk imposed by a route is the sum of the risks imposed by each of its constituent links. Heuristic procedures are applied to generate a set of alternative routes between an origin–destination pair and the total risk is then minimized, with a preset upper limit on the total risk over the populated links. Note, however, that this methodology could generate a risk overestimation whose magnitude increases with the density of the network.

Finally, List and Mirchandani (1991) also take into account the distance from a HAZMAT route to a population. They calculate, for each population centre, the integral over the entire route of a function of the distance between a point representing that centre and each point on the route, said distance being weighted by the size of the population centre and the probability of an incident at the route point. The authors define the risk associated with each route and each population point as a function of the integral, but do not propose any specific functional form. The total risk imposed by a route is the sum of the individual risks it imposes on each population centres. However, in their case study List and Mirchandani (1991) recognise the complexities of their method and instead of the function as just described they employ the expected fatalities. Furthermore, as with Carotenuto et al. (2007) their formulation requires that the candidate routes be explicitly enumerated.

Following List and Mirchandani (1991) and Bronfman and Marianov (2013) propose two new objectives for HAZMAT transport: the hazard or danger a population centre located near a route is exposed to (danger exposure) and the length of time it is exposed (time exposure). The level of danger is a function of the distance between a population centre and each point on the route segment in its danger area. But neither pair of authors consider possible differences in the spatial distribution of the danger or total imposed risk even though the perception of risk inequity often leads to public opposition to HAZMAT transport along nearby routes (Erkut et al., 2007).

We remark that there are at least two approaches to risk mitigation. In the first one, which most of the literature follows, routes are prescribed by authorities, while in the second approach, rules are defined that the vehicles carrying HAZMAT must respect. Using this indirect approach, Kara and Verter (2004), Erkut and Gzara (2008) and Amaldi, Bruglieri, and Fortz (2011) formulate the hazmat network design problem, as a bi-level mathematical programming problem that explicitly captures the leader–follower nature of the relationship between authorities and transportation operators. In the first level, authorities restrict the routes to a sub-set of the network arcs, which is found by minimizing a risk function. On a second level, operators find cost-minimizing routes over the restricted network. Erkut and Alp (2007) solve the hazmat network design problem for a large urban centre. The problem is formulated as a selection of minimum risk Steiner trees. Verter and Kara (2008) approach the same problem by generating a set of feasible routes for HAZMAT transportation. Each route represents a point on the risk-cost trade-off boundary. Marcotte, Mercier, Savard, and Verter (2009) propose the use of tolls to redirect the routes through less populated areas. Again, a bi-level problem is formulated, which can be reduced to a mixed-integer single-level problem. Bianco, Caramia, and Giordani (2009) minimize both risk and risk equity, assuming that authorities limit the amount of HAZMAT traffic over network arcs. A different approach was adopted by Bruglieri, Cappanera, and Nonato (2014), who propose to reroute HAZMAT through compulsory control points or gateways. The problem consists of locating a fixed number of gateways and their assignment to trucks, so that the total risk of the minimum cost route of each truck through gateways is minimized.

Maximin objectives have been considered in previous works, although mostly over a continuous space (in a plane). For example, Drezner and Wesolowsky (1989), determine an obnoxious route through a restraining polygonal region containing a set of points such that the minimum weighted distance between the route and the points is maximised. They also locate a straight-line route that maximises the minimum weighted distance to the points in a region circumscribed by the points’ convex hull. Díaz-Báñez, Gómez, and Toussaint (2005) consider both the route cost and the minimization of risk in a continuous space. Their approach finds a route between an origin–destination pair whose length does not exceed a preset value (the route cost objective) while maximising the minimum distance to a set of population centres or points (the minimum risk objective). Barcia, Dı́az-Báñez, Lozano, and Ventura (2003) solve the fixed-length obnoxious anchored segment location problem by maximising the minimum Euclidean distance between n points and a route segment with one fixed endpoint. Díaz-Báñez and Hurtado (2006) locate an obnoxious route made up of two links joined at a corner with fixed endpoints at the route origin and destination. Also, for a given set of points and a positive value l
                        0, the authors calculate an obnoxious 1-corner polygonal chain of maximum length l
                        0 that maximises the minimum distance to the points. Díaz-Báñez, Ramos, and Sabariego (2007) assume demand is concentrated in polygonal regions instead of at points and then solve the maximin line problem, that is, the problem of locating the straight line that maximises the minimum weighted distance between the set of polygons and the line. They also address the extension of the problem to three dimensions (Díaz-Báñez, Hurtado, Meijer, Rappaport, & Sellares, 2002; Díaz-Báñez, López, & Sellarès, 2006; Dı́az-Báñez, Mesa, & Schöbel, 2004), as do Follert (1995) and Follert, Schömer, Sellen, Smid, and Thiel (1997).

Closest assignment constraints have been used in many location problems (see Gerrard & Church, 1996; Espejo, Marín, & Rodríguez-Chía, 2012), including the ordered capacitated facility location problem (Kalcsics, Nickel, Puerto, & Rodríguez-Chía, 2010), r-interdiction median problems (Church, Scaparra, & Middleton, 2004; Liberatore, Scaparra, & Daskin, 2011), the budget constrained median problem (Rojeski & ReVelle, 1970), the competitive location problem (Dobson & Karmarkar, 1987), the plant location problem with order (Cánovas, García, Labbé, & Marín, 2007), the obnoxious p-median problem (Belotti, Labbé, Maffioli, & Ndiaye, 2007), the location with equitable load problem (Berman, Drezner, Tamir, & Wesolowsky, 2009), models for locating regional energy facilities (Church & Cohon, 1976) and location models for maximising social welfare or consumer surplus (Wagner & Falkson, 1975). Further applications of closest assignment constraints may be found in Plastria (2002), Hanjoul and Peeters (1987) and Marín (2011), and finally in Lei and Church (2011), who discuss their use in the context of multi-level assignments. We have not found literature on the use of these constraints in routing.

Let a transport network be defined by a directed graph G(N,
                        A), where N
                        ={1,…,
                        n} is the set of nodes and A
                        ={1,…,
                        m} the set of links. There is a cost cij
                         associated with the use of link (i,
                        j)∊
                        A and a set of vulnerable zones or centres, each of which is represented by a point p
                        ∊
                        P
                        ={1,…,
                        q} in the plane at which the population Dp
                         is assumed to be concentrated. A HAZMAT load is to be transported between a known origin–destination pair O–D along a route that maximises its minimum distance to the vulnerable centres, weighted by the reciprocal of each centre’s population. Note that, depending on what type of HAZMAT is being considered, any estimator of danger or risk could be used instead, as long as it is non-decreasing with distance, without changing the structure of the model. In this case, by using the reciprocal of the population, the most populated centres become more important to protect. Other estimators are the distance itself; functions of the distance and the risk, and so on. Let 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                           
                         be the Euclidean distance between vulnerable centre p and its closest point on link (i,
                        j)∊
                        A.

The decision variables are:
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if link
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                   
                                                   is used for HAZMAT transport
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if not
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if link
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                   ,
                                                   
                                                   
                                                   used for HAZMAT transport,
                                                   
                                                   is the closest link to
                                                   
                                                   p
                                                   ∈
                                                   P
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if not
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        w: minimum weighted distance from the route to a vulnerable centre at p
                        ∊
                        P.

The basic model of the problem, M
                        1, is formulated as follows:
                           
                              (1)
                              
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 
                                 Max
                                 
                                 w
                              
                           
                        
                        
                           
                              
                                 s
                                 .
                                 t
                                 .
                              
                           
                        
                        
                           
                              (2)
                              
                                 w
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 1
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          k
                                          ,
                                          l
                                          )
                                          ∈
                                          A
                                          /
                                          
                                             
                                                d
                                             
                                             
                                                kl
                                             
                                             
                                                p
                                             
                                          
                                          ⩽
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       kl
                                    
                                    
                                       p
                                    
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          j
                                          /
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          j
                                          /
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          A
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                
                                                
                                                   i
                                                   =
                                                   O
                                                
                                             
                                             
                                                
                                                   -
                                                   1
                                                
                                                
                                                   if
                                                
                                                
                                                   i
                                                   =
                                                   D
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 N
                              
                           
                        
                        
                           
                              (7)
                              
                                 w
                                 ⩾
                                 0
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                              
                           
                        The objective (1) maximises the minimum weighted distance w between a vulnerable centre and its assigned link. Constraint set (2) equates w to the shortest weighted distance between the route and any vulnerable centre p
                        ∊
                        P. Constraint set (3) ensures that only one link on the route is assigned to any vulnerable centre, constraint set (4) imposes that this single assigned link is the closest one and constraint set (5) prevents any vulnerable centre from being assigned to a link that is not part of the route. Finally, the network flow conservation conditions are given by (6) and the nature of the variables is defined by (7)–(9).

The above formulation contains (mq
                        +
                        n
                        +1) decision variables and (2q
                        +2mq
                        +
                        n
                        +1) constraints, requiring large amounts of computational memory and execution time to solve even small instances of the problem. We therefore propose the following reformulation, which significantly reduces the number of required variables and constraints.

Let η be the threshold (maximum) distance from the HAZMAT route to a vulnerable centre p
                        ∊
                        P beyond which the effects on the centre of a HAZMAT release event occurring on the route are insignificant. Since p is a point, η is also the radius of a circle bounding the area within which the centre is exposed to danger. This implies that variables and constraints relating a centre to links at distances greater than η can be eliminated. Decision variables 
                           
                              
                                 
                                    z
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                           
                         are therefore defined only for combinations centre p-link (i,
                        j) such that 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              η
                           
                        . In other words, for a centre located at p, 
                           
                              
                                 
                                    z
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              =
                              0
                           
                         for all links 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              /
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              >
                              η
                           
                        . Also, for each centre p a variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    η
                                 
                                 
                                    p
                                 
                              
                           
                         is defined that is equal to 1 if the distance to the closest link is greater than η, and 0 otherwise. This variable replaces all of the variables assigning p to links 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              /
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              >
                              η
                           
                        . If, in the solution of the problem, 
                           
                              
                                 
                                    z
                                 
                                 
                                    η
                                 
                                 
                                    p
                                 
                              
                           
                         is equal to 1, the corresponding centre p suffers no consequences of an event along the route.

The model with the number of variables thus reduced, which we name M
                        2, is formulated as follows:
                           
                              (10)
                              
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 
                                 Max
                                 
                                 w
                              
                           
                        
                        
                           
                              
                                 s
                                 .
                                 t
                                 .
                              
                           
                        
                        
                           
                              (11)
                              
                                 w
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          ⩽
                                          η
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 
                                    
                                       η
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             η
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       η
                                    
                                    
                                       p
                                    
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          ⩽
                                          η
                                          }
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       η
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          k
                                          ,
                                          l
                                          )
                                          ∈
                                          A
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                kl
                                             
                                             
                                                p
                                             
                                          
                                          ⩽
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       kl
                                    
                                    
                                       p
                                    
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 η
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 η
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       z
                                    
                                    
                                       η
                                    
                                    
                                       p
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          >
                                          η
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       z
                                    
                                    
                                       η
                                    
                                    
                                       p
                                    
                                 
                                 ⩾
                                 1
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          ⩽
                                          η
                                          }
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          j
                                          /
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          j
                                          /
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          A
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                
                                                
                                                   i
                                                   =
                                                   O
                                                
                                             
                                             
                                                
                                                   -
                                                   1
                                                
                                                
                                                   if
                                                
                                                
                                                   i
                                                   =
                                                   D
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 N
                              
                           
                        
                        
                           
                              (18)
                              
                                 w
                                 ⩾
                                 0
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       η
                                    
                                    
                                       p
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                              
                           
                        Constraint set (11) is equivalent to (2) in M
                        1 but contains an additional term for the case where 
                           
                              R
                           
                        , the route used, has no link sections within the danger area of a given centre. This term consists of the variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    η
                                 
                                 
                                    p
                                 
                              
                           
                         weighted by the distance η and divided by a factor Dη
                         such that w
                        =
                        η/Dη
                         only if no centre has a route link within a distance η. For this to be so, it must be true that 
                           
                              η
                              /
                              
                                 
                                    D
                                 
                                 
                                    η
                                 
                              
                              ⩾
                              max
                              {
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              }
                              /
                              
                                 
                                    min
                                 
                                 
                                    p
                                    ∈
                                    P
                                 
                              
                              {
                              
                                 
                                    D
                                 
                                 
                                    p
                                 
                              
                              }
                              =
                              η
                              /
                              
                                 
                                    min
                                 
                                 
                                    p
                                    ∈
                                    P
                                 
                              
                              {
                              
                                 
                                    D
                                 
                                 
                                    p
                                 
                              
                              }
                           
                        . If these conditions are satisfied and w
                        =
                        η/Dη
                         in the solution of the problem, then no centre is located within distance η of the route and none will suffer any consequences of a HAZMAT event along it.

Constraint set (12) imposes that each vulnerable centre p is assigned no more than one link, which will be either the closest one if 
                           
                              ∃
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              R
                              |
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              η
                           
                        , or a link representing routes beyond distance η. Constraint set (13) ensures that if there is more than one link 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              R
                              |
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              η
                           
                        , the link assigned to p will be the closest one.

Constraints sets (14) and (15) prevent an inactive link from being assigned to a centre within or beyond the threshold distance, respectively. Constraint set (16) stipulates that if no 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              R
                              |
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              η
                           
                         exists, then the weighted distance η/Dη
                         must be assigned to centre p. (Note here that although constraint sets (12) and (16) could be formulated as a single set with an equal sign, they have been expressed separately for the sake of clarity.) Finally, constraint set (17) states the network flow conservation conditions, and constraints (18) and (19) define the nature of the decision variables.

Since the goal of the model is to find routes that stay clear of vulnerable areas whenever it is possible, it is reasonable to think that the better the value of the objective, the longer are the route and the distance travelled by a vehicle. This is more so as the threshold distance η (and therefore the centre danger area) increases. Consequently, the maximin objective is attractive to the resident population and the regulatory authorities, but not for the carrier attempting to minimize operating costs and therefore route length.

The exact model can be easily modified to include the minimization of the carrier’s operating costs, in a bi-objective model. Using the same notation and definitions presented above, the bi-criteria HAZMAT routing problem is set out below as model M
                        3:
                           
                              (20)
                              
                                 
                                    
                                       M
                                    
                                    
                                       3
                                    
                                 
                                 
                                 Min
                                 
                                 
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 w
                                 ,
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 }
                              
                           
                        
                        s.t. 
                        (11)–(19).

To generate the set of efficient solutions, the two objectives i are each multiplied by a non-negative weighting factor θi
                         and then summed in a single objective function. By parametrically varying the weighting factor vector the efficient set can be generated, or at least approximated (Cohon (1978)). A possible formulation that normalises the values of the objectives is the following parametric linear program, denoted M
                        4:
                           
                              (21)
                              
                                 
                                    
                                       M
                                    
                                    
                                       4
                                    
                                 
                                 
                                 Max
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      AI
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        s.t. (11)–(19)
                        
                           
                              (22)
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 w
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        The normalisation is performed by subtracting the objective i from its best achievable value Ii
                         and then dividing the result by (Ii
                        
                        −
                        AIi
                        ), where AIi
                         is the worst value the objective can attain. The values are thus transformed into percentage deviations, thereby sidestepping problems of dimensional homogeneity and solutions biased towards the objective with the highest absolute value.

This bi-criteria approach would be particularly useful in practical HAZMAT routing decisions. Instead of selecting just one of the objectives, a decision-maker could apply the bi-criteria approach to generate a set of efficient alternatives and then choose a solution based on the interrelationship between the two criteria and their relationships with other attributes such as the value of the distance threshold η.

Let 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    p
                                 
                              
                           
                         be the weighted distance between an arc (i,
                        j)∊
                        A and a node p
                        ∊
                        P. This weighted distance is defined only for arcs 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              |
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              η
                           
                        , since beyond η the consequences of an accident for the population at p are negligible. The minimum weighted distance δij
                         between any arc (i,
                        j)∊
                        A and any centre p
                        ∊
                        P is 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    Min
                                 
                                 
                                    ∀
                                    p
                                    ∈
                                    P
                                 
                              
                              {
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              }
                           
                        . Given a route Rk
                         between an O–D pair over the network G(N,
                        A), the minimum weighted distance 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                         between the route Rk
                         and any point p
                        ∊
                        P is 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    Min
                                 
                                 
                                    {
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                              
                              {
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                              
                              }
                           
                        .


                              
                                 
                                    a.
                                    
                                       k
                                       =0. η given.


                                       
                                          
                                             ∀
                                             p
                                             ∈
                                             P
                                             ,
                                             ∀
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   ij
                                                
                                                
                                                   p
                                                
                                             
                                             ⩽
                                             η
                                          
                                       , compute 
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ij
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       . 
                                          
                                             ∀
                                             p
                                             ∈
                                             P
                                             ,
                                             ∀
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   ij
                                                
                                                
                                                   p
                                                
                                             
                                             >
                                             η
                                          
                                       , set 
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   ij
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             ∞
                                          
                                       .

For all (i,
                                       j)∊
                                       A, compute δij
                                       .


                              
                                 
                                    a.
                                    Find a route R
                                       0 connecting the pair O–D, e.g., using a shortest path heuristic.
                                          
                                             i.
                                             If there is no possible route, the graph is disconnected and the problem is unfeasible. Stop.

If there is a route R
                                                0, compute 
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                .
                                                   
                                                      −
                                                      If 
                                                            
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           R
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         =∞, R
                                                         0 is an optimal solution for the given η, and w
                                                         =∞. Stop.

If 
                                                            
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           R
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         <∞, continue to Step 2.


                              
                                 
                                    a.
                                    Compute 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             A
                                             -
                                             {
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             |
                                             
                                                
                                                   δ
                                                
                                                
                                                   ij
                                                
                                             
                                             ⩽
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             }
                                          
                                       . If k=
                                       0, Ak−1
                                       
                                       =
                                       A. Gk
                                       (N,
                                       Ak
                                       ) is the graph containing all nodes, and arcs in Ak
                                       .


                                       k
                                       =
                                       k
                                       +1.

Find a route Rk
                                        over Gk−1
                                       (N,
                                       Ak−1
                                       ) connecting the pair O–D.
                                          
                                             i.
                                             If there is no possible route Rk
                                                , the graph is disconnected. Rk−1
                                                 is an optimal solution for the given η, and w
                                                =
                                                
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  k
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                . Stop.

If there is a route Rk
                                                , compute 
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                . Repeat Step 2.

The heuristic is optimal by construction. It suffices to prove that it converges, and that it converges to the solution in a finite number of steps. Convergence is proved noting that at each iteration, all arcs (i,
                              j) are eliminated such that 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ij
                                       
                                    
                                    ⩽
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              , which makes 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                               increasing with k. Since 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                               is bounded by the maximum distance between an arc and a centre on the network, convergence follows. The heuristic is finite, because the number of arcs to be eliminated is finite, and arcs must be eliminated at each step. It converges to the optimum, because it either finds a route with w
                              =∞, or there is no best possible solution than the last route found right before the problem becomes unfeasible. It is polynomial, because at every iteration a shortest path algorithm is used, which is polynomial, and at most, the number of iterations is equal to the number of arcs, m.

Note that, if a shortest path algorithm is used within the heuristic to find the routes, not only the optimal solution to the minimax problem is found: the heuristic minimizes, as a secondary objective, the length of the route. Furthermore, the heuristic finds the nondominated solutions to the bi-objective problem, for a given η.

We applied the proposed formulations to two real-world instances, both considering the road network of the city of Santiago, Chile. This city has an area of 641squarekilometre (247.6squaremiles). Model M
                     2 and the Heuristic were applied first to an instance involving the entire urban area of the city. A smaller instance, covering a relatively large section of the city, was used for showing how the bi-objective model M
                     4 can be used to obtain compromise solutions, between public and government objectives, and those of carriers.

We solved the single-objective M
                        2 model, and compared run times with the heuristic. The model was slightly modified by adding the term 
                           
                              φ
                              
                                 
                                    ∑
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                 
                              
                              
                                 
                                    l
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                         to the objective, where lij
                         is the length of link (i,
                        j), and φ is a constant sufficiently small so as to guarantee that the added term is a secondary objective, i.e., its minimization will not worsen the optimal value of w in the solution. This secondary objective plays two roles: it helps the model choosing the shortest route among all the available routes with the same value of w and, at the same time, avoids arc variables xij
                         not corresponding to links of the route, unnecessarily taking the value 1 in the solution.

Both solution methods were applied to the city of Santiago, shown in Fig. 1
                        , which is criss-crossed by a road system we call Transport Network 1 containing 6681 directed links and 2212 nodes. In this area there are 244 vulnerable centres (schools with over one thousand students) with a total of 386,254 people (students). Each school has from 1070 to nearly 4500 students. HAZMAT shipments are to be transported between three O–D pairs located in industrial zones and shown in the Figure as O1–D1, O2–D2 and O3–D3.


                        Tables 1 and 2
                        
                         illustrate the reduction in the number of constraints and variables, respectively, for Transport Network 1, by using the formulation M
                        2 instead of M
                        1. The figures are shown for three different values of η. As the Tables show, formulation M
                        1 requires 1,636,846 such variables and 3,262,289 constraints while M
                        2 with η
                        =1000 needs only 19,698 and 28,533 constraints respectively. This significant reduction is maintained for all values of η.

The instance was solved on a personal computer running Ubuntu 12.04 LTS with a 3.40Gigahertz Intel ® Core™ i7-2600 processor and 16Gigabyte of RAM. The implementation was developed in AMPL Cplex 12.5.

The results obtained by M
                        2 and the heuristic, for different values of η and different O–D pairs are identical, except for the CPU times, and they are set forth in Tables 3–5
                        
                        
                        . The first column shows the value of η. The second and third columns display the value of w and the route length, respectively, obtained by both methods. An entry “–” in the second column indicates that the route does not expose any vulnerable centre, i.e., stays out of the danger areas of all points. The fourth and fifth columns show the CPU times for each method. The heuristic never exceeded 1.1seconds, while the exact model required 374.92seconds (6.2minutes) in the worst case. Note that for small values of η, as this parameter increases, the route becomes longer, so that it stays outside of all danger areas (this happens for η
                        =100–400 for pair O1–D1, η
                        =100–300 for pair O2–D2 and η
                        =100–400 for pair O3–D3), until it is not possible to stay clear of the centres.


                        Figs. 2–4
                        
                        
                         show the paths for each one of the O–D pairs for selected values of η. In the figure, the circles represent the danger area of each vulnerable centre, and the grey circles represent the danger areas exposed by the selected path.

Note in Figs. 2–4, how once it is not possible for the route to stay out of the danger areas, it starts crossing one danger area and then, it reaches a point at which it stays the same no matter how large is η. However, as η increases beyond that point, the number of affected centres also increases.

In Fig. 4, the route for η
                        =1000 needs to be extremely long to maintain the value of w.

When η
                        =400–1000m, the corresponding values of 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                           
                         and Dp
                         for each vulnerable centre p and each route obtained are as shown in Table 6–8
                        
                        
                        , corresponding to each one of the O–D pairs. The entries “–” in the tables indicate that 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              >
                              η
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              R
                           
                        , i.e., the route stays clear of the centres.

The effect of η on the value of w and the route length can be seen, for example, for the pair O1–D1 on Table 6. When η
                        =600m, centres 62, 99, 160, 182 and 219 are exposed, with centre 99 being the most affected, as 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    99
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    99
                                 
                              
                           
                         is the lowest weighted distance. In this case, w
                        =
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    99
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    99
                                 
                              
                           
                        
                        =0.349. Note that, even though centre 219 is closer to the route (
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    219
                                 
                              
                           
                        
                        =439metre) than centre 99 (
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    99
                                 
                              
                           
                        
                        =542metre), its population is smaller, which results in a value of 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    219
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    219
                                 
                              
                              =
                              0.388
                           
                        , above the minimum figure. The route obtained is shown in Fig. 2c. When η
                        =700, 800, 900 and 1000m, the number of exposed centres increases. Centre 99 with 
                           
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                                 
                                    99
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    99
                                 
                              
                              =
                              0.349
                           
                         is the one that remain setting the value of w.

In order to show the effects of different policies, assigning higher weights on either the public concerns (routes farther away from most populated centres) or carrier’s issues (cost of the routes), model M
                        4 was applied to a network representing part of the Santiago network, shown in Fig. 5
                        .

The road system serving this area, denoted Transport Network 2, contains 1521 links, 504 nodes and 30 vulnerable centres with 81,434 inhabitants. Centres have between 308 and 6074 people each.

We assume without loss of generality that the cost cij
                         of using link (i,
                        j)∊
                        A is proportional to its length. The threshold distance η was set to 700m. To determine the best and worst values (Ii
                         and AIi
                        , respectively) for the two objectives, each one was optimised separately, using M
                        2 and a shortest path algorithm. The results, shown in Table 9
                        , reveal the essential conflict between the two objectives: When optimising the value of w, the route length was 22.61km, a 21.7% longer than the shortest route, while the value for w was about 5 times the figure of 55.65m/person obtained when minimizing the length of the route.

The efficient frontier between the two objectives was generated by varying the values of parameter θi
                         (with θ
                        1
                        =1−
                        θ
                        2) in M
                        4. The results are displayed in Table 10
                        , the frontier is shown in Fig. 6
                        , and the routes obtained depicted in Fig. 7
                        . Each point in Fig. 6 represents a different route. The lowest cost solution is equivalent to the one obtained when the model is solved with θ
                        1
                        =0.1 (Fig. 7a). With values of θ
                        1 between 0.2 and 0.6, the route is as shown in Fig. 7b (point B in Fig. 6) while values 0.7 and 0.8 yield the route in Fig. 7c (point C in Fig. 6). Finally, the solution attained with θ
                        1
                        =0.9 (see Table 10) dominates the route produced by M
                        2 (see Table 10). For both formulations w
                        =0.279 but the route generated by M
                        2 is longer, measuring 22.61km versus 21.67km for M
                        4, the latter with θ
                        1
                        =0.9 (Fig. 5d).

An approach was proposed for addressing the hazardous materials routing problem on a transport network. The proposed approach maximises the weighted distance between the route and its closest vulnerable centre in order to minimize the potential consequences for the most exposed population. This weighted distance can be replaced by any measure of risk or danger, as long as it is a non-decreasing function of the distance.

Though this maximin objective has been treated in a continuous space setting, it has not been previously studied for an actual road network. A basic formulation of the problem requires a large number of closest assignment constraints and decision variables, making it very difficult to solve. A practical first alternative was therefore developed that required a significantly reduced subset of the variables and constraints for each vulnerable centre. The reduction is achieved by replacing a large number of variables by a single variable for each vulnerable centre.

A second alternative solution method, also presented here, is a heuristic that is capable of solving large real sized instances to optimality, in a polynomial time. The heuristic is easily implemented and it can be extended to multiple variants of the problem.

Both the exact method and the heuristic were tested by applying them to the transport network in the city of Santiago, Chile. The results illustrated how the solution varies with danger areas of different radii. This problem is easily solved by using the proposed heuristic.

Though the objective of avoiding such areas is attractive for the resident population and the regulatory authorities, it is not necessarily so for the carrier seeking to minimize operating costs. A bi-criteria problem was therefore formulated that captures the relationship between the maximin and minimum cost objectives. The model was applied to a smaller area of the Santiago road network and the efficient frontier between the two objectives was estimated, as a way to show the effects of different policies. The approach proved capable of generating a set of efficient alternatives for different threshold values, in a real-sized instance, suggesting it could be applied also in other real-world situations by decision-makers to find an appropriate HAZMAT route based on assigned priorities.

This study could be extended in various directions. The population’s hazard aversion could be represented in the proposed formulation as a function of the distance to the route travelled by means of danger areas and danger function variables that could be modelled to depend on the vulnerable centre, with multiple HAZMAT shipments between multiple origin–destination pairs.

An additional objective could be added to the problem, as a way to take into consideration the fact that the maximin objective does not allow controlling how many vulnerable centres are being put in danger.

The approach developed could also be expanded to address a multi-criteria HAZMAT routing problem incorporating criteria such as expected consequences, time exposure, population exposure or total danger, which could be satisfied jointly with the maximisation of the minimum weighted distance and minimum operating cost for both single and multiple shipments between multiple origin–destination pairs.

@&#ACKNOWLEDGEMENTS@&#

We gratefully acknowledge the support by FONDECYT Grant No. 1130265, by the Complex Engineering Systems Institute through grants ICM-MIDEPLAN P-05-004-F and CONICYT-FBO16, and to the National Research Center for Integrated Natural Disaster Management CONICYT/FONDAP/15110017. We also thank two anonymous reviewers who contributed to significantly improve the paper.

@&#REFERENCES@&#

