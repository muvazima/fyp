@&#MAIN-TITLE@&#An efficient method for automatic morphological abnormality detection from human sperm images

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Automatically selection of normal sperms.


                        
                        
                           
                           Working on unstained sperms.


                        
                        
                           
                           Ability to work on low resolution images.


                        
                        
                           
                           High accuracy and real-time processing time.


                        
                        
                           
                           Preparing a freely available dataset.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human sperm

Sperm morphometry

Automatic analysis

Sperm defects

Infertility

Image processing

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Sperm morphology analysis (SMA) is an important factor in the diagnosis of human male infertility. This study presents an automatic algorithm for sperm morphology analysis (to detect malformation) using images of human sperm cells.
               
               
                  Methods
                  The SMA method was used to detect and analyze different parts of the human sperm. First of all, SMA removes the image noises and enhances the contrast of the image to a great extent. Then it recognizes the different parts of sperm (e.g., head, tail) and analyzes the size and shape of each part. Finally, the algorithm classifies each sperm as normal or abnormal. Malformations in the head, midpiece, and tail of a sperm, can be detected by the SMA method. In contrast to other similar methods, the SMA method can work with low resolution and non-stained images. Furthermore, an image collection created for the SMA, has also been described in this study. This benchmark consists of 1457 sperm images from 235 patients, and is known as human sperm morphology analysis dataset (HSMA-DS).
               
               
                  Results
                  The proposed algorithm was tested on HSMA-DS. The experimental results show the high ability of SMA to detect morphological deformities from sperm images. In this study, the SMA algorithm produced above 90% accuracy in sperm abnormality detection task. Another advantage of the proposed method is its low computation time (that is, less than 9s), as such, the expert can quickly decide to choose the analyzed sperm or select another one.
               
               
                  Conclusions
                  Automatic and fast analysis of human sperm morphology can be useful during intracytoplasmic sperm injection for helping embryologists to select the best sperm in real time.
               
            

@&#INTRODUCTION@&#

Infertility is defined as the inability to conceive after 12 months of unprotected intercourse. Almost 15% of couples are infertile and at least 30–40% are attributed to male factor abnormalities [1,2]. Abnormalities in sperm morphology are often recognized as causes of fertility problems and may result to teratozoospermia.

Sperm quality is an essential parameter which affects oocyte fertilization and embryo quality. There exists a correlation between abnormal sperm and embryo morphology at the later stage of cleavage [3]. Thoroughly, sperm development during spermatogenesis is reflected in the shape of the sperm. Consequently, a defect in sperm maturation causes problems and abnormalities in sperm morphology and its functionality in egg fertilization [4]. Male infertility can be determined by assessing some seminal plasma characteristics and sperm parameters, such as semen viscosity, volume, pH and sperm morphology, vitality, motility, and concentration [5].

In 1992, the first pregnancy and live birth of a child using intra-cytoplasmic sperm injection (ICSI) method occurred [6]. In recent times, ICSI has been used for various couples with normal, mildly, or severely abnormal semen parameters and by all means, in patients needing assisted reproductive technologies [7]. In several studies, the positive correlation between normal sperm morphology and high ICSI outcomes has been proven. In fact, low fertilization, implantation, and conception (pregnancy) rates are well associated with severe abnormalities of the sperm head [8].

Menkveld et al. [9] defined the normal sperm morphology as follows: the length and width of the sperm head are respectively between 3 and 5μm and between 2 and 3μm (between three-fifths and two-thirds of the head length) and with a well defined acrosome comprising 40–70% of the sperm head. The midpiece is axially presented as <1μm in width and its size is one and a half times the head length. Also, the normal tail characteristics must be visible, such as uniformity, uncoiled, thinner than the midpiece, and with length of 45μm. Cytoplasmic droplets (remnants) which comprised less than half of the sperm's head size can be also present.

In the intracytoplasmic morphologically selected sperm injection (IMSI) procedure, sperm selection is performed at high magnification (usually ×6000) [8]. Although, laboratories are commonly equipped with low magnification (∼×400 and ×600) microscopes, sperm selection by ICSI criteria and injection are routinely performed at these magnifications. The visual assessment of sperm is also usually performed manually. This method is subjective, inexact, non-repeatable, and unteachable. The CASA (computer aided sperm analysis) system is another way of assessing male fertility and it involves the use of different staining procedures [10]. These automatic techniques for analyzing human sperm morphology are essential to avoid human errors and variation in results. Therefore, researches still tend to the newly developed methodology and knowledge enrichment to analyze, classify, and select the best sperm morphology, before using ICSI [11]. As a result, computerized methods to select the best sperm morphology without staining and just before the use of ICSI, will be more suitable for embryologists.

Numerous studies have focused on the computerized selection method. In one of such studies, a fraction of boar spermatozoa heads was computed and an intracellular density distribution pattern was considered as normal by Sanchez et al. [11,12]. In this way, a deviation measure from this model was defined and the deviation from the model for the image of each sperm's head was computed. In the next stage, an optimal value for each cell classification was selected. Using morphological closing, the removal of sperm tails and the filling of holes in the contours of the heads were performed. Then, Otsu's method [13] was used to separate the sperm's heads from the background.

Bijar et al. [10] reported a fully automatic identification and discrimination of sperm parts (acrosome, nucleus, midpiece and tail) in microscopic images of stained human semen smear. In this study, sperm segmentation was performed based on a Bayesian classifier that uses the entropy based expectation-maximization (EM) algorithm and the Markov random field (MRF) model. Thus, sperms were stained and analyzed at a high magnification (×1000). Maree et al. [14] evaluated the influence of different staining methods on human sperm head dimensions and compared these with the fresh ones. Based on different staining methods, the morphometric dimension changes of human sperm head, has been reported [14].

In the aforementioned studies, sperms were fixed, stained, and photographed. Therefore, these stained sperms are not useful for the purpose of ICSI in real time. On the other hand, the proposed method in this study, detects fresh human sperm to injection in real time at low magnifications (×400 and ×600). It has an appropriate level of stability to detect sperm region in image. The key contribution of this research is the ability to work on noisy, low quality, and non-stained images. Furthermore, the proposed algorithm reduces noise without the loss of any information in the image. Another advantage of this study's proposed method is that sperm defects can be detected by low computation cost.

@&#METHODS@&#

In this study, the sperms of infertile couples who visited infertility therapy center of Alzahra hospital were analyzed, after obtaining informed consent from the couples. This study was approved by the ethics committee of Guilan University of Medical Sciences.

@&#PROPOSED METHOD@&#

The purpose of this study's algorithm is to enable the effective analysis of sperms in low resolution images. In the first step, the proposed method known as sperm morphology analysis (SMA), detects the region of sperm and then, sperm shape analysis was performed. Every sperm has three main parts: (1) head, (2) neck, and (3) tail. A sperm with abnormality in each of these parts would be considered abnormal sperm and generally have a lower fertilizing potential [5].

The steps in SMA are as shown in Fig. 1
                        . Image noise reduction is the first step of this method. Then, the region of sperms is detected. Thereafter, the main parts of the sperm are analyzed. The details of each step are explained subsequently in this study.

As a result of the low quality of the images, which were taken with a low magnification microscope, noise reduction is an important pre-processing step. Fig. 2
                         shows the details of this step.

The first step in noise reduction is the conversion of RGB color values to YCbCr. For better explanation, a brief description about color spaces is presented. Human eyes can discriminate three components of a color: red, green, and blue [15]. These three components form a color space. A color space is a multi-dimensional space, and each dimension is one of the color's components. There are several color spaces in digital image processing such as RGB, YCbCr, HSV, CMY, and CMYK. Moreover, YCbCr has three components: luminance known as Y, Chromatic blue known as Cb and Chromatic red known as Cr. YCbCr is sometimes abbreviated as YCC. The HSV color space has three components: Hue, Saturation and Value. The CMY and CMYK color space components are: Cyan also known as C, magenta known as M, Yellow known as Y and black known as K [16]. An RGB image can be stored in a three-dimensional array. Each pixel has three values in red, green, and blue. However, in the YCbCr color space, Y shows the luminance, Cb and Cr are the blue and red difference components, respectively. The YCbCr color space is derived from the RGB color space and can be expressed as [17]:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      Cb
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Cr
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      16
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      128
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      128
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      65.481
                                                   
                                                
                                                
                                                   
                                                      128.553
                                                   
                                                
                                                
                                                   
                                                      24.966
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      37.797
                                                   
                                                
                                                
                                                   
                                                      −
                                                      74.203
                                                   
                                                
                                                
                                                   
                                                      112.000
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      112.000
                                                   
                                                
                                                
                                                   
                                                      −
                                                      93.786
                                                   
                                                
                                                
                                                   
                                                      −
                                                      18.214
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                
                                                   G
                                                
                                             
                                             
                                                
                                                   B
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this study, the first step of the noise removal algorithm is the conversion of RGB color values to YcbCr. Thereafter, only the Y dimension was used in the next steps of the algorithm. The outcome of the Y dimension is a gray-scale image containing the noises of the original image. These noises are of uniform distribution in the whole parts of the images; they look like images’ texture. As a result, the first step by the proposed algorithm is to sharpen the noises to separate them from image texture. By applying this sharpening, noises appear like edges of images, after which the Gaussian filter is applied to smooth images. After that, the shape of noises is changed. In other words, the resulting image is suitable for wavelet transformation.

This study proposed the use of a two-dimensional wavelet analysis function for de-noising of images. Algorithm returns the wavelets decomposition of the matrix X at level N. There are different types of wavelet families. By using different wavelet families, there are different trade-offs between the smoothness of the basic functions and how compactly they are localized in space. Each family of wavelets has wavelet subclasses. These subclasses can be distinguished by the level of iterations and the number of coefficients. The number of vanishing moments is often used to classify wavelets to a particular family. This number is an extra set of mathematical relationships for the coefficients that is directly related to the number of coefficients, and must be satisfied. Fig. 3
                         shows several different wavelet families. In the proposed algorithm, Coiflet_2 is used, and decomposition is performed at level 4. After applying the aforementioned wavelet transform, the noises of input images can be removed at an acceptable rate, which formulates appropriate images for further analysis.

Furthermore, after the noise removal step, the quality of images is tolerable for applying edge detection algorithm in order to detect the region of the target sperm. In other words, noises are not in sharpen edge format (noises have been smoothed during preprocessing step), and they will not be regarded as edges during edge detection phase. The sperm region detection algorithm can be seen in Fig. 4
                        .

By applying edge detection, images can be segmented by dividing the different areas. The algorithm uses the Sobel edge detection algorithm, which performs a 2-D spatial gradient measurement on an image [19]. In a grayscale image, for each point, the Sobel operator finds the approximate absolute gradient magnitude. The Sobel edge detector uses a pair of 3×3 kernels, which are convolved with the grayscale image for estimating the gradient in the x- and y-directions. Fig. 5
                         shows the Sobel masks.

The following formula is used to calculate the magnitude of the gradient:
                           
                              
                                 
                                    |
                                    G
                                    |
                                    =
                                    
                                       
                                          G
                                          
                                             x
                                             2
                                          
                                          +
                                          G
                                          
                                             y
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

An approximate magnitude can be also calculated using:
                           
                              
                                 
                                    |
                                    G
                                    |
                                    =
                                    |
                                    G
                                    x
                                    |
                                    +
                                    |
                                    G
                                    y
                                    |
                                 
                              
                           
                        
                     

After the application of Sobel edge detection, some divergence in detected edges may exist, or edges may come from non-sperm parts of the input image. For these reasons, the Median filter algorithm is applied as the second step of the region detection algorithm in order to delete tiny regions without corrupting the earlier determined edge. Filling of image holes and removal of small objects are the last steps of the sperm region detection phase. Small holes of the input images after edge detection were filled to make a uniform image. Then, small objects were removed from the images. Based on this, the algorithm with a threshold value was applied, and in the end, debris and noises are eliminated from images, and as such, only sperms were left in the images.

After detecting the different parts of the sperm cells, different sections were analyzed. Each sperm is divided into three parts: (1) head, (2) neck, and (3) tail. Each of these parts is first detected, and then analyzed. However, the analysis of each part of the sperm has been explained further in this study. The sperm head is the first part recognized for further analysis. Checking the existence of vacuole is another important issue for measuring the quality of sperm. The size of head, the length and width of head were calculated. If the values obtained are not in the standard range, the sperm is not suitable for injection.


                        Fig. 6
                         shows the sperm head recognition phase. The sperm head recognition phase has two main parts: boundary detection and skeleton finding. In order to achieve this goal, the images are transformed to black and white (BW) space. After this transformation, in the first part, erosion morphology operator is applied on the BW images. It should be noted that in morphological image processing, there are two fundamental operations on which all other morphological operations are based: erosion and dilation. The binary erosion of A by B, denoted AΘB, is defined as the set operation AΘB
                        ={z|B
                        
                           z
                        
                        ⊆
                        A}. In other words, AΘB is the set of pixel locations z, where the structuring element translated to location z overlaps only with foreground pixels in A. The boundary of the image can be detected by subtracting the eroded image from the main image. This boundary is used later on in the analysis of sperm head.

In the second part, as shown in Fig. 6, the skeletons of BW images were found. To achieve this goal, a morphology operator was applied to the input images. To detect the skeleton, the algorithm was used to remove pixels on the object boundaries. On the other hand, objects should not break apart. The remaining pixels therefore make up the skeleton of the image. Euler number is preserved by this option. After detecting the skeleton of an image, its branches are removed, and the remaining skeleton now contains the backbone of the sperm. Further, there are two images: (1) boundary and (2) skeleton. By overlaying the two images, an image is produced that contains only a sperm's boundary and its backbone.

Therefore, the head of sperm can now be analyzed based on standard measures. Due to the oval shape of the head, its center is at a point at which the width of the head is large. By so doing, the algorithm detects the nearest point from skeleton to boundary. The lengths of these lines were measured, and the junction of the backbone line and longest line were regarded as the center of the head. However, the head boundary can easily be detected by calculating the center of the head. The complete analysis of this phase is given in the section of experimental results. By determining the head of sperm, the detection of large vacuole and head size of sperms is more straightforward.

The vacuole is the dark part of the sperm head, which is associated with chromatin defects, DNA fragmentation, and aneuploidy [20]. In other words, the presence of vacuole indicates low sperm quality, especially in the case of large vacuoles. The quality is worse, when the nucleus has a vacuole. However, the sperm head with large vacuoles results in weak reproduction outcomes [20]. To detect the presence of vacuoles, the algorithm's searches were used for gray regions based on two conditions: (1) the area should be smaller than the threshold, and (2) the area should be dark in color. To calculate the amount of threshold, the area of the head of the sperm is determined. The darkness of the vacuole is better when less than 70, as this value indicates vacuole darkness. This value was chosen based on empirical studies of the built dataset. One of the main features in the sperm selection phase is the size of its different parts. Compared to the normal size, if a sperm has larger or smaller head, the proposed algorithm detects the abnormality. To calculate the absolute length of each pixel in micrometers, the algorithm requires a calibration microscope camera. The camera gives this measure back. Fig. 7
                         shows these measures in two scales: ×400 and ×600. According to these measures, in the proposed dataset, one micrometer is equal to 7.7875 pixels.

The proposed algorithm was used to check for two criteria: First, the length of sperm head should be between 3 and 5μm and the width between 2 and 3μm. Second the ratio of the width of the sperm should be between three fifth and two third of its height. If both criteria are present, this sperm is suitable for injection. Based on the previous calculated measures, the length of skeleton in the head is the longitude of the sperm's head. Moreover, as mentioned earlier in this study, to determine the head of the sperm, the proposed algorithm needs to locate the center of the head. So, the width of the head is calculated.

The tail of a sperm cell must be in uniformity, uncoiled, and thinner than the midpiece. If the tail is coiled or has an abnormality, the length of the tail will change. The length of the tail must be 45μm. The proposed method calculates sperm length using the equivalent micrometer in pixels. This equivalent is shown in Fig. 7. If the sperm's tail is less than its normal size, then the sperm is not suitable for injection. Besides, if the sperm has double tails, SMA can also easily detect this problem after recognition of the skeleton. These types of sperms have two lines as their skeleton.

The size and shape of the midpiece can also be measured with the proposed algorithm. As a result, SMA can detect the problem of thick or thin midpiece. The bent neck is another problem that can be recognized using the proposed method of this study. The skeleton of sperm cells is the key element for determining bent necks. The angle of the skeleton on the conjunction of head border and neck should be between 150° and 210° (determined based on this study's empirical finding on the sperm images). This angle can be easily detected by comparing the slope of two lines of the corresponding angle. Asymmetrical neck is another problem that can be recognized by a similar solution.

Semen samples were incubated and liquefied at 37°C for 30min. The processed sperm was placed in 10% polyvinylpyrrolidone (PVP, vitrolife, Sweden) drop. During ICSI performance, images of spermatozoa were captured at ×400 and ×600 magnification using a microscope (IX70, Olympus, Japan) equipped with a CCD camera (DP71, Olympus, Japan) with chromatic infinity objective lenses and a resolution of 576×764 pixels in RGB color space. To assess their morphology, a total of 1457 sperm cells were captured and analyzed. These images have low resolution. Sperms of different morphologies were captured. The dataset, called human sperm morphology analysis dataset (HSMA-DS), consists of a variety of images from different patients. The dataset contains both normal and abnormal sperms with different deformities in the head, midpiece, and tail.

All the images in the dataset were annotated by expert embryologists. This annotation was done according to Menkveld et al. [9] criteria. The tags contain different features such as large vacuole, tail, midpiece, and head abnormality. The value of these features is binary (that is, can be zero or one). If there is a problem in a feature of the sperm, the value of that feature is changed to one. The zero value indicates that there is no problem with that feature. Fig. 8
                         shows some images from this study's dataset. As shown in this Fig., the dataset has normal and defective sperms. The captured images may have some regions that are not part of a sperm. Therefore, the SMA algorithm should remove this region in order to accurately assess the sperm. However, vacuoles are important features in sperm and as such, the algorithms should be able to determine their presence. A sample of these images is shown in Fig. 8. Another classification of images is based on patients. The images were obtained from 235 patients, and the identity of each patient is annotated for each image. By this classification, one can analyze and compare the different patients.

The dataset in this study includes 1457 images of which 358 images are about sperms with large vacuole and in 16 of the images, the tails of the sperms are defective. Also, the images show 502 sperms with malformation in the head. In general, in this study, the dataset contains 750 images of normal sperms and 707 images of inappropriate sperms for ICSI. In other words, inappropriate sperms are those sperms with problem(s) in the head, tail, and/or neck. Table 1
                         shows the statistics of HSMA-DS.

It should be noted that this study's dataset is freely available for academic purposes from the following website: http://nlp.guilan.ac.ir/dataset.aspx.

@&#RESULTS@&#

This section shows the performance of the proposed algorithm using a created dataset. First and foremost, this section describes the results of each step of algorithm and the accuracy of the proposed algorithm in sperm abnormality detection. The computation cost of the proposed algorithm shows that this method can be used in real time for sperm injection.

For evaluation of the SMA algorithm, four metrics were computed: true positive (TP), false positive (FP), true negative (TN), and false negative (FN). In these experiments, positive (P) indicates instances without problem, and negative (N) indicates problematic instances. As a result, the mentioned metrics can be regarded as:
                           
                              •
                              
                                 TP: number of positive instances (i.e., instances have been tagged as positive by expert embryologists) that are correctly identified as positive by our proposed algorithm.


                                 FP: number of negative instances (i.e., instances have been tagged as negative by expert embryologists) that are incorrectly identified as positive by our proposed algorithm.


                                 TN: number of negative instances that are correctly identified as negative by our proposed algorithm.


                                 FN: number of positive instances that are incorrectly identified as negative by our proposed algorithm.

In this study, different tags annotated each image of the dataset. These tags can be either positive or negative for head, midpiece, tail, and existence of large vacuole in each image. This study also used accuracy [21], which is a well-known and standard measure, in the evaluation of the proposed method. This measure can be computed by the following equation:
                           
                              
                                 
                                    Accuracy
                                    =
                                    
                                       
                                          TP
                                          +
                                          TN
                                       
                                       
                                          TP
                                          +
                                          FP
                                          +
                                          FN
                                          +
                                          TN
                                       
                                    
                                 
                              
                           
                        
                     

@&#IMPLEMENTATION DETAILS@&#

In order to evaluate the performance of the SMA algorithm, the results of each step of the algorithm were first determined. Moreover, the detail and evaluation of each part are also described.

As it is described in the dataset section, the images are not in high quality, due to low resolution microscope. There are too many noises in the image; as a result, sperm identification is a very hard task. The steps of noise reduction are shown in Fig. 9
                        . An input image of a sperm is shown in Fig. 9a. This RGB images are transferred to YCbCr space, and its Y component is visible in Fig. 9b. As it is obvious, this figure has high level of noises. Therefore, it is sharpened to convert noises to edges. The sharpened image is shown in Fig. 9c. In this figure, noises are explicitly visible. As it is explained, Gaussian filter is applied on the sharpened image to smooth the noises (i.e., reduce the noises). The output of applying Gaussian filter is shown in Fig. 9d. In this image, the amount of noises is decreased. However, this amount of noises is not acceptable for further processing.

The output of the Gaussian filter is suitable for applying the wavelet transform (that is, Coiflet_2 type). In this experiment, the filter level is 4, and was selected based on the sperm images of this study. When the experiments were carried out using a smaller number for filter level, it was observed that some noises remained in the images. For larger numbers, no sensible change was observed. Fig. 10a and b shows an input image sample and the output of wavelet transform, respectively.

As shown in Fig. 10, the noises of the image were removed in an acceptable way, and the resulted image was ready for application in sperm region detection.


                        Fig. 11
                         shows the final steps of noise removal algorithm. After removing noises of an image, sperm and/or debris are the only objects left in the image. Thus, the Sobel algorithm is then applied for edge detection. The result is shown in Fig. 11a. For removing inappropriate regions, median filter is applied, which fills the small holes and removes little regions. The output of median filter is shown in Fig. 11b. It is obvious from these images that the proposed algorithm can reasonably detect the sperm region. Basically, successful noise removal is the key factor for the acceptable results of the region detection phase.


                        Fig. 12
                         shows the head detection steps. For head detection, as explained earlier in the proposed algorithm, the boundary of the image is detected (Fig. 12b) and its skeleton can then be computed (Fig. 12c). By overlying boundary and skeleton images (Fig. 12d), it is easy to compute the distance of each boundary point from the skeleton (that is, nearest point on the skeleton). These distances in red lines can be seen in Fig. 12e. The point on the skeleton that has the maximum distance from the boundary is regarded as the center of the sperm's head. After finding the region of head, its analysis is straightforward. The size of skeleton in the head region is equal to the length of the head. The sperm's width is equal to twice the length of the shortest line from the center of the sperm head to a point in the head boundary (that is, green line in Fig. 12e).

The detected head region can be used in vacuole finding. In vacuole detection, an algorithm is needed to search for a small region with a value less than this study's determined threshold (that is, 70 is the threshold value in our experiments).

First and foremost, the output of SMA in malformation detection is computed for different parts of the sperm (that is, head, tail, and large vacuole existence). Table 2
                         shows the TP, TN, FP, and FN values of SMA for different parts of the sperm. From the results, it is obvious that the algorithm has high rates for TN and TP, which shows the strength of this study's method.

As shown in Table 2, the proposed algorithm can successfully be used for detection of a large vacuole and tail abnormality. Table 3
                         shows the accuracy result for different parts of SMA. The table also shows the overall accuracy of algorithm in discrimination between normal and abnormal sperms.


                        Table 3 shows that the SMA algorithm has an acceptable accuracy in determining normal sperm cells. Table 4
                         shows the results of speed measurement for different parts of SMA.

On the average, the overall process occurs in less than 9s, as shown in Table 4. This time is desirable, and can be regarded as real time. As shown, the noise reduction step involves some portion of the overall time. Therefore, if the input images are of high quality, the algorithm may skip this step, causing the algorithm to be faster.

@&#DISCUSSION@&#

One of the main characteristics of the proposed algorithm is the ability to work with low resolution images. In almost all other existing methods, algorithms work on stained and/or high resolution images. It is obvious that the method used in this study can work under difficult situation and cannot be compared to other existing methods. It should be noted that in vacuole detection, for some blurred images, vacuoles cannot be detected by the aforementioned threshold, and those sperms were regarded as normal. However, with little changes in the method of this study (that is, semi-automatic threshold setting), a 100% accuracy can easily be reached. It is worthy of note that the results of this study also show the TN rate for tail malformation detection to be 100%. However, there is a small FN rate in the output of this study's algorithm and this could be attributed to the high rate of noise in the images. In the noise removal step for some low resolution images, a section of tail can be removed. As a result, the length of the tail will be less than its real length, and the algorithm wrongly detects a defect in the sperm's tail (that is, FN). In some images, there are reflections of the microscope's light. These reflections introduce some artifacts, which make it difficult to determine the sperm's size, even by human experts. This results in an increase in human error rate. In spite of this problem, as the results indicate, the SMA algorithm is successful in overcoming this situation, and is capable of assisting human experts in sperm size measurement.

However, to the best of our knowledge, no research has been carried out regarding an efficient method of detecting automatic morphological abnormality from human sperm images. Most of the existing researches were on stained and/or high resolution images, which are totally different from the objective of this study. In this study, based on the earlier mentioned problem, an algorithm is needed to detect normal sperms in real time in order to use the detected sperms in the ICSI process. This is in contrast with other existing methods, which used stained sperms that are not useful in ICSI. To achieve this goal, the algorithm needs to satisfy two requirements: first, it should have an acceptable accuracy; and secondly, the algorithm should be fast enough. Tables 3 and 4 show that these two requirements have been satisfied by this study's proposed algorithm.

Fundamentally, detection of the sperm regions is an adaptive task that automatically determines image size and then, works on the image. It is obvious that with the fixed sperms’ size, the algorithm can work even faster. The main parts of the algorithm tend to determine and analyze the sperm's head, midpiece and tail. As it is shown, the required time for these two steps is surprisingly too short. As mentioned earlier in this study, the SMA algorithm works automatically. However, it is possible to change some parts of the algorithm and complement it with the assistance of experts (that is, the semi-automatic method). In the semi-automatic version, experts can select the sperm region, and the algorithm will then analyze the head and tail of the sperm.

Despite the fact that the assessment of sperm morphology for either normal spermatozoa or sperm defects is relatively extensive, the different stages in the analysis of human spermatozoon morphology have been presented. This study focused on the measurement of parameters such as the head, midpiece, and tail of sperm. It is possible to detect sperm abnormalities such as round heads, pin heads, abnormal size and shape of heads, double heads, absent tails, double tails, and bent or coiled tails.

Alegre et al. [22] classified the boar sperm acrosome automatically using digital image processing and learning vector quantization (LVQ). In their study, the images of sperm heads were obtained with a phase-contrast microscope and the acrosome status was evaluated according to its stained color. The overall test error obtained from classifying sperm heads was 6.8%. In another study, the principal component analysis (PCA) and K-nearest neighbor (KNN) were used to extract image features and to diagnose normal sperm, respectively. This study obtained a good performance, of approximately 87.53%. While this study was performed using a small dataset. In other word, there is a dearth of information regarding sperm morphology and image magnification [23]. Chang et al. proposed a gold-standard and improved framework to detect and segment the acrosome and nucleus of the human sperm head. Segmentation of the head was performed using clustering and histogram statistical analysis techniques. They also introduced a combination of different color spaces and thus an improvement of above 98% was achieved in the detection of the sperm head. Automated sperm head detection and analysis was performed using stained sperm images [24]. Abbiramy and Shanthi [4] studied the normal and abnormal morphology of spermatozoa during a 4 stage process. I: Image preprocessing; RGB image was converted to a gray-scale image and noises were removed using a median filter. II: Detection and extraction of individual sperm; Sobel edge detection algorithm was used. III: The spermatozoa segmentation; each sperm was segmented into head, midpiece, and tail and IV: The statistical measurement of sperm; spermatozoa was classified as normal or abnormal. Vicente-Fie et al. [25] compared the sperm nuclear morphometric subpopulations for species of cattle, sheep, goat and pigs. The sperms were processed using the ImageJ [26] with open-access software analysis and to identify sperm subpopulations, clustering procedures were performed. As a result, a combination of computer-assisted sperm morphology analysis-fluorescence (CASMA-F) technology and multivariate cluster analyses was utilized. Ramos et al. (2004) evaluated the ICSI-selected epididymal sperms in combination with the DNA-specific stain (Feulgen) and computerized karyometric image analysis (CKIA) system using a high magnification (×1000) [27]. Yaniz et al. [28] performed an automatic assessment of ram sperm morphology. Moreover, stained images from fluorescence microscopy were used to study the sperm morphometry, and analysis of sperm heads was performed using the ImageJ program [28].

Since the size and shape of the acrosome is particularly important for sperm binding to the oocyte, this study could be extended in order to measure the level of acrosome in the sperm head. One of the main characteristics of the proposed algorithm is the ability to work with low resolution, noisy, and non-stained images, which is one of the first successful algorithms in sperm morphology analysis on these types of images. In this study, a dataset of sperm images with different types of sperms was produced and is freely available for academic purposes. The experimental results on the 1457 images of the produced dataset show results of high accuracy.

All authors declare that they have no conflict of interests.

FG conceived of the study, participated in its design and coordination, carried out the data analysis and interpretation, and drafted the manuscript. SMA and SAM carried out data analyses, SMA algorithm design, and critically revised the manuscript. MA and ZZ assisted with the study design, carried out data analysis and helped to draft the manuscript. All authors read and approved the final manuscript.

@&#ACKNOWLEDGEMENT@&#

The authors of this study acknowledge the cooperation of the Guilan University of Medical Sciences (Rasht, Iran).

@&#REFERENCES@&#

