@&#MAIN-TITLE@&#Efficient source enumeration for accurate direction-of-arrival estimation in threshold region

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In the threshold region, nonlinear signal parameter estimates carry large mean square estimation error.


                        
                        
                           
                           For unequal-power and/or closely-spaced sources, the estimation errors for individual sources differ greatly.


                        
                        
                           
                           We propose the theoretical concept of effective source number which is useful for understanding what makes a good order selection rule in the threshold region.


                        
                        
                           
                           We also define the matched source number (MSN) for a parameter estimator in an effort to automatically remove inaccurate estimates while keeping as many accurate estimates as possible.


                        
                        
                           
                           We devise a signal number detection algorithm that attains the MSN.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Source enumeration

Direction-of-arrival (DOA) estimation

ESPRIT

Threshold region

Joint detection and estimation

@&#ABSTRACT@&#


               
               
                  Estimation of the number of signals impinging on an array of sensors, also known as source enumeration, is usually required prior to direction-of-arrival (DOA) estimation. In challenging scenarios such as the presence of closely-spaced sources and/or high level of noise, using the true source number for nonlinear parameter estimation leads to the threshold effect which is characterized by an abnormally large mean square error (MSE). In cases that sources have distinct powers and/or are closely spaced, the error distribution among parameter estimates of different sources is unbalanced. In other words, some estimates have small errors while others may be quite inaccurate with large errors. In practice, we will be only interested in the former and have no concern on the latter. To formulate this idea, the concept of effective source number (ESN) is proposed in the context of joint source enumeration and DOA estimation. The ESN refers to the actual number of sources that are visible at a given noise level by a parameter estimator. Given the numbers of sensors and snapshots, number of sources, source parameters and noise level, a Monte Carlo method is designed to determine the ESN, which is the maximum number of available accurate estimates. The ESN has a theoretical value in that it is useful for judging what makes a good source enumerator in the threshold region and can be employed as a performance benchmark of various source enumerators. Since the number of sources is often unknown, its estimate by a source enumerator is used for DOA estimation. In an effort to automatically remove inaccurate estimates while keeping as many accurate estimates as possible, we define the matched source number (MSN) as the one which in conjunction with a parameter estimator results in the smallest MSE of the parameter estimates. We also heuristically devise a detection scheme that attains the MSN for ESPRIT based on the combination of state-of-the-art source enumerators.
               
            

@&#INTRODUCTION@&#

Direction-of-arrival (DOA) estimation of signals impinging on an array of sensors is a fundamental problem in array processing [1], ranging from radar, sonar to wireless communications and medical imaging. Estimating the number of source signals from noisy measurements, also called source enumeration, is a required task prior to applying DOA estimation methods such as maximum-likelihood estimator (MLE), estimation of signal parameters via rotational invariance techniques (ESPRIT) [2], multiple signal classification (MUSIC) [3] and principal-singular-vector utilization for modal analysis (PUMA) [4].

The conventional performance metric for source enumeration is the probability of correct detection (PoD) [5–8]. The underlying premise of using PoD as the performance measure is that the true signal number is always the optimal choice. However, in challenging scenarios where closely-spaced sources are present and/or the signal-to-noise ratio (SNR) is low, using the true signal number for subsequent estimation incurs abnormally large mean square error (MSE) of the estimated parameters.


                     Fig. 1
                      illustrates the typical composite MSE performance curve for nonlinear parameter estimation [9]. In the asymptotic region of high SNRs, the estimates are located in the neighborhood of the true parameters and the resultant estimation errors are small. Below a specific SNR called the threshold point, the MSE of the nonlinear parameter estimates departs from the Cramér–Rao bound (CRB) and rises rapidly. As the SNR decreases, the MSE rises until it reaches a stable maximum value. The SNR at which the MSE enters this steady state of futility is called the no information point.

In the threshold region corresponding to closely-spaced sources and/or distinct signal powers, the estimation errors among sources are unevenly distributed: some estimates are centered about the true parameters and carry small or local errors [10], whereas other estimates carry random or global errors [10]. The latter estimates, also known as outliers [11,10], cause the threshold effect.

In practice, we are only interested in the parameter estimates with small errors but have no concern on the outliers. To formulate this idea, we propose the adaptive source number in an effort to remove unwanted outliers while keeping the accurate estimates. In particular, we have developed the concepts of effective source number (ESN) and matched source number (MSN) by considering the source enumeration and subsequent DOA estimation as a whole. The ESN refers to the actual number of sources that are visible at a given noise level by a certain parameter estimator. It is an indicator of how many parameter estimates returned by a parameter estimation scheme are accurate. The ESN is a theoretical concept that depends on the numbers of sensors and snapshots, number of sources, signal parameters and noise level, and can be determined by Monte Carlo simulation. It can be employed as a performance benchmark of various source enumerators and is useful for understanding what makes a good source enumerator in the threshold region. In practice the number of sources is often unknown, and instead its estimate by a source enumerator is used for DOA estimation. A good choice of a source number for a specific parameter estimation scheme varies and is application dependent. In this work, we focus on the scenario where false alarm entails much higher price than missed detection and hence under-enumeration is preferred, and formulate a close-to-generic definition of MSN whose combination with ESPRIT automatically removes unwanted outliers while keeping as many accurate estimates as possible. Moreover, we propose a detection scheme that attains the MSN in the threshold region based on the combination of state-of-the-art source enumerators [5,12–14,6,8].

It is worth noting that similar attempts have also been made in the literature. In [15], a detection method biased toward over-enumeration is designed to cater to radar imagery applications, where it is preferable to overestimate the number of harmonic components than underestimation. However, joint source enumeration and DOA estimation is not considered, and the extent of over-enumeration is not analyzed. More importantly, in our point of view underestimation should be preferred in a wide range of applications for challenging scenarios such as low SNR and/or presence of closely-spaced sources, since using an overestimated source number yields useless inaccurate parameter estimates which entail additional costs. In [16], a similar joint source enumeration and parameter estimation solution has been exploited based on the combination of the minimum description length (MDL) [5] criterion and ESPRIT for multipath time delay acquisition. Nevertheless, the scheme is based on a very specific cost function of the parameter estimates, and the combination of MDL and ESPRIT is not sufficiently justified.

The underlying principles of ESN and MSN proposed in our work are also related to multi-model approach [17–21]. Different from the traditional single-model approach to model selection, where only one model is considered as correct and selected whereas all other models are ignored, in the multi-model approach, all fitted models are combined in a weighted manner according to their posterior likelihoods. This leads to the idea of model averaging that can be used for modeling and prediction. That is to say, our proposed model can be considered as a special case of multi-model approach. Our proposal shares similar idea to multi-model approach in the sense that alternative models (namely, underestimated number of sources) are considered in addition to the exact model (true number of sources).

The reminder of this paper is organized as follows. In Section 2, the data model for DOA estimation is formulated. In Section 3, we propose the concept of the ESN as well as a procedure to identify it using Monte Carlo simulation. In Section 4, we define the MSN, and design a detection scheme that can automatically attain the MSN. Simulation results are provided in Section 5 to evaluate the validity of the proposed concepts and detection scheme. Finally, conclusions are drawn in Section 6.

Consider a scenario where d far-field narrowband sources are impinging on a uniform linear array (ULA) of M sensors. For simplicity, we assume that the array and emitters are coplanar so that the DOA is characterized by the azimuth angle only.

The complex baseband output of the receive antennas is expressed as
                        
                           (1)
                           
                              X
                              =
                              A
                              (
                              θ
                              )
                              S
                              +
                              Z
                              ,
                           
                        
                      where 
                        A
                        (
                        θ
                        )
                        =
                        [
                        a
                        (
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        )
                        ,
                        …
                        ,
                        a
                        (
                        
                           
                              θ
                           
                           
                              d
                           
                        
                        )
                        ]
                        ∈
                        
                           
                              C
                           
                           
                              M
                              ×
                              d
                           
                        
                      is the array steering matrix, and 
                        a
                        (
                        
                           
                              θ
                           
                           
                              i
                           
                        
                        )
                        =
                        
                           
                              [
                              1
                              ,
                              
                                 
                                    e
                                 
                                 
                                    j
                                    2
                                    π
                                    r
                                    sin
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    λ
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    j
                                    (
                                    M
                                    −
                                    1
                                    )
                                    2
                                    π
                                    r
                                    sin
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    λ
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                     , is the array steering vector that models the array response to a unit waveform from a certain direction. Here, 
                        
                           
                              θ
                           
                           
                              i
                           
                        
                        ∈
                        [
                        −
                        π
                        /
                        2
                        ,
                        π
                        /
                        2
                        ]
                      is the DOA of the i-th source, measured relative to the array normal direction, r is the inter-element spacing of the receiving antenna array, and λ denotes the carrier wavelength. The 
                        
                           
                              μ
                           
                           
                              i
                           
                        
                        =
                        2
                        π
                        r
                        sin
                        (
                        
                           
                              θ
                           
                           
                              i
                           
                        
                        )
                        /
                        λ
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                     , is referred to as the spatial frequency. We assume that 
                        A
                        (
                        θ
                        )
                      has full column rank of d and 
                        d
                        <
                        min
                        (
                        M
                        ,
                        N
                        )
                     . Furthermore, 
                        S
                        =
                        
                           
                              [
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    s
                                 
                                 
                                    d
                                 
                                 
                                    T
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              d
                              ×
                              N
                           
                        
                      contains the samples of all sources, and N is the number of snapshots. The 
                        Z
                        ∈
                        
                           
                              C
                           
                           
                              M
                              ×
                              N
                           
                        
                      is the noise matrix collecting uncorrelated ZMCSCG samples with variance of 
                        
                           
                              σ
                           
                           
                              z
                           
                           
                              2
                           
                        
                     . The noise is assumed to be uncorrelated with the signal.

Without loss of generality, in the sequel we use the following assumption: 1) 
                        r
                        =
                        λ
                        /
                        2
                      and hence 
                        
                           
                              μ
                           
                           
                              i
                           
                        
                        =
                        π
                        sin
                        (
                        
                           
                              θ
                           
                           
                              i
                           
                        
                        )
                        ∈
                        [
                        −
                        π
                        ,
                        π
                        ]
                     ; 2) The samples of the i-th source 
                        
                           
                              s
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                     , are generated from zero-mean circularly symmetric complex Gaussian (ZMCSCG) random process with variance of 
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           
                           
                              2
                           
                        
                      and the samples of different sources are uncorrelated with each other; 3) The noise has unit variance, namely, 
                        
                           
                              σ
                           
                           
                              z
                           
                           
                              2
                           
                        
                        =
                        1
                     .

Since the ESPRIT is a closed-form parameter estimator that is accurate and computationally efficient, it is used for frequency estimation throughout the paper.

The ESPRIT algorithm uses the signal subspace to estimate the spatial frequencies. The first step is to compute the eigenvalue decomposition of the sample covariance matrix
                           
                              (2)
                              
                                 
                                    
                                       
                                          R
                                          ˆ
                                       
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    1
                                    N
                                 
                                 X
                                 
                                    
                                       X
                                    
                                    
                                       H
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       M
                                       ×
                                       M
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                              
                                 H
                              
                           
                         represents the Hermitian transpose. The 
                           
                              d
                              ˆ
                           
                         eigenvectors associated to the 
                           
                              d
                              ˆ
                           
                         largest eigenvalues, where 
                           
                              d
                              ˆ
                           
                         denotes the estimated source number, are assumed to form the signal subspace 
                           
                              
                                 U
                              
                              
                                 
                                    d
                                    ˆ
                                 
                              
                           
                        .

The shift invariance equation then takes the following form:
                           
                              (3)
                              
                                 
                                    
                                       J
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       J
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 Φ
                              
                              
                                 
                                    d
                                    ˆ
                                 
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    d
                                    ˆ
                                 
                                 ×
                                 
                                    d
                                    ˆ
                                 
                              
                           
                         is the unknown matrix to be solved. The above sets of equations are overdetermined and can be solved by the least squares method.

From 
                           
                              
                                 Φ
                              
                              
                                 
                                    d
                                    ˆ
                                 
                              
                           
                        , the spatial frequencies are estimated as
                           
                              (4)
                              
                                 
                                    
                                       
                                          μ
                                          ˆ
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 arg
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    d
                                    ˆ
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                         denotes the i-th eigenvalue of 
                           
                              
                                 Φ
                              
                              
                                 
                                    d
                                    ˆ
                                 
                              
                           
                        .

Suppose that the true number of signals d is passed to ESPRIT, and denote the resultant d frequency estimates as 
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              d
                           
                        
                     , where 
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                     , is the estimate of the spatial frequency of the i-th source, namely, 
                        
                           
                              μ
                           
                           
                              i
                           
                        
                     .

To illustrate the concept of ESN, we consider a scenario with 
                        d
                        =
                        2
                      equal-power and closely-spaced sources. Other parameter settings are 
                        M
                        =
                        10
                     , 
                        N
                        =
                        20
                     , 
                        d
                        =
                        
                           d
                           ˆ
                        
                        =
                        2
                     , and 
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                           
                           
                              2
                           
                        
                        =
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                           
                           
                              2
                           
                        
                        =
                        0.1
                     . 1000 Monte Carlo (MC) trials are conducted. In Fig. 2
                     , the histogram of the joint frequency estimate pair 
                        (
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              2
                           
                        
                        )
                      is shown. Note that in almost all trials only one estimate is accurate while the other one has random errors. This indicates that only one source is visible by ESPRIT. This is due to the fact that the frequency resolution of ESPRIT is limited. For two closely-spaced sources corrupted by higher levels of noise, their small angular separation becomes invisible and they merge to one.

Loosely speaking, the ESN, denoted here as 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                     , refers to the number of signals that are actually visible at a given noise level by a certain parameter estimation scheme. Formally, it is defined as the number of accurate elements within the vector of parameters estimated when the true source number d is used for parameter estimation. The ESN is a function of the numbers of sensors M and snapshots N, number of sources d, the powers and DOAs of d sources, and noise level. It is evident that in the asymptotic region 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                        =
                        d
                      while in the no information region 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                        =
                        0
                     . In the threshold region, 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      falls between 0 and d. In the next section, we propose an algorithm to determine the ESN in the threshold region.

The theoretical value of ESN lies in that it is an indicator of the maximum number of available accurate parameter estimates, which helps us judge whether a source enumerator is good or not in the threshold region. As a future research direction, we plan to derive the analytical expression of the ESN and to design a source enumerator that can return a source number estimate fitting well with the ESN. This has practical significance in that with the knowledge of ESN, we may be able to decide which parameter estimates are accurate.

The proposed algorithm relies on the empirical observation that the global errors can be approximated by random interval errors that are uniformly distributed over a certain range of values [9].

For two closely-spaced sources with equal power, however, in the threshold region the random error which is the characteristic of an outlier is contained in the parameter estimates of both sources. Fig. 3
                         shows the individual histograms of the frequency estimates 
                           
                              
                                 
                                    μ
                                    ˆ
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                    ˆ
                                 
                              
                              
                                 2
                              
                           
                        , where the parameter settings are the same as those in Fig. 2. We see that although an outlier has been recognized from Fig. 2, Fig. 3 indicates that neither estimate has an approximate uniform distribution in 
                           [
                           −
                           π
                           ,
                           π
                           ]
                        .

To tackle this, in each MC trial we order the 
                           d
                           =
                           2
                         frequency estimates in terms of accuracy such that
                           
                              (5)
                              
                                 |
                                 
                                    
                                       
                                          μ
                                          ˆ
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 |
                                 ⩽
                                 |
                                 
                                    
                                       
                                          μ
                                          ˆ
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 |
                                 ,
                              
                           
                         where 
                           {
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 i
                              
                              
                                 2
                              
                           
                           }
                         is a permutation of 
                           {
                           1
                           ,
                           2
                           }
                        . Hereafter 
                           
                              
                                 
                                    μ
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                    ˆ
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         are referred to as accurate and inaccurate estimates.

The histograms of the accurate and inaccurate estimates are plotted, respectively, at the top and bottom of Fig. 4
                        . Note that the inaccurate estimate is now approximately uniformly distributed and hence the outlier can be readily discovered.

As the SNR continues to decrease, the number of outliers is expected to increase from 1 to 2. Indeed, for an SNR of 
                           −
                           30
                            
                           dB
                        , the union of the two estimates approximately obeys the uniform distribution, as shown at the bottom of Fig. 5
                        . Note that neither of the accurate and inaccurate estimates alone follows the uniform distribution since they are ordered estimates and do not correspond to the sources. Instead, the accurate estimate is subject to a super-uniform distribution which exhibits a convex profile, while the inaccurate one is subject to a sub-uniform distribution with a concave profile.

It is worth mentioning that similar results are also obtained for multiple-source scenarios and for widely-spaced sources with imbalanced powers. In general, when 
                           
                              
                                 d
                              
                              
                                 ol
                              
                           
                         outliers are present, the union of the 
                           
                              
                                 d
                              
                              
                                 ol
                              
                           
                         least accurate estimates approximately follows the uniform distribution. Based on this observation, we propose an algorithm to identify the ESN by the MC method.

Given the numbers of sensors M and snapshots N, number of sources d, source powers and spatial frequencies 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 μ
                              
                              
                                 d
                              
                           
                        , and noise level, the algorithm for identifying the ESN proceeds in the following steps.
                           
                              1)
                              MC simulation. Obtain Q random realizations of the signal-plus-noise measurement 
                                    X
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          M
                                          ×
                                          N
                                       
                                    
                                  according to (1) by varying the source samples and noise. For the q-th realization, 
                                    q
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    Q
                                 .
                                    
                                       a)
                                       Pass d to ESPRIT to obtain the frequency estimates of d sources, denoted as 
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   d
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                          .

Order the d frequency estimates in terms of accuracy as 
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                           such that
                                             
                                                (6)
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               μ
                                                               ˆ
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   ⩽
                                                   ⋯
                                                   ⩽
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               μ
                                                               ˆ
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   ,
                                                
                                             
                                           where 
                                             {
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   i
                                                
                                                
                                                   d
                                                
                                             
                                             }
                                           is a permutation of 
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             d
                                             }
                                          .

To reduce the statistical error, the number of MC trials Q should be sufficiently large, typically of the order of 1000.

Define the k-th 
                                    (
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                    )
                                  set of estimates as
                                    
                                       (7)
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             ⋃
                                             
                                                q
                                                =
                                                1
                                             
                                             Q
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   
                                                      μ
                                                      ˆ
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              

Test the goodness of fit of each set of estimates for uniform distribution using the chi-squared test. First, divide 
                                    [
                                    −
                                    π
                                    ,
                                    π
                                    ]
                                  into l equally-spaced intervals, and then calculate the chi-squared statistic [22,23]:
                                    
                                       (8)
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             l
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   Q
                                                   /
                                                   l
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                Q
                                                /
                                                l
                                             
                                          
                                          =
                                          
                                             l
                                             Q
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             l
                                          
                                          
                                             
                                                f
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          Q
                                          ,
                                       
                                    
                                  where 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                  is the observed number of estimates that falls within the i-th interval. To maximize the power of the test, l is set as [22]
                                 
                                    
                                       (9)
                                       
                                          l
                                          =
                                          4
                                          
                                             
                                                
                                                   2
                                                   
                                                      
                                                         (
                                                         Q
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             5
                                          
                                          ,
                                       
                                    
                                  where γ is determined from
                                    
                                       (10)
                                       
                                          
                                             ∫
                                             γ
                                             ∞
                                          
                                          
                                             1
                                             
                                                
                                                   2
                                                   π
                                                
                                             
                                          
                                          exp
                                          
                                             {
                                             −
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                2
                                             
                                             }
                                          
                                          
                                          d
                                          y
                                          =
                                          α
                                          ,
                                       
                                    
                                  with α being the level of significance whose typical values is 
                                    1
                                    %
                                 , 
                                    5
                                    %
                                  or 
                                    10
                                    %
                                 .

The set of estimates with the smallest 
                                    
                                       
                                          χ
                                       
                                       
                                          2
                                       
                                    
                                  is closest to being uniformly distributed.

Supposing 
                                    
                                       
                                          Ω
                                       
                                       
                                          j
                                       
                                    
                                  has the best fit for uniform distribution, the number of outliers is 
                                    
                                       
                                          d
                                       
                                       
                                          ol
                                       
                                    
                                    =
                                    [
                                    d
                                    −
                                    (
                                    j
                                    −
                                    1
                                    )
                                    ]
                                 , and the ESN is 
                                    
                                       
                                          d
                                       
                                       
                                          eff
                                       
                                    
                                    =
                                    (
                                    j
                                    −
                                    1
                                    )
                                 .

Finally, we illustrate how to identify the threshold SNR and no information SNR, which is required in determination of the ESN and MSN. According to [24], the theoretical MSE expression of the ESPRIT in the asymptotic region is derived as
                           
                              (11)
                              
                                 
                                    
                                       MSE
                                    
                                    
                                       theo
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                                
                                                   H
                                                
                                             
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   ↑
                                                   †
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   M
                                                
                                                
                                                   ↑
                                                
                                             
                                             −
                                             
                                                
                                                   A
                                                
                                                
                                                   ↓
                                                   †
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   M
                                                
                                                
                                                   ↓
                                                
                                             
                                             )
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             S
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       i
                                       ,
                                       i
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       N
                                       K
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         is a 
                           d
                           ×
                           1
                         vector with 1 in the i-th position and 0 otherwise, 
                           
                              
                                 I
                              
                              
                                 M
                              
                           
                         is the 
                           M
                           ×
                           M
                         identity matrix, 
                           
                              
                                 R
                              
                              
                                 S
                              
                           
                         is the signal covariance matrix, 
                           
                              
                              
                                 †
                              
                           
                         stands for the Moore–Penrose pseudo-inverse, 
                           
                              
                                 [
                                 ⋅
                                 ]
                              
                              
                                 ↑
                              
                           
                         denotes a matrix with the first row deleted, and 
                           
                              
                                 [
                                 ⋅
                                 ]
                              
                              
                                 ↓
                              
                           
                         denotes a matrix with the last row deleted. Hence, the threshold SNR is identified as
                           
                              (12)
                              
                                 
                                    
                                       SNR
                                    
                                    
                                       th
                                    
                                 
                                 =
                                 min
                                 SNR
                                 
                                 st.
                                 
                                 
                                    
                                       
                                          
                                             MSE
                                          
                                          
                                             empi
                                          
                                       
                                       (
                                       SNR
                                       )
                                    
                                 
                                 >
                                 
                                    
                                       
                                          
                                             MSE
                                          
                                          
                                             theo
                                          
                                       
                                       (
                                       SNR
                                       )
                                    
                                 
                                 +
                                 η
                                 ,
                              
                           
                         where the SNR is defined as
                           
                              (13)
                              
                                 SNR
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       d
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                         
                        
                           
                              
                                 MSE
                              
                              
                                 empi
                              
                           
                           (
                           SNR
                           )
                         denotes the empirical MSE obtained by MC simulation, and η denotes the preset deviation-tolerance for the estimation error.

To identify the no information SNR, consider that the MSE of ESPRIT in the no information region can be well approximated by the one in noise-only case, denoted here as 
                           
                              
                                 MSE
                              
                              
                                 noise
                              
                           
                        . Consequently, the no information SNR is identified as
                           
                              (14)
                              
                                 
                                    
                                       SNR
                                    
                                    
                                       ni
                                    
                                 
                                 =
                                 max
                                 SNR
                                 
                                 st.
                                 
                                 
                                    
                                       MSE
                                    
                                    
                                       empi
                                    
                                 
                                 (
                                 SNR
                                 )
                                 <
                                 (
                                 1
                                 −
                                 ρ
                                 )
                                 
                                    
                                       MSE
                                    
                                    
                                       noise
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 MSE
                              
                              
                                 noise
                              
                           
                         denotes the empirical MSE obtained from noise-only measurements, and ρ is a preset relative error.

In practice the number of signals d is unknown and is estimated by a source enumerator. The source number estimate is then used for DOA estimation. From Section 3, we know that in the threshold region, when d is passed to a given parameter estimator, we obtain a maximum of 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      accurate estimates, and simultaneously 
                        (
                        d
                        −
                        
                           
                              d
                           
                           
                              eff
                           
                        
                        )
                      outliers. Empirically, using an overestimated number of signals results in the same number of accurate estimates but more than 
                        (
                        d
                        −
                        
                           
                              d
                           
                           
                              eff
                           
                        
                        )
                      outliers. For applications where missed detection incurs much more cost than false alarm, using the correct or overestimated source number is appropriate.

However, in applications where false alarm entails substantial loss and missed detection is not cared, the under-enumeration is a better choice. Empirically we observe that using an underestimated number of signals may automatically remove unwanted outliers while keeping a number of accurate estimates. In Fig. 6
                     , the parameter settings are the same as those in Fig. 2, except that an underestimated source number, namely, 
                        
                           d
                           ˆ
                        
                        =
                        1
                     , is used for DOA estimation instead of the true one. The histogram of the resultant frequency estimates is plotted in Fig. 6. Note that the outlier is automatically removed while an accurate estimate is obtained.

In an effort to automatically remove inaccurate estimates while keeping as many accurate estimates as possible, we define the MSN as the source number that results in the smallest MSE when being passed to a parameter estimator, namely,
                        
                           (15)
                           
                              
                                 
                                    d
                                 
                                 
                                    mat
                                 
                              
                              =
                              
                                 
                                    arg
                                    min
                                 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                 
                              
                              MSE
                              (
                              k
                              )
                              ,
                           
                        
                      with
                        
                           (16)
                           
                              MSE
                              (
                              k
                              )
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   μ
                                                   ˆ
                                                
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                                 k
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              k
                           
                        
                      are the frequency estimates obtained by passing k to a parameter estimator, and 
                        (
                        
                           
                              
                                 μ
                                 ˆ
                              
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              μ
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           
                        
                        )
                     , 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        k
                     , is the j-th estimated-true frequency pair with 
                        {
                        
                           
                              i
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              i
                           
                           
                              k
                           
                        
                        }
                      being a combination of k elements out of 
                        {
                        1
                        ,
                        …
                        ,
                        d
                        }
                     .

As shown in Section 5, the MSN is equal to or comparable to ESN, and by inputting 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      in ESPRIT the output 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      estimates has a comparable accuracy to the 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      estimates returned from inputting d in ESPRIT.

Since the ESPRIT is a subspace-based parameter estimation algorithm, subspace-based source enumerators such as ESTimation ERror (ESTER) [13,14], subspace-based automatic model order selection (SAMOS) [25], and order estimation using principal angles between subspaces (OE-PABS) [26] are considered as the matching detection methods for it. In this study, the ESTER is investigated due to the fact that it directly exploits the shift invariance property of the signal subspace similarly to ESPRIT.

Let 
                           
                              
                                 U
                              
                              
                                 k
                              
                           
                         collect the k dominant left singular vectors associated to the largest k singular values, where k is a candidate value for the estimated number of sources, and define the residual matrix as
                           
                              (17)
                              
                                 
                                    
                                       E
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       k
                                    
                                    
                                       ↓
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       U
                                    
                                    
                                       k
                                    
                                    
                                       ↑
                                    
                                 
                                 ,
                              
                           
                         where
                           
                              (18)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             U
                                          
                                          
                                             k
                                          
                                          
                                             ↓
                                          
                                       
                                       )
                                    
                                    
                                       †
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       k
                                    
                                    
                                       ↑
                                    
                                 
                                 .
                              
                           
                        
                     

The ESTER estimate of the number of signals is given by
                           
                              (19)
                              
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       ESTER
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       k
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       min
                                       (
                                       M
                                       −
                                       2
                                       ,
                                       N
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             E
                                          
                                          
                                             k
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                              
                                 2
                              
                           
                         denotes the spectral norm or 2-norm of a matrix.

Note that the cost function in the ESTER criterion, namely, 
                           
                              
                                 ‖
                                 
                                    
                                       E
                                    
                                    
                                       k
                                    
                                 
                                 ‖
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                        , serves as an approximate upper bound of the MSE defined in (16). To see this, according to Corollary 3 of [13], we have
                           
                              (20)
                              
                                 |
                                 
                                    
                                       
                                          ϕ
                                          ˆ
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 |
                                 ⩽
                                 c
                                 
                                    
                                       ‖
                                       
                                          
                                             E
                                          
                                          
                                             k
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 k
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    ϕ
                                    ˆ
                                 
                              
                              
                                 j
                              
                           
                         is the j-th eigenvalue of 
                           
                              
                                 Φ
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         is the eigenvalue of 
                           
                              
                                 Φ
                              
                              
                                 d
                              
                           
                         that is closest to 
                           
                              
                                 
                                    ϕ
                                    ˆ
                                 
                              
                              
                                 j
                              
                           
                         in least squares sense, and c is a constant that is independent of k.

Since
                           
                              (21)
                              
                                 |
                                 
                                    
                                       
                                          μ
                                          ˆ
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 |
                                 ≃
                                 
                                    
                                       |
                                       
                                          
                                             
                                                ϕ
                                                ˆ
                                             
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                                 ⩽
                                 c
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                E
                                             
                                             
                                                k
                                             
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    
                                       |
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                                 ,
                              
                           
                         and 
                           |
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           |
                           =
                           1
                        , it follows that for any 
                           1
                           ⩽
                           k
                           <
                           d
                        
                        
                           
                              (22)
                              
                                 MSE
                                 (
                                 k
                                 )
                                 ≲
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             E
                                          
                                          
                                             k
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where ≲ denotes “less than or approximately equal to”. Therefore, minimization of the ESTER cost function leads to minimization of 
                           MSE
                           (
                           k
                           )
                         in (16) and hence help us find 
                           
                              
                                 d
                              
                              
                                 mat
                              
                           
                        .

The ESTER is robust against finite-sample constraint in the sense that it works well even when the number of snapshots is relatively small compared to the number of sensors. However, it is sensitive to the angular separation of sources and in the presence of closely-spaced sources, has a tendency to underestimate the number of signals. To deal with scenarios with closely-spaced sources, we adopt its modified version:
                           
                              (23)
                              
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       mat
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       k
                                       =
                                       max
                                       (
                                       1
                                       ,
                                       
                                          
                                             
                                                d
                                                ˆ
                                             
                                          
                                          
                                             min
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       min
                                       (
                                       M
                                       −
                                       2
                                       ,
                                       N
                                       ,
                                       
                                          
                                             
                                                d
                                                ˆ
                                             
                                          
                                          
                                             max
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             E
                                          
                                          
                                             k
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    d
                                    ˆ
                                 
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 
                                    d
                                    ˆ
                                 
                              
                              
                                 max
                              
                           
                         are the lower and upper bounds of the candidate number of signals, respectively.

For large-sample scenarios where the number of snapshots N is much larger than the number of sensors M, we propose to establish the lower and upper bounds via the information criteria (ITCs) based detection methods, which are derived based on the maximum likelihood principle and are optimal large-sample detectors. In ITCs, the number of signals is determined by minimizing the following function [5,27]:
                           
                              (24)
                              
                                 ITC
                                 (
                                 k
                                 )
                                 =
                                 N
                                 (
                                 M
                                 −
                                 k
                                 )
                                 log
                                 
                                    (
                                    
                                       
                                          a
                                          (
                                          k
                                          )
                                       
                                       
                                          g
                                          (
                                          k
                                          )
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 k
                                 (
                                 2
                                 M
                                 −
                                 k
                                 )
                                 C
                                 (
                                 N
                                 )
                                 ,
                              
                           
                         where
                           
                              (25)
                              
                                 g
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          ∏
                                          
                                             i
                                             =
                                             k
                                             +
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          1
                                          
                                             M
                                             −
                                             k
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (26)
                              
                                 a
                                 (
                                 k
                                 )
                                 =
                                 
                                    1
                                    
                                       M
                                       −
                                       k
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       k
                                       +
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         are the geometric and arithmetic means of the 
                           (
                           M
                           −
                           k
                           )
                         smallest sample eigenvalues, respectively, and 
                           C
                           (
                           N
                           )
                         is the penalty coefficient which may be a function of N.

The Akaike information criterion (AIC), MDL [5] and efficient detection criterion (EDC) [27] as members of the family of ITCs, have different penalty coefficients for penalizing overfitting of the model:
                           
                              (27)
                              
                                 AIC
                                 :
                                 
                                 C
                                 (
                                 N
                                 )
                                 =
                                 2
                                 ,
                              
                           
                        
                        
                           
                              (28)
                              
                                 MDL
                                 :
                                 
                                 C
                                 (
                                 N
                                 )
                                 =
                                 log
                                 (
                                 N
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (29)
                              
                                 EDC
                                 :
                                 
                                 C
                                 (
                                 N
                                 )
                                 =
                                 
                                    
                                       N
                                       ⋅
                                       log
                                       
                                          (
                                          log
                                          (
                                          N
                                          )
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         We see that in AIC the lightest penalty is imposed, whereas in EDC the heaviest penalty is imposed. Consequently, the AIC is more inclined to overestimate the number of signals, whereas the EDC is apt to underestimation.

Therefore, we propose to adopt the following estimates as the lower bound 
                           
                              
                                 
                                    d
                                    ˆ
                                 
                              
                              
                                 min
                              
                           
                         and upper bound 
                           
                              
                                 
                                    d
                                    ˆ
                                 
                              
                              
                                 max
                              
                           
                        :
                           
                              (30)
                              
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       min
                                    
                                 
                                 =
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       EDC
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       max
                                    
                                 
                                 =
                                 
                                    
                                       
                                          d
                                          ˆ
                                       
                                    
                                    
                                       AIC
                                    
                                 
                                 .
                              
                           
                        
                     

For small-sample scenarios where M and N are comparable to each other, the ITCs are no longer optimal. Instead, the source enumerators that are devised based on the large-dimensional random matrix theory have been proven better [6–8,28] and can be used to establish the lower and upper bounds.

The simulated data are generated according to (1). To determine the threshold and no information SNRs, η and ρ are set as 1° and 0.05, respectively. For given numbers of sensors and snapshots, number of sources, source powers and spatial frequencies, the results are plotted for various SNRs, which are defined in (13). For each SNR, the results represent an average of 
                        Q
                        =
                        1000
                      independent realizations.

First, we validate the concepts of the proposed ESN and MSN and their determination algorithms. We consider a system where 
                        d
                        =
                        5
                      equal-power sources are impinging on a ULA of 
                        M
                        =
                        10
                      elements each collecting 
                        N
                        =
                        20
                      snapshots. The DOAs are 
                        θ
                        =
                        [
                        −
                        90
                        ,
                        −
                        45
                        ,
                        −
                        42
                        ,
                        −
                        60
                        ,
                        −
                        70
                        ]
                        °
                      such that a pair of closely-spaced sources is present. Fig. 7
                      shows the identified ESN and MSN for various SNRs by MC simulation. Note that the ESN/MSN is equal to the number of sources at a low noise level in the asymptotic region, and gradually decreases as the noise power increases in the threshold region, and finally down to zero at a high noise level in the no information region. Moreover, the gap between the MSN and ESN is small.


                     Fig. 8
                     (a) shows the corresponding root MSE (RMSE) of the frequency estimates obtained by ESPRIT. In the legend, the “Matched” curve corresponds to the RMSE computed based on the 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      frequency estimates that are returned when 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      is sent to ESPRIT, whereas the “BEST: 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                     ” curve corresponds to the RMSE based on the 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      most accurate frequency estimates chosen from all d frequency estimates that are obtained when d is fed into ESPRIT. And the “CRB: 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                     ” and “CRB: 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                     ” curve respectively correspond to the square root of the mean of the 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      and 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      smallest diagonal elements of the CRB covariance matrix.

The result shows that the “Matched” curve is far below that of the total RMSE, which shows that under-enumeration indeed can result in improved RMSE. Likewise, the RMSE of the 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      most accurate frequency estimates is well below that of the total RMSE, which indicates that the outliers have been excluded from the estimates. Furthermore, compared with the 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      most accurate frequency estimates using d, there is only slight decrease in estimation accuracy of the 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      frequency estimates using 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                     . However, for the former, other than the 
                        
                           
                              d
                           
                           
                              eff
                           
                        
                      most accurate frequency estimates, 
                        (
                        d
                        −
                        
                           
                              d
                           
                           
                              eff
                           
                        
                        )
                      outliers are also obtained, whereas for the latter, the outliers have been automatically removed, leaving 
                        
                           
                              d
                           
                           
                              mat
                           
                        
                      accurate estimates. As shown in Fig. 8(b), the MSN is “optimal” in a sense that it corresponds to the smallest RMSE of the frequency estimates that could be obtained by inputting varying source number in ESPRIT. Consequently, a maximum number of accurate estimates is kept while the decline in accuracy is minimized. In this sense, the MSN is a good match for ESPRIT.

Next, we evaluate the performance of the proposed source enumerator to attain the MSN. We adopt the root mean square detection error (RMSDE) as the performance measure, which is defined as
                        
                           (32)
                           
                              RMSDE
                              =
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             Q
                                          
                                       
                                       
                                          
                                             |
                                             
                                                d
                                                ˆ
                                             
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   mat
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    Q
                                 
                              
                              .
                           
                        
                      The RMSDEs of AIC, MDL, EDC, SAMOS, and OE-PABS are used as the performance benchmarks.

First we consider a scenario with widely-spaced sources of imbalanced powers: 
                        M
                        =
                        10
                        ,
                        N
                        =
                        100
                      and 
                        d
                        =
                        5
                     . The DOAs are set as 
                        θ
                        =
                        [
                        −
                        81
                        ,
                        −
                        45
                        ,
                        −
                        9
                        ,
                        27
                        ,
                        63
                        ]
                        °
                     , and the ratio of source powers are fixed as 
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                           
                           
                              2
                           
                        
                        :
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                           
                           
                              2
                           
                        
                        :
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    3
                                 
                              
                           
                           
                              2
                           
                        
                        :
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    4
                                 
                              
                           
                           
                              2
                           
                        
                        :
                        
                           
                              σ
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    5
                                 
                              
                           
                           
                              2
                           
                        
                        =
                        1
                        :
                        10
                        :
                        100
                        :
                        500
                        :
                        1000
                     . In Fig. 9
                     (a) and Fig. 9(b), the mean value of the estimated source number by different source enumerators and the RMSDE are shown, respectively. We see that the subspace-based source enumerators such as ESTER, SAMOS and MUSIC return source number estimates that fit much better with the MSN than that returned by ITCs. In particular, the ESTER performs consistently better than or comparably to other source enumerators for the whole SNRs in the sense that its returned source number estimate has small deviations from the MSN.

For scenarios with the presence of closely-spaced sources, the mean value of the estimated source number by different source enumerators and the RMSDE are shown in Fig. 10
                     , where the DOAs are 
                        θ
                        =
                        [
                        20
                        ,
                        59
                        ,
                        28
                        ,
                        46
                        ,
                        55
                        ]
                        °
                      and the sources have equal powers. We see that in the presence of closely-spaced sources, the subspace-based source enumerators such as SAMOS, ESTER and OE-PABS tend to underestimate the MSN for high SNRs and to overestimation for low SNRs. In other words, their estimated source number is considerably deviated from the MSN. In contrast, the proposed detection scheme, which is a combination of the ESTER and ITCs, returns a source number estimate that fits well with the MSN, with higher level of fitness than that of the ITCs.

@&#CONCLUSION@&#

In the threshold region of nonlinear parameter estimators, the use of true source number for DOA estimation incurs large mean square error. In the presence of closely-spaced sources and/or severely imbalanced powers among sources, the estimation errors are unequally distributed among the parameter estimates of different sources. The number of signals whose parameters can be accurately estimated is referred to as the ESN. Given the numbers of sensors and snapshots, number of sources, signal parameters and noise level, the ESN can be determined by Monte Carlo simulation. In an effort to automatically remove the inaccurate estimates while keeping the accurate ones, we have proposed the concept of MSN for a parameter estimation scheme, which refers to the number of signals that yields the smallest MSE of the parameter estimates. Moreover, we have designed a detection scheme that can attain the MSN for ESPRIT based on the combination of state-of-the-art source enumerators. The proposed concepts and approaches may be generalized to other parameter estimation schemes. As a future research direction, we plan to derive the analytical expression of the ESN and design a source enumerator that can return a source number estimate with better fitness for the ESN than existing detection algorithms. This has practical significance in that with the knowledge of ESN, namely, the maximum number of available accurate frequency estimates, we may be able to decide which parameter estimates are accurate.

@&#REFERENCES@&#

