@&#MAIN-TITLE@&#A novel battery network modelling using constraint differential evolution algorithm optimisation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel battery network system with optimal management of energy is proposed.


                        
                        
                           
                           An optimal management strategy has been implemented.


                        
                        
                           
                           The constraint differential evolution optimisation is applied to above system.


                        
                        
                           
                           The new strategy can remove more peak areas of forecasted demand data.


                        
                        
                           
                           The proposed method is also compared to the self-adaptive control algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Optimisation

Constraint optimisation

Self-adaptive control

Distributed network model

@&#ABSTRACT@&#


               
               
                  The use of battery storage devices has been advocated as one of the main ways of improving the power quality and reliability of the power system, including minimisation of energy imbalance and reduction of peak demand. Lowering peak demand to reduce the use of carbon-intensive fuels and the number of expensive peaking plant generators is thus of major importance. Self-adaptive control methods for individual batteries have been developed to reduce the peak demand. However, these self-adaptive control algorithms of are not very efficient without sharing the energy among different batteries. This paper proposes a novel battery network system with optimal management of energy between batteries. An optimal management strategy has been implemented using a population-based constraint differential evolution algorithm. Taking advantage of this strategy the battery network model can remove more peak areas of forecasted demand data compared to the self-adaptive control algorithm developed for the New York City study case.
               
            

@&#INTRODUCTION@&#

Battery energy storage has found a wide range of applications in various fields of science. Batteries can improve the power quality (mainly voltage depressions and power interruptions) and reliability of power system [1]. Battery storage could also play a vital role in deferring the need to improve the transmission and distribution capacity to meet ever growing power demand by effectively increasing the capacity of a given network by reducing peaks. In recent years, the capital cost of battery storage technologies has significantly reduced, thus justifying a new study of its applications [2]. For example, some of earliest commercial use of battery storage device were at Bewag, Germany (17MW/14MWh battery for frequency regulation) and at Southern California Edison Chino substation (10MW/40MWh for load levelling, rapid spinning reserve and instantaneous frequency control) [3] and [4]. The earliest transportable battery (lead-acid), located at Phoenix distribution system is a multi-model battery [5]. The battery switches between improving power quality (2MW up to 15s) and improving power management (200kW for 45min) and uses a different mode for each model. The megawatt scale deployment of the Distributed Energy Storage system (DES) technology was also successfully carried out in the American electricity power grid in 2006 [6] and [7]. Higher peaks in demand will increase the electricity price and could cause blackouts and infrastructure damage. Lowering peak demand to reduce the use of carbon-intensive fuels and reduce the number of expensive peaking plant generators is thus of major importance. The Charleston storage project partially funded by the US Department of Energy (DOE) aimed to reduce the peak load on overloaded equipment in the distribution substation [7]. It has operated successfully for three winter and summer peak seasons. Realising multiple benefits that DES technology has to offer, the utility continued to install three 2-MW, 14.4-MWh NaS DES units of larger capacity in their distribution system in 2008 providing peak shaving. The key feature of the new system is triggered peak shaving that does not allow the battery to be discharged unnecessarily during daily peak hours and only discharges the battery when the load of a nearby “bottleneck” on the grid exceeds a certain “trigger”. This approach not only allows the battery to offer its peak shaving value but also increase the availability of the remaining storage energy to serve customers in the event of an outage. Despite the large number of investigations carried out to apply different storage technologies to power system, very few of them have been implemented in practice. One of the main reasons for this limited practical application is lack of practical experience and lack of availability of tools which could be used for optimal control of battery storage in the smart grid during planning. Lately there has been some development of different types of optimal control algorithms in smart grid [8–10].

Coppez et al. [9] has classified battery storage optimisations based on hybrid renewable energy system in four categories: graph construction, probabilistic and deterministic techniques, genetic algorithms and artificial neural networks. Main issues like cell battery technology and optimisation techniques were reviewed. The authors stated that the reliability of supply of the system must be kept in mind to ensure that the load will be met by the supply at all times and economically the system must be optimized to ensure the lowest cost possible whist maintaining the system integrity. A common parameter used to measure the system integrity and reliability is Loss of Power Supply Probability (LPSP). LPSP must be monitored as the key parameter to ensure that in optimising the system, the likelihood of the system supply not being able to meet the load at all times is kept very low. Graphical construction is used to optimise in terms of two criteria (either Photovoltaic (PV) and size of battery storage, or PV and wind turbine. However, some important factors (such as the PV module slope angle and the wind turbine installation height.) were completely neglected. Other techniques will prove more useful for a more complex system with high dimensional parameters because it is only useful for simple systems with few parameters.

Probabilistic techniques can be used in situations where actual hour by hour long-term data is not available and more general data needs to be used [9]. The probabilistic and deterministic techniques are achieved by initially creating a design space of feasible solutions which adhere to the maximum LPSP. The parameters such as the number of wind turbines, size of PV panels and size of battery storage are optimised using the objective function (e.g. cost of the system including PV modules, Batteries, wind turbines and the cost of design and installation). Disadvantage of this probabilistic approach is that it cannot represent the dynamic changing performance of the hybrid system [8].

Ould Bila et al. [11] show a case study of the optimisation of a wind, PV and battery distributed generation system in Senegal. A genetic algorithm (GA) was used to minimise the total cost of the system whist maintaining a low LPSP using the following parameters: number of PV modules, power output of wind turbines, battery capacity and number of inverters and regulators [11]. The system is now functioning optimally. GAs were selected because they have shown to be highly applicable to cases of non-linear systems, where the location of the global optimum is a difficult task [8]. A Neural Networks (NNs) was used to predict the fitness values of solutions in order to speed up the GA search process [12]. This approach substantially decreases the time taken to calculate the optimal solution, while keeping the accuracy of each of the methods. The system includes the photovoltaic arrays, the lead-acid battery and a flywheel. The optimal sizing can be considered as a constrained optimisation problem: minimisation the total capacity of energy storage system, subject to the main constraint of the Loss of Power Supply Probability (LPSP) [12]. The GA spent 45min but the combinatorial optimisation by GA and NNs) spent only 3–5min on calculation.

In addition, Vytelingum et al. [10] developed a novel agent-based micro-storage management of energy storage devices in UK homes that adapts to market condition using game theory optimisation. They show that using demand-side management (i.e., directly controlling the storage profile of a number of homes) coupled with storage can increase savings made in the system. In the UK electricity market, it is possible to achieve savings of up to 13% on average for a consumer on his electricity bill with a storage device of 4kWh. In spite of benefits in using the advanced agent-based model for the smart grid, the cost of micro-storage devices for all UK homes makes it impractical to apply the proposed method and the optimal control of storage details have not been given in the paper. A self-adaptive control model (SACM) of individual battery storage was developed by Rowe et al. [13] to remove the peaks of forecasted demand. The SACM was applied to Bracknell, UK using individual battery. However, the self-adaptive control algorithm of individual battery is not very efficient to reduce peaks without sharing the energy among different batteries. This paper proposes a novel Battery Network Model (BNM) with optimal management between batteries in the network. Mathematically, the optimal management of battery network is a large scale constraint optimisation with the objective of maximally removing the peak areas of forecasted demand or actual demand.

The optimisation methods can be broadly divided into two groups: linear and nonlinear optimisation methods. Linear optimisation's characteristics are a linear objective function to be maximised (or minimised) and linear constraints (i.e. constraints are linear functions of the variables). For some nonlinear optimisation problems, due to non-convexity, the objective function may have many local optima, and an analytical expression of the objective function may not be available. Nonlinear optimisation methods may be classified into deterministic local optimisation methods (e.g., gradient methods or direct search methods) and stochastic global optimisation methods (examples are multiple local search, genetic algorithms, simulated annealing and tabu search) [14–17]. Stochastic optimisation refers to the minimisation (or maximisation) of a function in the presence of randomness in the optimisation process. Genetic algorithms (GAs) [15] and particle swam optimisation (PSO) [18] and differential evolution (DE) [19] are popular stochastic optimisations for better global optimisation frameworks to fully realise the full benefits to conducting mathematical model optimisation, because of their simplicity, global perspective, and inherent parallel processing [20–22].

In most cases of practical interest, global optimisation is very difficult. This is because of the omnipresence of local minimum, the number of which tends to increase exponentially with the size of the problem [17]. Conventional minimisation techniques, which are time consuming and tend to converge to whichever local minimum they first encounter in such cases. The solution in these cases may not be the global minimum but a local minimum sensitive to the starting point. Also these methods are unable to continue the search after a local minimum is reached. Mathematical models may have many local optima on the objective function surface, and in such cases local search is inappropriate because the estimated optimum will depend on the starting point of the search. Due to the high number of possible parameter combinations, computation becomes very expensive for complex models if using a method based on searching combinations of parameters [23]. The particle swarm optimisation and differential evolution are two efficient stochastic optimisation methods minimising an objective function that can model the problem's objectives while incorporating constraints, and have three main advantages: global search regardless of the initial parameter values, fast convergence and a few control parameters. Both techniques have shown great promise in several real-world applications [24–28]. Facts have proved that population based optimisations like GA, PSO and DE are suitable to handle complicated constrained optimisation problems [29] and [30]. Differential Evolution (DE) is used in the paper to optimise the high-dimensional battery network model parameters because of its robust search ability based on benchmark test functions and real applications among these algorithms [28] and [31].

The rest of this paper structured as follows. Section 2 and 3 formulate a self-adaptive control approach for an individual battery and our proposed battery network approach. Section 3 describes the constraint differential evolution algorithm for the battery network optimisation. Section 4 empirically studies this system for New York City peak demand reduction through simulation and optimisation. Finally, Section 5 presents conclusions on the work presented in this paper.

Rowe et al. [13] presented a mathematical model that describes peak areas of actual demand or forecasted demand can be partially removed using an adaptive storage algorithm. The battery storage during Δt and minimisation function of peaks can be formulated as:

                        
                           (1)
                           
                              
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 ±
                                 Z
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 If
                                 
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 +
                                 Z
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 >
                                 
                                    B
                                    c
                                 
                                 
                                 
                                 then
                                 
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 =
                                 
                                    B
                                    c
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 
                                 2
                                 ,
                                 
                                 …
                                 ,
                                 
                                 T
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 If
                                 
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 −
                                 Z
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 <
                                 0
                                 
                                 then
                                 
                                 B
                                 
                                    (
                                    Δ
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          P
                                          r
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          M
                                          i
                                          n
                                          i
                                          m
                                          i
                                          z
                                          e
                                          
                                             (
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      L
                                                   
                                                   
                                                      (
                                                      Z
                                                      
                                                         (
                                                         Δ
                                                         
                                                            t
                                                            i
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         B
                                                         *
                                                      
                                                      
                                                         (
                                                         Δ
                                                         
                                                            t
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      Z
                                                      (
                                                      Δ
                                                      
                                                         t
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             (
                                             
                                                Indexiis
                                                
                                                for
                                                
                                                peak
                                                
                                                areas
                                                
                                                only
                                                .
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          Z
                                          (
                                          Δ
                                          
                                             t
                                             i
                                          
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                t
                                             
                                             
                                                t
                                                +
                                                Δ
                                                
                                                   t
                                                   i
                                                
                                             
                                          
                                          
                                             p
                                             o
                                             w
                                             e
                                             r
                                             (
                                             t
                                             )
                                             
                                             d
                                             t
                                          
                                          −
                                          Δ
                                          
                                             t
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             B
                                             c
                                          
                                          
                                          
                                             (
                                             
                                                Indexiis
                                                
                                                for
                                                
                                                peak
                                                
                                                areas
                                                
                                                only
                                                .
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     Where 
                        
                           B
                           (
                           Δ
                           
                              t
                              i
                           
                           )
                        
                     is energy storage in the battery (kWh) at Δti, power(t) is the power value (kW) in Fig. 1
                     , Bc
                      is the capacity of the low battery, L is the number of peaks, Z(Δti
                     ) is the charged or discharged area of the actual or forecasted demand curve in Fig. 1 and 
                        
                           
                              B
                              *
                           
                           
                              (
                              Δ
                              
                                 t
                                 i
                              
                              )
                           
                        
                      is the energy supply to remove the peak demand from battery storage at Δti
                     . 
                        
                           
                              B
                              *
                           
                           
                              (
                              Δ
                              
                                 t
                                 i
                              
                              )
                           
                        
                      is decided after optimisation process. Fig. 1 shows the forecasted or actual demand with five charged and discharged zones. The horizontal dash line indicates the actual supply threshold from generation or safety limit for the electrical facility. The threshold value depends on capacity of generation and the physical constraints of the network. The self-adaptive control algorithm of individual battery is not very efficient to reduce peaks without sharing the energy among different batteries. Thus, this paper proposes a novel battery network system with optimal management.

The novel battery network modelling approach can be formulated based on the energy conservation law (Fig. 2
                        ):

                           
                              (6)
                              
                                 
                                    
                                       B
                                       1
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       B
                                       1
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    +
                                    
                                       w
                                       13
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    −
                                    
                                       w
                                       12
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       B
                                       2
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       B
                                       2
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    −
                                    
                                       w
                                       23
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    +
                                    
                                       w
                                       12
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       B
                                       3
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       B
                                       3
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    +
                                    
                                       w
                                       23
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    −
                                    
                                       w
                                       13
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    0
                                    ≤
                                    
                                       B
                                       n
                                    
                                    
                                       (
                                       Δ
                                       
                                          t
                                          l
                                       
                                       )
                                    
                                    ±
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          w
                                          
                                             n
                                             j
                                          
                                       
                                       ≤
                                       
                                          B
                                          
                                             n
                                             c
                                          
                                       
                                    
                                    
                                    l
                                    =
                                    1
                                    .
                                    .
                                    .
                                    Q
                                 
                              
                           
                        where M is the number of the connected nodes, wnj
                         is the battery node Bn
                         to borrow energy from its neighbour Bj
                         or lend energy to its neighbour Bj
                        , and the dashed line indicates the weight that can be positive or negative. The Q is the total number of sampled data, and the index l is different from index i in formula (6) and formula (1)

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             P
                                             r
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             M
                                             i
                                             n
                                             i
                                             m
                                             i
                                             z
                                             e
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            L
                                                         
                                                         
                                                            (
                                                            
                                                               Z
                                                               n
                                                            
                                                            
                                                               (
                                                               Δ
                                                               
                                                                  t
                                                                  i
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               B
                                                               *
                                                            
                                                            
                                                               (
                                                               Δ
                                                               
                                                                  t
                                                                  i
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            L
                                                         
                                                         
                                                            Z
                                                            (
                                                            Δ
                                                            
                                                               t
                                                               
                                                                  n
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                             
                                                (
                                                
                                                   Indexiis
                                                   
                                                   for
                                                   
                                                   peak
                                                   
                                                   areas
                                                   
                                                   
                                                      only
                                                      ;
                                                   
                                                   
                                                   N
                                                   =
                                                   3
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where n is the number of nodes and L is the total number of peaks. The above is equivalent to minimising the following formula because all the batteries should keep positive or zero during sharing the electricity:

                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             If
                                             
                                             
                                                B
                                                1
                                             
                                             
                                                (
                                                Δ
                                                
                                                   t
                                                   l
                                                
                                                )
                                             
                                             <
                                             0
                                             
                                             or
                                             
                                             
                                                B
                                                2
                                             
                                             
                                                (
                                                Δ
                                                
                                                   t
                                                   l
                                                
                                                )
                                             
                                             <
                                             0
                                             
                                             or
                                             
                                             
                                                B
                                                3
                                             
                                             
                                                (
                                                Δ
                                                
                                                   t
                                                   l
                                                
                                                )
                                             
                                             <
                                             0
                                             
                                             then
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                             B
                                             M
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             M
                                             i
                                             n
                                             i
                                             m
                                             i
                                             z
                                             e
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      Q
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         B
                                                         1
                                                      
                                                      
                                                         (
                                                         Δ
                                                         
                                                            t
                                                            l
                                                         
                                                         )
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             M
                                             i
                                             n
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      Q
                                                   
                                                   
                                                      
                                                         B
                                                         2
                                                      
                                                      
                                                         (
                                                         Δ
                                                         
                                                            t
                                                            l
                                                         
                                                         )
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             M
                                             i
                                             n
                                             
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      Q
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         B
                                                         3
                                                      
                                                      
                                                         (
                                                         Δ
                                                         
                                                            t
                                                            l
                                                         
                                                         )
                                                      
                                                      
                                                         |
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If Bn
                        (Δtl
                        ) > 0 then 
                           
                              
                                 B
                                 n
                              
                              
                                 (
                                 Δ
                                 
                                    t
                                    l
                                 
                                 )
                              
                              =
                              0
                              
                              n
                              =
                              1
                              ,
                              .
                              .
                              .
                              ,
                              3
                           
                         in the above formula (11).

The formula shows that battery network algorithm can be easily extended to large scale networks because the same structure can be used with more batteries. Storage system models have been proposed to study the time scale-over a short time scale (minutes and/or seconds) and long time scale (days and/or hours) [32]. We will simulate the battery network model around 1 day period for the case study in Section 5.

It is very difficult to converge towards to global optimum for high dimensional optimisation. This is not only because it is constraint problem, but also the curse of dimensionality may increase the convergence time of traditional optimisation methods (e.g. local optimisations) [33].

The particle swarm optimisation and differential evolution are two new stochastic optimisation methods minimising an objective function that can model the problem's objectives while incorporating constraints, and have three main advantages; global search regardless of the initial parameter values; fast convergence, and a few control parameters. Both techniques have shown great promise in several real-world applications [18,19]. The robust constraint DE and PSO search algorithms in this paper are used to optimise the batteries network model parameters. The Constrained DE and PSO consist of two major components: the search algorithm and the constrained-handling technique. Thus, the performance of constrained DE and PSO is primarily dependent on these two components [30]. The aim of the search algorithm is to adjust the exploration and exploitation abilities of population, while the constraint-handling technique focuses how to incorporate the constraints into the DE and PSO evolutionary process.

DE is a population-based direct-search algorithm for global optimisation [19] which utilises P D-dimensional parameter vectors. The standard DE works as follows: for each vector x
                        
                           i, G
                        , 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              .
                              .
                              .
                              ,
                              P
                           
                        , a trial vector v is generated according to

                           
                              (12)
                              
                                 
                                    
                                       v
                                       
                                          i
                                          ,
                                          G
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          
                                             r
                                             1
                                          
                                          ,
                                          G
                                       
                                    
                                    +
                                    F
                                    
                                       (
                                       
                                          x
                                          
                                             
                                                r
                                                2
                                             
                                             ,
                                             G
                                          
                                       
                                       −
                                       
                                          x
                                          
                                             
                                                r
                                                3
                                             
                                             ,
                                             G
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        with r
                        1, r
                        2, r
                        3 ∈ [1, P], P is the Population size, G is the iteration index, integer and mutually different, F > 0, and r
                        1 ≠ r
                        2 ≠ r
                        3 ≠ i. F is a real and constant factor that controls the amplification of the differential variation 
                           
                              (
                              
                                 x
                                 
                                    
                                       r
                                       2
                                    
                                    ,
                                    G
                                 
                              
                              −
                              
                                 x
                                 
                                    
                                       r
                                       3
                                    
                                    ,
                                    G
                                 
                              
                              )
                           
                        . In order to increase the diversity of the parameter vectors, the following vector is adopted:

                           
                              (13)
                              
                                 
                                    
                                       u
                                       
                                          i
                                          ,
                                          G
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          u
                                          
                                             1
                                             i
                                             ,
                                             G
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          u
                                          
                                             2
                                             i
                                             ,
                                             G
                                             +
                                             1
                                          
                                       
                                       ,
                                       .
                                       .
                                       .
                                       ,
                                       
                                          u
                                          
                                             D
                                             i
                                             ,
                                             G
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        With:

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             u
                                             
                                                j
                                                i
                                                ,
                                                G
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                               
                                                                  j
                                                                  i
                                                                  ,
                                                                  G
                                                                  +
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                            if
                                                            
                                                            
                                                               (
                                                               rand
                                                               (
                                                            
                                                            0
                                                            ,
                                                            
                                                            1
                                                            
                                                               )
                                                               ≤
                                                               C
                                                               R
                                                               )
                                                            
                                                            
                                                            or
                                                            
                                                            j
                                                            =
                                                            r
                                                            n
                                                            b
                                                            r
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               
                                                                  j
                                                                  i
                                                                  ,
                                                                  G
                                                               
                                                            
                                                            
                                                               ,
                                                               
                                                               if
                                                               
                                                               
                                                                  (
                                                                  rand
                                                               
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  1
                                                                  )
                                                               
                                                               >
                                                               C
                                                               R
                                                               )
                                                               
                                                               and
                                                               
                                                               j
                                                               ≠
                                                               r
                                                               n
                                                               b
                                                               r
                                                               
                                                                  (
                                                                  i
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             j
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             1
                                             ,
                                             
                                             2
                                             ,
                                             …
                                             ,
                                             D
                                          
                                       
                                    
                                 
                              
                           
                        where D is the problem dimension and CR is a user-defined crossover rate. The DE's control variables (P, F and CR) are not difficult to choose in order to obtain good results [19]. F and CR are both generally in the range [0.5, 1.0]. rnbr(i) is a randomly chosen index from [1, D]. In order to decide whether the new vector u shall become a population member at generation
                           
                              G
                              +
                              1
                           
                        , it is compared to x
                        
                           i, G
                        . If vector u yields a smaller objective function value than x
                        
                           i, G
                        , 
                           
                              x
                              
                                 i
                                 ,
                                 G
                                 +
                                 1
                              
                           
                         is set to u, otherwise the old value x
                        
                           i, G
                         is retained. The reasonable choice for P between 5×
                        D and 10×
                        D has been suggested to have enough mutually different vectors with which to work [19]. The interesting empirical finding is that rising P does not substantially improve the convergence, independent of the number of parameters for some test cases. This is frequently occurred in real-world optimisation problems rather than artificial test functions [19]. As for F, F
                        =0.5 is usually a good initial choice. If the population converges prematurely, then F and or P should be increased. CR
                        =0.9 or CR
                        =1.0 is appropriate to first try since a large CR often speeds convergence. The DE's mutation and crossover operators are very different from GA's operators and PSO's operators, and the selection is almost random (r
                        1, r
                        2, r
                        3 ∈ [1, P] and r
                        1 ≠ r
                        2 ≠ r
                        3 ≠ i) in DE.

Kennedy and Eberhart [18] developed particle swarm optimisation based on the analogy of swarming animals, such as a flock of birds or school of fish. In each iteration, each agent is updated with reference to two “best” values: pbest is the best solution (in terms of fitness) the individual particle has achieved so far, while gbest is the best obtained globally so far by any particle in the population. Each agent seeks to modify its position using the current positions, the current velocities, the distance between the current position and pbest, and the distance between the current position and gbest. The main operators that control the evolutionary process are the mutation and selection operators. Randomly choose one individual as gbest from the population, and modify each searching point:

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             v
                                             i
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             K
                                             [
                                             
                                                v
                                                i
                                                k
                                             
                                             +
                                             
                                                c
                                                1
                                             
                                             ×
                                             rand
                                             
                                                (
                                                )
                                             
                                             ×
                                             
                                                (
                                                p
                                                b
                                                e
                                                s
                                                
                                                   t
                                                   i
                                                
                                                −
                                                
                                                   s
                                                   i
                                                   k
                                                
                                                )
                                             
                                             +
                                             
                                                c
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                             rand
                                             
                                                (
                                                )
                                             
                                             ×
                                             
                                                (
                                                g
                                                b
                                                e
                                                s
                                                t
                                                −
                                                
                                                   s
                                                   i
                                                   k
                                                
                                                )
                                             
                                             
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    K
                                    =
                                    
                                       2
                                       
                                          |
                                          
                                             2
                                             −
                                             φ
                                             −
                                             
                                                
                                                   
                                                      φ
                                                      2
                                                   
                                                   −
                                                   4
                                                   φ
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                    
                                    where
                                    
                                    φ
                                    =
                                    
                                       c
                                       1
                                    
                                    +
                                    
                                       c
                                       2
                                    
                                    
                                    φ
                                    >
                                    4
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       s
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       s
                                       i
                                       k
                                    
                                    +
                                    
                                       v
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        where rand() is a random number between (0, 1). The constriction factor approach can generate higher quality solutions than the conventional PSO approach [34]. If current position outside the boundaries, then it takes the upper bound or lower bound and its velocity is generated randomly (
                           
                              0
                              ≤
                              
                                 v
                                 i
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ≤
                              
                                 v
                                 i
                                 max
                              
                           
                        ) and multiplied by −1 so that it searches in the opposite direction.

In most applications, the penalty function method is used [20]. Usually, an exterior penalty term, which penalise infeasible solutions, is preferred. Based on the constraint violation gj
                        (x) or hk
                        (x) (inequality and equality constraints), a bracket-operator penalty term is added to the objective function and a penalised function is formed:

                           
                              (18)
                              
                                 
                                    F
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    f
                                    
                                       (
                                       x
                                       )
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       
                                          R
                                          j
                                       
                                       
                                          〈
                                          
                                             
                                                g
                                                j
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                          
                                          〉
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          r
                                          k
                                       
                                       
                                          |
                                          
                                             
                                                h
                                                k
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       g
                                       j
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≤
                                    0
                                    ,
                                    j
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    .
                                    ,
                                    s
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       h
                                       k
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    0
                                    ,
                                    j
                                    =
                                    s
                                    +
                                    1
                                    ,
                                    .
                                    .
                                    .
                                    m
                                 
                              
                           
                        where f(x) is the objective function, s is the number of inequality constraints, (m−s) is the number of equality constraints, and Rj
                         and rk
                         are user-defined penalty parameters. The bracket-operator 〈〉 denotes that absolute value of the operand, if the operand is negative. Otherwise, if the operand is non-negative, it returns a value of zero. A constraint 
                           
                              
                                 
                                    g
                                    ̲
                                 
                                 j
                              
                              
                                 (
                                 x
                                 )
                              
                              ≥
                              
                                 b
                                 j
                              
                           
                         can be normalised by using the following transformation:

                           
                              (21)
                              
                                 
                                    
                                       g
                                       j
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                g
                                                ̲
                                             
                                             j
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          b
                                          j
                                       
                                    
                                    −
                                    1
                                    ≥
                                    0
                                 
                              
                           
                        
                     

A recent study suggested a modification by Deb and Goel [34], which eliminates both the above difficulties by not requiring any penalty parameter:

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             If
                                             
                                             x
                                             
                                             is
                                             
                                             
                                                feasible
                                                ;
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             F
                                             (
                                             x
                                             )
                                             =
                                             f
                                             (
                                             x
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          Else
                                       
                                    
                                    
                                       
                                          
                                             F
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                f
                                                max
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   〈
                                                   
                                                      
                                                         g
                                                         j
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                   〉
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   K
                                                
                                                
                                                   |
                                                   
                                                      
                                                         h
                                                         k
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where, f
                        max  is the objective function value of the worse feasible solution in the population.

The general flow chart for the optimisation process using the constraint DE and PSO for the battery network is presented below and illustrated in Fig. 3
                        . The optimisation process can be performed via an automatic process. In order to do so, the user may need to write two small programs for the process. The first program is used to change the parameters of input files of the network model and the second program is used to calculate and evaluate the objective function value. As the standard search progresses, the entire population tends to converge towards the global optimum. This process is continued until a satisfied condition is met. The termination criterion for the iterations is determined according to whether the max iteration or a designed value of the objective function is reached.

In this section we discuss the experimental setup and simulated results with our storage control strategy. The SACM was introduced to reduce peak demand and this technique has shown great promise in real applications [13]. In this study, we investigate the performance of SACM and our proposed BNM with optimal management strategy on New York City, USA. The main objective is to examine whether the BNM using DE and PSO optimisations would outperform better than SACM. Additionally, the experiment would also reveal whether the BNM would have any particular difficulties or preferences. In order to check the battery network model efficiency and visualise the model performance easily, three batteries have been applied for the case study. The system is composed of the following: wind power generation system, gas power generation system, three batteries and three energy supply areas, as Fig. 4
                        . The parameters wnj
                         of the battery network models cannot, in general, be determined directly from mathematical analysis, and hence the parameter values must be estimated by optimisation. In order to minimise the function Pr
                        , it is necessary to minimise the function BM. In our research we used the constraint DE developed in Matlab. The lower and upper bounds weight parameters are equal to [
                           
                              −
                              
                                 B
                                 c
                              
                           
                        , 
                           
                              +
                              
                                 B
                                 c
                              
                           
                        ]. The total number of parameters is equal to 20×3=60 using DE and PSO optimisations when we simulate 20h period using BNM. The relevant experimental parameters using the battery network with DE and PSO optimisations are listed in Tables 1
                         and 2
                        . For the battery network optimisation, an iteration limit of 3000 was employed as a stopping criterion for DE and PSO when a population size of 100 was used. The computational time of DE and PSO optimisations was about 1h on an Intel core 2 Quad CPU 3.40GHz and 8GB of RAM.

We report the results obtained from performing 20 random runs of the battery network algorithm. Fig. 5
                         shows the iteration versus objective function value produced by DE. The DE converged towards to global optima after we ran the constraint DE for about 100 iterations. The left plots of Fig. 6
                         show three actual normalised demand data randomly extracted from New York City demand data. In order to demonstrate the algorithm, 20h sampled data were used for the experiment. From Table 3
                        , it is seen that the battery network model shows a much better result using DE or PSO optimisations. The statistical p value test (p
                        >0.05 fails to reject the H0: the population distribution has normal distribution with mean value m) of the performance by the method BNM using DE and PSO optimisation imply that both models are stable. Thus, it is clear that the battery network model with DE optimal control considered here is capable of removing more peak areas efficiently than the self-adaptive control model for an individual battery. The above results indicate the average percent of peak areas using BNM is around 21.08 and 18.8 percent using DE and PSO more than the SACM, and we also compare the performance between DE and PSO in Table 3. This implies that we get a considerable advantage by using the BNM. This outcome may be easily explained. We assume three batteries are empty for analysis at beginning of simulation. During early hours, the battery (1) is fully charged since its actual demand is very low. However, the battery [3] and [2] need extra electricity supply to remove their peaks. When the BNM is optimised, the constraint DE will give optimal weights of the whole simulated period for sharing the energy among the three batteries. This process can balance batteries energy sharing during Δtl
                        . Hence, performance studies in Table 3 and Fig. 6(b), (d) and (f) reflect the optimal management removing more peaks and head towards to the global optimum. Table 4
                         shows the optimal solutions to share the energy among the three batteries using the constraint PSO and DE, and Table 5
                         shows a consistent good result can be achieved using DE or PSO compared to SACM using a random validation dataset of three demand data. The dot line denotes the battery charge ability and requirements to remove the peak demand, star line the self-adaptive control performance, the circle line the battery network performance in Fig. 6(b), (d) and (f). The negative values in these plots indicate the energy requirements to remove the peaks. During the later hours, the BNM will achieve the similar bad performance as SACM. This is because the three actual demands are all high and there is no energy for sharing. Overall, the results obtained also imply that the BNM is capable of removing the more peaks compared to SACM. Fig. 7
                         shows the validation dataset of three artificial demand data. The performance of BNM depends on forecasted demand data used for optimal management of batteries and the optimal management algorithm. The robust network modelling technique for energy sharing and the optimal control process are the key reasons for the improvements in cut of more peaks than the SACM.

@&#DISCUSSIONS@&#

They are three key reasons for removing more peaks for the three regions using constraint DE and PSO optimisations:

                           
                              (1)
                              One battery can be fully or partly charged when the demand is lower than actual supply threshold or limit (TS) for the safety of the region and the battery is not full. This provides extra energy for sharing to remove more peaks for the whole network.

One battery can share extra energy when the other two batteries are not empty.

The DE and PSO provide the optimal plan for sharing energy among three batteries based on their predictive demands.

In the experiment, we assume that demand is perfectly predictable even though there is a small error between forecasted and actual demand data. The uncertainty analysis of input data of forecasted demand also needs to be studied in the future.

@&#CONCLUSIONS@&#

The use of battery storage devices has been advocated as one of the main ways of improving the power quality and reliability as well as minimisation of energy imbalance of electricity networks. Higher peaks in demand will also increase the electricity price of market and could cause blackouts and infrastructure damage. The proposed novel battery network model using constraint differential evolution algorithm optimisation has been applied to New York City study case. The DE for the optimal management is simple, robust, and converges fast, and finds the good solution in almost every run. In addition, it has few parameters to set and the same settings can be used for many different applications. The test results showed that the average percent of peak demand areas using the proposed novel BNM is around 20.91 percent more than the SACM. The evaluation scheme considers mathematical model performance measures of two different objectives: (1) peak reduction and (2) comparison to an advanced smart control algorithm (SACM). Work is currently undergoing to include (i) large scale battery network applications, and (ii) uncertainty of input data of demand data.

@&#ACKNOWLEDGEMENT@&#

The authors thank Dr. Boyan Li for his comments and input.

@&#REFERENCES@&#

