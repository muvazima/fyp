@&#MAIN-TITLE@&#Metric corrections of the affine camera

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A specific study of the orthographic, weak-perspective and paraperspective cameras.


                        
                        
                           
                           An algebraic procedure solving the affine correction problem for each camera model.


                        
                        
                           
                           A closed-form solution for each camera model.


                        
                        
                           
                           A full characterization of the affine corrections’ generic ambiguities for each camera model.


                        
                        
                           
                           An experimental evaluation comparing the algebraic procedures to global polynomial optimization and an interior-point method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Affine camera

Structure-from-motion

Optimal projection

@&#ABSTRACT@&#


               
               
                  Given a general affine camera, we study the problem of finding the closest metric affine camera, where the latter is one of the orthographic, weak-perspective and paraperspective projection models. This problem typically arises in stratified Structure-from-Motion methods such as factorization-based methods. For each type of metric affine camera, we give a closed-form solution and its implementation through an algebraic procedure. Using our algebraic procedure, we can then provide a complete analysis of the problem’s generic ambiguity space. This also gives the means to generate the other solutions if any.
               
            

@&#INTRODUCTION@&#

We study the problems of finding the closest orthographic, weak-perspective or paraperspective projection to a general affine camera in the sense of the Frobenius norm. These form three instances of the metric affine correction problem class, which we called orthographic affine correction, weak-perspective affine correction and paraperspective affine correction, respectively. The main use of metric affine correction is in Structure-from-Motion by factorization [15,11] and alternation [10]. In the factorization algorithm, metric affine correction is the final stage of a three-stage process. In the first stage, a centered measurement matrix is factored into a joint camera matrix and a structure matrix. This factorization represents an affine 3D reconstruction and is defined up to a (3×3) matrix representing an affine change of coordinates. In the second stage, the metric structure of the affine 3D reconstruction is recovered by computing an affine-to-metric upgrade using the metric constraints from the camera model (for instance, the two rows of the orthographic camera must be orthonormal). The metric constraints are redundant, and can thus only be satisfied approximately. This means that, with noise, the upgraded camera factor is not exactly a metric camera factor. In the third stage, metric affine correction must therefore be performed for each camera in order to recover the metric cameras from the upgraded affine cameras. [15] does factorization with the orthographic camera, while [11] does factorization with the paraperspective camera, but uses a suboptimal metric affine correction procedure, which could thus be replaced by the proposed one. In the alternation algorithm, metric affine correction is the third stage of an iterative three-stage process. The alternation algorithm requires one to provide an initial estimate of the cameras. In the first stage, the structure is computed from the current camera estimates by triangulation. In the second stage, each camera is computed from the current structure estimate by resection. Both stages amount to solve a set of small linear least squares problems. The second stage estimates affine cameras, as it leaves aside the non-linear constraints characterizing each type of metric camera model. In the third stage, metric affine correction is thus performed for each camera in order to recover the metric cameras. These three stages are repeated until convergence is reached. The third stage is fundamental in the alternation algorithm for two reasons. The first reason is that because of noise, similarly to the third stage of the factorization algorithm, the computed general affine cameras are not exactly metric cameras. The second reason is probably more important: without the third stage, an alternation algorithm would converge to an affine, and not to a metric, reconstruction. The third stage indeed introduces the metric constraints into the alternation algorithm. [10] does alternation with the weak-perspective camera, and could be readily extended to the paraperspective camera with our correction procedure.

Metric affine correction shares strong similarities with orthonormal Procrustes analysis. Inspired by the derivation of the optimal solution to orthonormal Procrustes analysis (specifically, we follow the derivation in [1]) inspired by [8,13], we solve orthographic affine correction and weak-perspective affine correction by a simple algebraic procedure, whose derivation is also fairly simple but does not seem to have appeared in the literature before. We also solve paraperspective affine correction by a simple algebraic procedure. Its derivation is however far more involved. We establish the algebraic procedures and prove their optimality. Our procedures allow us to provide an analysis of the problem’s generic ambiguities. These are generic in the sense that they apply to any solution algorithm. Our analysis thus determines cases for which the problem has a unique solution, and cases for which it does not. For the latter, we provide a characterization of the solution space
                        1
                        A space is a set (a simple collection of objects) with some added structure, such as a norm.
                     
                     
                        1
                      and a means to generate all solutions. Our results on the solution ambiguities are summarized in Table 1
                     . Metric affine correction is a set of constrained polynomial optimization problems, to which polynomial optimization methods could be applied. This would however be computationally more expensive by several orders of magnitude than our analytical solutions and would not reveal the problems’ intrinsic structure and degenerate cases.

Our input data is an affine projection matrix written as 
                        
                           P
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                      (and the direction of projection in the paraperspective case). Our goal is to perform metric affine correction on 
                        
                           P
                        
                     . For the orthographic camera, this means finding the camera’s rotation, and for the weak-perspective and paraperspective cameras, this means finding the camera’s rotation and scale factor. The rank of 
                        
                           P
                        
                      must be two [5]. A rank of one would mean that all 3D space points would be projected to a single image line; a rank of zero would mean that they would be projected to a single image point. Even if these are not proper projections, the rank of matrix 
                        
                           P
                        
                      may drop to one or zero for near degenerate geometries under the effect of noise. For instance, a rank of one may happen when viewing an object with a strong tilt, while a rank of zero may happen when viewing an object at a distance with a narrow field of view. Analyzing degenerate cases thus tells us what may happen in near degenerate cases. We established that, excluding the case where 
                        
                           P
                        
                      vanishes (which is equivalent to it having a zero rank), the weak-perspective and paraperspective scale is always uniquely recoverable. However, for the three metric affine cameras, the rotation is uniquely recoverable only if 
                        
                           P
                        
                      has full rank, otherwise it has an ambiguity in 
                        
                           
                              
                                 SO
                              
                              
                                 2
                              
                           
                        
                     .

We first give our notation and background in Section 2. We then solve the metric correction problem for the orthographic, weak-perspective and paraperspective cameras in Sections 3–5 respectively. For each camera model, we first give the correction’s cost function and pseudo-code. We then derive the correction procedure based on the Singular Value Decomposition (SVD) and analyze the correction’s ambiguities. The details of our analysis of the correction’s ambiguities for the paraperspective camera are deferred to Appendix A. We finally give experimental results in Section 6 and conclude in Section 7.


                        General notation. We use italics for scalar (such as a and 
                           
                              α
                           
                        ), bold fonts for vector (such as 
                           
                              v
                           
                        ) and typewriter fonts for matrices (such as 
                           
                              A
                           
                        ). The entries of a vector or matrix are written as in 
                           
                              A
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                      ,
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . We use 
                           
                              diag
                           
                         to create (block) diagonal matrices. We use double bar fonts for sets (such as 
                           
                              R
                           
                        ). We use 
                           
                              B
                           
                         to denote a generic binary set with 
                           
                              |
                              B
                              |
                              =
                              2
                           
                        . We have for instance 
                           
                              {
                              -
                              1
                              ,
                              1
                              }
                              ≡
                              B
                           
                        . We write vector two-norm as in 
                           
                              ‖
                              v
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         and matrix Frobenius norm as in 
                           
                              ‖
                              A
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                              
                           
                        . We define 
                           
                              
                                 
                                    
                                       
                                          a
                                          ,
                                          b
                                       
                                    
                                 
                                 
                                    ×
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                b
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              ⊙
                           
                         as the Hadamard (element-wise) product.


                        Orthonormal matrices. We use 
                           
                              
                                 
                                    O
                                 
                                 
                                    d
                                 
                              
                           
                         for the Lie group of orthonormal matrices
                           2
                           A group is a set associated with an operation called the group law. The set and group law must satisfy closure and associativity, and there must be an identity element and an inverse element for each member of the group. For instance, the group law of 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          d
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          SO
                                       
                                       
                                          d
                                       
                                    
                                 
                               is matrix multiplication, the identity element is the identity matrix in 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          d
                                          ×
                                          d
                                       
                                    
                                 
                               and the inverse is element is obtained by matrix transposition.
                        
                        
                           2
                         and 
                           
                              
                                 
                                    SO
                                 
                                 
                                    d
                                 
                              
                              ⊂
                              
                                 
                                    O
                                 
                                 
                                    d
                                 
                              
                           
                         for the Lie group of special orthonormal matrices, with 
                           
                              d
                              ∈
                              {
                              2
                              ,
                              3
                              }
                           
                        . For 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    d
                                 
                              
                              ,
                              det
                              (
                              A
                              )
                              =
                              ±
                              1
                           
                        ; for 
                           
                              A
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    d
                                 
                              
                              ,
                              det
                              (
                              A
                              )
                              =
                              1
                           
                        . We thus have 
                           
                              
                                 
                                    O
                                 
                                 
                                    d
                                 
                              
                              ≡
                              
                                 
                                    SO
                                 
                                 
                                    d
                                 
                              
                              ×
                              B
                           
                        . Elements of 
                           
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         may be parameterized as 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                cos
                                                θ
                                             
                                             
                                                -
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                sin
                                                θ
                                             
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              θ
                              ∈
                              R
                           
                        . Elements of 
                           
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         may be parameterized as 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                cos
                                                θ
                                             
                                             
                                                -
                                                sin
                                                θ
                                             
                                          
                                          
                                             
                                                a
                                                sin
                                                θ
                                             
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                    
                                 
                              
                           
                         for 
                           
                              θ
                              ∈
                              R
                           
                         and 
                           
                              a
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        . This is equivalent to having 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                b
                                                cos
                                                μ
                                             
                                             
                                                -
                                                b
                                                sin
                                                μ
                                             
                                          
                                          
                                             
                                                sin
                                                μ
                                             
                                             
                                                cos
                                                μ
                                             
                                          
                                       
                                    
                                 
                              
                           
                         for some 
                           
                              μ
                              ∈
                              R
                           
                         and 
                           
                              b
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        . For 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ,
                              det
                              (
                              A
                              )
                              =
                              det
                              (
                              -
                              A
                              )
                           
                        , and the variable a is thus required to specify whether 
                           
                              A
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         (for 
                           
                              a
                              =
                              1
                           
                        ) or 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ⧹
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         (for 
                           
                              a
                              =
                              -
                              1
                           
                        ). For 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         however, 
                           
                              det
                              (
                              A
                              )
                              =
                              -
                              det
                              (
                              -
                              A
                              )
                           
                        , and 
                           
                              A
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         can thus be switched to 
                           
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                              ⧹
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         by simply negating its entries. We write 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         for the space of (2×2) permutation matrices defined as 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    
                                       I
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 
                              
                           
                         with 
                           
                              
                                 
                                    I
                                 
                                 
                                    ̃
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . We have that 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ⊂
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ≡
                              B
                           
                        ,


                        Sub-Stiefel matrices. A sub-Stiefel set 
                           
                              
                                 
                                    SS
                                 
                                 
                                    r
                                    ×
                                    c
                                 
                              
                              ,
                              1
                              ⩽
                              r
                              ⩽
                              3
                              ,
                              1
                              ⩽
                              c
                              ⩽
                              3
                           
                        , is formed as the set of 
                           
                              r
                              ×
                              c
                           
                         blocks taken from all orthonormal matrices in 
                           
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                        . Consequently, the Frobenius norm of any element of 
                           
                              
                                 
                                    SS
                                 
                                 
                                    r
                                    ×
                                    c
                                 
                              
                           
                         is bounded by 1. For instance, 
                           
                              n
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    1
                                    ×
                                    1
                                 
                              
                              ⊂
                              R
                           
                         is a scalar such that 
                           
                              |
                              n
                              |
                              ⩽
                              1
                           
                         and 
                           
                              n
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    1
                                 
                              
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    1
                                 
                              
                           
                         is a vector such that 
                           
                              ‖
                              n
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              1
                           
                        .

The affine camera is simply defined as a projection which preserves parallelism. The general affine camera is thus represented by a matrix 
                           
                              A
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         for the rotational part and a vector 
                           
                              t
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    1
                                 
                              
                           
                         for the translational part. More specifically, a point with world coordinates 
                           
                              Q
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                    ×
                                    1
                                 
                              
                           
                         is projected to image coordinates 
                           
                              q
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    1
                                 
                              
                           
                         as 
                           
                              q
                              =
                              A
                              Q
                              +
                              t
                           
                        . We use metric affine camera to mean an affine camera which satisfies some additional constraints called the metric constraints. Metric affine cameras are important: they form the basis of many Shape-from-X methods, such as Photometric Stereo [17] and Shape-from-Shading [7], to name a few. The metric affine cameras may be derived from the perspective camera in two ways. First, by increasing the focal length to infinity while back-tracking along the principal ray [5]. Second, by approximating perspective projection to some order [3].

The orthographic camera is the simplest metric affine camera. An affine camera is orthographic if 
                           
                              A
                              =
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         with 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        . In other words, 
                           
                              A
                           
                         must be the leading two rows of a 3D rotation matrix. Geometrically, it rotates the object’s points and simply projects them orthographically to the camera’s retina. The weak-perspective camera is a zeroth order approximation of the perspective camera. An affine camera is weak-perspective if 
                           
                              A
                              =
                              α
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         with 
                           
                              α
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        . In other words, 
                           
                              A
                           
                         must be the leading two rows of a 3D rotation matrix up to a positive rescaling. Geometrically, it follows the orthographic camera, and additionally rescales the projected points about the optical axis. The rescaling takes into account the camera to object distance, as 
                           
                              α
                           
                         is chosen as the inverse of the object’s average depth. The paraperspective camera is a first order approximation of the perspective camera. An affine camera is paraperspective if 
                           
                              A
                              =
                              α
                              [
                              I
                              
                              
                              
                              d
                              ]
                              R
                           
                         with 
                           
                              α
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                              ,
                              d
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        . The vector 
                           
                              d
                           
                         is related to a direction of projection. Indeed, a paraperspective camera follows the weak-perspective camera, except that the projection to the retina is along the direction defined by the perspective projection of the object’s center of mass. This allows the paraperspective camera to take the full 3D coordinates of the object’s location into account in the projection process.

The orthographic, weak-perspective and paraperspective cameras form a hierarchy of approximations with gradually increasing precision to perspective projection. The affine camera models are simpler than the perspective camera because their projection process is essentially linear. However, any metric affine camera model must satisfy a set of nonlinear constraints. For these problems such as Structure-from-Motion where the camera parameters must be estimated [11,16,12,15], this has motivated the use of approaches estimating first the general affine model (which, being non-metric, is not subject to nonlinear constraints), and then fitting the chosen metric affine camera model in a second step called metric affine correction.


                        Definition. Our algebraic procedures are extensively based on the SVD [4] in 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        . An SVD 
                           
                              P
                              =
                              U
                              Σ
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         must satisfy 
                           
                              U
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ,
                              V
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              Σ
                              =
                              [
                              
                                 
                                    Σ
                                 
                                 
                                    ¯
                                 
                              
                              
                              
                              
                              0
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         with 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              diag
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . We have that 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         are the singular values of 
                           
                              P
                           
                         in decreasing order. Though the singular values are unique, an SVD is never unique. Understanding the ambiguities of the SVD in 
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         
                        is of utmost importance in studying the ambiguities of metric affine correction. The existence of SVD ambiguities means that for a given reference SVD 
                           
                              P
                              =
                              U
                              Σ
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         there exist concurrent SVDs 
                           
                              P
                              =
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              V
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                         that produce the same 
                           
                              P
                           
                        . Because 
                           
                              U
                              ,
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         there exist 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         such that 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              A
                           
                        . Similarly, there exist 
                           
                              B
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         such that 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              B
                           
                        . Therefore the concurrent SVDs 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              V
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              U
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         and so 
                           
                              Σ
                              =
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . Because the singular values are unique, 
                           
                              Σ
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                           
                         must be equal up to re-ordering. We model this re-ordering with 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              E
                              
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              diag
                              (
                              E
                              ,
                              1
                              )
                           
                         for some 
                           
                              E
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                        . By combining these two equations, we obtain 
                           
                              Σ
                              =
                              M
                              
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              N
                           
                         with 
                           
                              M
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              A
                              E
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         and 
                           
                              N
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              B
                              diag
                              
                                 
                                    (
                                    E
                                    ,
                                    1
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . Therefore a full characterization of the SVD ambiguities is given by the family of matrices 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              B
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         such that:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   =
                                                
                                                
                                                   M
                                                   E
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   =
                                                
                                                
                                                   N
                                                   diag
                                                   (
                                                   E
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                   ∈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                   M
                                                   ∈
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                   N
                                                   ∈
                                                   
                                                      
                                                         O
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   M
                                                   Σ
                                                   =
                                                   Σ
                                                   N
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Note that the family of matrices 
                           
                              M
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         characterizes the ambiguities of the SVD up to re-ordering. The singular values of matrix 
                           
                              P
                           
                         provide a neat way to form categories of ambiguities of the SVD. In 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         this leads to four cases, which we analyze in detail below and summarize the results in Table 2
                        . In practice, this means that our algebraic procedures, which are based on taking the SVD of 
                           
                              P
                           
                        , will have to be tested against a reference SVD and four types of concurrent SVDs for ambiguities.


                        Case 1: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . This case is the most general one and has only generic ambiguities. We partition matrix 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         as:
                           
                              
                                 N
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       1
                                    
                                 
                                 ,
                                 
                                 n
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       1
                                       ×
                                       1
                                    
                                 
                                 ,
                              
                           
                        and using 
                           
                              M
                              Σ
                              =
                              Σ
                              N
                           
                         from Eq. (1) we obtain:
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        This directly gives 
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                           
                        . Because 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                        , this implies 
                           
                              n
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        , and finally 
                           
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        . By parameterizing 
                           
                              M
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         as:
                           
                              
                                 M
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   cos
                                                   θ
                                                
                                                
                                                   -
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   a
                                                   sin
                                                   θ
                                                
                                                
                                                   cos
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                   cos
                                                   μ
                                                
                                                
                                                   -
                                                   sin
                                                   μ
                                                
                                             
                                             
                                                
                                                   b
                                                   sin
                                                   μ
                                                
                                                
                                                   cos
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        with 
                           
                              a
                              ,
                              b
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                         and 
                           
                              θ
                              ,
                              μ
                              ∈
                              R
                           
                        , and using the leading part 
                           
                              M
                              
                                 
                                    Σ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                           
                         of Eq. (2) we obtain the following equation:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   a
                                                   cos
                                                   θ
                                                
                                                
                                                   -
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   a
                                                   sin
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   cos
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   b
                                                   cos
                                                   μ
                                                
                                                
                                                   -
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   sin
                                                   μ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   b
                                                   sin
                                                   μ
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   cos
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        It is trivial that element 
                           
                              (
                              2
                              ,
                              2
                              )
                           
                         implies 
                           
                              cos
                              θ
                              =
                              cos
                              μ
                           
                         and that then element 
                           
                              (
                              1
                              ,
                              1
                              )
                           
                         implies 
                           
                              a
                              =
                              b
                           
                        . Elements 
                           
                              (
                              1
                              ,
                              2
                              )
                           
                         and 
                           
                              (
                              2
                              ,
                              1
                              )
                           
                         imply 
                           
                              sin
                              θ
                              =
                              sin
                              μ
                              =
                              0
                           
                         and so 
                           
                              θ
                              =
                              k
                              π
                              ,
                              μ
                              =
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              π
                           
                        , for 
                           
                              k
                              ,
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              N
                           
                        . Finally, element 
                           
                              (
                              2
                              ,
                              2
                              )
                           
                         implies 
                           
                              k
                              =
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        , and we thus obtain:
                           
                              
                                 M
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                 and
                                 
                                 N
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 .
                              
                           
                        We obtain a generic SVD ambiguity: sign flips on corresponding columns of 
                           
                              U
                           
                         and 
                           
                              V
                           
                        . We finally arrive at:
                           
                              
                                 A
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 E
                                 
                                 and
                                 
                                 B
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 diag
                                 (
                                 E
                                 ,
                                 1
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 E
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        The ambiguity space is thus 
                           
                              
                                 
                                    B
                                 
                                 
                                    4
                                 
                              
                           
                         (it has 4 binary possible choices). Starting from 
                           
                              Σ
                              =
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                        , and replacing 
                           
                              A
                           
                         and 
                           
                              B
                           
                         by their expressions, we obtain 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              E
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              Σ
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    3
                                 
                              
                              )
                              diag
                              (
                              E
                              ,
                              1
                              )
                              =
                              E
                              Σ
                              diag
                              (
                              E
                              ,
                              1
                              )
                           
                        .


                        Case 2: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . Let 
                           
                              σ
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        . This case is known as a ‘degenerate SVD’ in the literature. The SVD can be rewritten as 
                           
                              P
                              =
                              σ
                              U
                              [
                              I
                              
                              
                              
                              0
                              ]
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         and Eq. (1) reduces to 
                           
                              M
                              [
                              I
                              
                              
                              
                              0
                              ]
                              =
                              [
                              I
                              
                              
                              
                              0
                              ]
                              N
                           
                        . By partitioning 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         as we did in case 1, we obtain:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        from which we conclude, again as in case 1, that 
                           
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                              ,
                              n
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        . The leading part of this equation gives us 
                           
                              M
                              =
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                              =
                              C
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        , and leads to:
                           
                              
                                 M
                                 =
                                 C
                                 
                                 and
                                 
                                 N
                                 =
                                 diag
                                 (
                                 C
                                 ,
                                 s
                                 )
                                 
                                 with
                                 
                                 s
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 C
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        Because 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ⊂
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        , we finally arrive at:
                           
                              
                                 A
                                 =
                                 C
                                 
                                 and
                                 
                                 B
                                 =
                                 diag
                                 (
                                 C
                                 ,
                                 s
                                 )
                                 
                                 with
                                 
                                 s
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 C
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        The ambiguity space is thus 
                           
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ×
                              B
                           
                         (it has 1 continuous and 2 binary possible choices). Starting from 
                           
                              Σ
                              =
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                        , and replacing 
                           
                              A
                           
                         and 
                           
                              B
                           
                         by their expressions, we obtain 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              C
                              
                                 
                                 
                                    ⊤
                                 
                              
                              Σ
                              diag
                              (
                              C
                              ,
                              s
                              )
                              =
                              Σ
                              =
                              σ
                              I
                           
                        .


                        Case 3: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In this case, we have 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              diag
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              ,
                              0
                              )
                           
                        . We use a different partition of 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         compared to case 1 and case 2:
                           
                              
                                 N
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       1
                                    
                                 
                                 ,
                                 
                                 n
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       1
                                       ×
                                       1
                                    
                                 
                                 .
                              
                           
                        Eq. (1) is then rewritten as:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   n
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        We thus obtain 
                           
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        , and using the same reasoning as in case 1 and case 2, this implies 
                           
                              n
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                              ,
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    N
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        . We also trivially obtain 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                    ,
                                    1
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              =
                              n
                           
                        . Because 
                           
                              M
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        , this implies 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        , leading to:
                           
                              
                                 M
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                 and
                                 
                                 N
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 C
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 C
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        We finally arrive at:
                           
                              
                                 A
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 E
                                 ,
                                 
                                 and
                                 
                                 B
                                 =
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 C
                                 )
                                 diag
                                 (
                                 E
                                 ,
                                 1
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 C
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 E
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        The ambiguity space is thus 
                           
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ×
                              
                                 
                                    B
                                 
                                 
                                    3
                                 
                              
                           
                         (it has 1 continuous and 4 binary possible choices). Starting from 
                           
                              Σ
                              =
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                        , and replacing 
                           
                              A
                           
                         and 
                           
                              B
                           
                         by their expressions, we obtain 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              E
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              Σ
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              C
                              )
                              diag
                              (
                              E
                              ,
                              1
                              )
                              =
                              E
                              Σ
                              diag
                              (
                              E
                              ,
                              1
                              )
                           
                        .


                        Case 4: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In this case, 
                           
                              P
                              =
                              0
                              =
                              U
                              0
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         with 
                           
                              0
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         the all-zero matrix. We can trivially conclude that 
                           
                              M
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              N
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                        . In other words, 
                           
                              Σ
                              =
                              0
                              
                           
                         contains all the information of the SVD, and 
                           
                              U
                           
                         and 
                           
                              V
                           
                         are uninformative. Because 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ⊂
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        , we arrive at:
                           
                              
                                 A
                                 
                                 ∈
                                 
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 B
                                 
                                 ∈
                                 
                                 
                                    
                                       O
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        The ambiguity space is thus 
                           
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ×
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         (it has 4 continuous and 2 binary possible choices). Starting from 
                           
                              Σ
                              =
                              A
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         we obtain 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              Σ
                              =
                              0
                              
                           
                        .

@&#METHODOLOGY@&#

For each metric affine camera, we first formulate metric affine correction using the Frobenius norm. We use this norm since we do not have specific prior information on the error distribution in 
                           
                              P
                           
                        . The Frobenius norm has been used for many similar problems in 3D computer vision. One of the most well-known examples is probably the rank-correction step of the 8 point algorithm for fundamental matrix estimation [5]. We prove the existence of a solution to this formulation, and give an algebraic procedure to compute this solution using reference SVDs. We then use the algebraic procedure to analyze the problem’s generic degeneracies, corresponding to ambiguous cases which cannot be solved by any algorithm. Because the SVD is the basis of our algebraic procedures, we use its ambiguities as a basis to derive and classify the problem’s generic degeneracies. We consider each of the above four cases of SVD ambiguities for each SVD involved in the algebraic procedure. This is done by substituting the reference SVD by concurrent SVDs and comparing the discrepancy in the result of the algebraic procedure. In other words, we answer the question of which ambiguities of the SVD carry over to the correction procedure. The equivalence between the problem’s generic ambiguities and the algebraic procedure’s can be established since in most cases the latter is non-degenerate.
                           3
                           Degeneracies only occur for a few special cases of paraperspective metric correction. For these cases, we specifically analyze the problem’s generic degeneracies. An algebraic procedure is said to degenerate when it fails to return a valid solution. This here happens due to division by zero.
                        
                        
                           3
                         For all cases, we show how the solution space may be entirely generated.

Defining 
                        
                           
                              
                                 R
                              
                              
                                 ¯
                              
                           
                           ∈
                           
                              
                                 SS
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                      as the first two rows of 
                        
                           R
                           ∈
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                        
                     , the problem of orthographic affine correction is formulated as:
                        
                           (3)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       R
                                       ∈
                                       
                                          
                                             SO
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                              
                              (
                              R
                              )
                              
                              with
                              
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                              
                              (
                              R
                              )
                              
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                              
                              ‖
                              P
                              -
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     In solving this problem, we use an SVD of matrix 
                        
                           P
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     . We write 
                        
                           P
                           =
                           U
                           Σ
                           V
                           
                              
                              
                                 ⊤
                              
                           
                        
                      as the reference SVD, and 
                        
                           P
                           =
                           U
                           
                              
                              
                                 ′
                              
                           
                           
                              
                                 Σ
                              
                              
                                 ′
                              
                           
                           V
                           
                              
                                 
                                    
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                      as the concurrent SVDs. Our algebraic procedure is given in Table 3
                     .

To establish the existence of a solution we only use the reference SVD of matrix 
                           
                              P
                           
                        , that we plug into the cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                              
                           
                        , giving:
                           
                              
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                 
                                 (
                                 R
                                 )
                                 =
                                 ‖
                                 U
                                 Σ
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ‖
                                 Σ
                                 -
                                 U
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 V
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        since multiplying by a unitary matrix preserves the Frobenius norm. Introducing 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              U
                              
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              V
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        , the problem can be rewritten as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                ¯
                                             
                                          
                                          ∈
                                          
                                             
                                                SS
                                             
                                             
                                                2
                                                ×
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 ‖
                                 Σ
                                 -
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        Because 
                           
                              Σ
                           
                         is a diagonal matrix, and using 
                           
                              ‖
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              ‖
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              2
                           
                        , the cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                                 
                                    ′
                                 
                              
                           
                         can be expanded as:
                           
                              
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 ‖
                                 Σ
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ‖
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 2
                                 tr
                                 
                                    
                                       
                                          Σ
                                          
                                             
                                                Z
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 -
                                 2
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        Recall that 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              ⩾
                              0
                           
                         and because 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                              ,
                              |
                              
                                 
                                    Z
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              |
                              ⩽
                              1
                           
                         and 
                           
                              |
                              
                                 
                                    Z
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                              
                              |
                              ⩽
                              1
                           
                        . The cost is thus clearly minimized by choosing 
                           
                              
                                 
                                    Z
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              =
                              
                                 
                                    Z
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                              
                              =
                              1
                           
                        . Because 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                        , we obtain 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              =
                              [
                              I
                              
                              
                              
                              0
                              ]
                           
                        . We finally arrive at 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              =
                              U
                              [
                              I
                              
                              
                              
                              0
                              ]
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         and construct the third row of 
                           
                              R
                           
                         as the cross-product of the first two, giving:
                           
                              
                                 R
                                 =
                                 diag
                                 (
                                 U
                                 ,
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        A geometric interpretation of the recovered orthographic camera may be given by rewriting the result as 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              =
                              (
                              det
                              (
                              V
                              )
                              U
                              )
                              [
                              I
                              
                              
                              
                              0
                              ]
                              
                                 
                                    
                                       det
                                       (
                                       V
                                       )
                                       V
                                       
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 
                              
                           
                        . This shows that 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         performs a rotation 
                           
                              det
                              (
                              V
                              )
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         which aligns the world to the camera’s z-axis, followed by a parallel projection along the z-axis and a composed rotation and reflection 
                           
                              det
                              (
                              V
                              )
                              U
                           
                         in the image plane.

By replacing the estimated 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                           
                         in the cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                                 
                                    ′
                                 
                              
                           
                        , we obtain the value of the cost for the optimal solution as 
                           
                              
                                 
                                    v
                                 
                                 
                                    OR
                                 
                              
                              =
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                                 
                                    ′
                                 
                              
                              (
                              [
                              I
                              
                              
                              
                              0
                              ]
                              )
                           
                        , giving:
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       OR
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        The algebraic procedure of Table 3 simply follows from the derivation above. It handles all four cases of the SVD ambiguities from Table 2, by returning a valid solution which always lies in the solution space, as shown in the next section.

The algebraic procedure in Table 3 solves formulation Eq. (3). Because the former has no degeneracies, it allows us to study the problem’s generic ambiguities by analyzing the solution space. For that purpose, we use the concurrent SVDs instead of the reference SVD of 
                           
                              P
                           
                         in our algebraic proceduce. This leads to 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              diag
                              (
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              ,
                              det
                              (
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              )
                              V
                              
                                 
                                 
                                    
                                       
                                          ′
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                              
                           
                        . We then substitute 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              A
                           
                         and 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              B
                           
                         to analyze the problem’s ambiguities for the four cases of Table 2.


                        Case 1: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . In case 1 we have 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              E
                           
                         and 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    3
                                 
                              
                              )
                              diag
                              (
                              E
                              ,
                              1
                              )
                           
                        . We thus obtain 
                           
                              det
                              (
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    s
                                 
                                 
                                    3
                                 
                              
                              det
                              (
                              U
                              )
                              det
                              (
                              V
                              )
                           
                         since 
                           
                              det
                              (
                              E
                              )
                              ,
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        . The concurrent solutions are thus:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 E
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 diag
                                 (
                                 E
                                 ,
                                 1
                                 )
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        Because 
                           
                              E
                              
                                 
                                 
                                    2
                                 
                              
                              =
                              I
                           
                         (since 
                           
                              E
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ⊂
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        ) and 
                           
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    3
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        , this simplifies to:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 ,
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 R
                                 .
                              
                           
                        In case 1, the solution is thus unique. The optimal cost is 
                           
                              
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        .


                        Case 2: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . In case 2 we have 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              C
                           
                         and 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              diag
                              (
                              C
                              ,
                              s
                              )
                           
                        . We thus obtain 
                           
                              det
                              (
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              s
                              det
                              (
                              U
                              )
                              det
                              (
                              V
                              )
                           
                         since 
                           
                              C
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        . The concurrent solutions are thus:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 C
                                 ,
                                 s
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 diag
                                 
                                    
                                       (
                                       C
                                       ,
                                       s
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        Because 
                           
                              C
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              s
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        , this simplifies to:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 ,
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 R
                                 .
                              
                           
                        In case 2, the solution is thus unique. The optimal cost can be simplified to 
                           
                              2
                              
                                 
                                    (
                                    σ
                                    -
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        , with 
                           
                              σ
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                        .


                        Case 3: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In case 3 we have 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              E
                           
                         and 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              diag
                              (
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ,
                              C
                              )
                              diag
                              (
                              E
                              ,
                              1
                              )
                           
                        . We thus obtain 
                           
                              det
                              (
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              det
                              (
                              C
                              )
                              det
                              (
                              U
                              )
                              det
                              (
                              V
                              )
                           
                         since 
                           
                              det
                              (
                              E
                              )
                              ,
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        . The concurrent solutions are thus:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 diag
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 E
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 det
                                 (
                                 C
                                 )
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 diag
                                 (
                                 E
                                 ,
                                 1
                                 )
                                 diag
                                 
                                    
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       C
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        Because 
                           
                              E
                              
                                 
                                 
                                    2
                                 
                              
                              =
                              I
                           
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              ∈
                              {
                              -
                              1
                              ,
                              1
                              }
                           
                        , this simplifies to:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 diag
                                 (
                                 1
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 det
                                 (
                                 C
                                 )
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 diag
                                 
                                    
                                       (
                                       1
                                       ,
                                       C
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        Defining 
                           
                              G
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              C
                              diag
                              (
                              1
                              ,
                              det
                              (
                              C
                              )
                              )
                           
                         with 
                           
                              G
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         since 
                           
                              C
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              det
                              (
                              G
                              )
                              =
                              1
                           
                        , we rewrite 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                           
                         as:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 ,
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 diag
                                 
                                    
                                       (
                                       1
                                       ,
                                       G
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        In case 3, the solution is thus not unique: there is a rotational ambiguity in 
                           
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                        . A geometric interpretation may be given by rewriting 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                           
                         as the composition of three rotations 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              diag
                              (
                              det
                              (
                              V
                              )
                              U
                              ,
                              det
                              (
                              U
                              )
                              )
                              diag
                              
                                 
                                    (
                                    1
                                    ,
                                    G
                                    )
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    
                                       det
                                       (
                                       V
                                       )
                                       V
                                       
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 
                              
                           
                        . This reveals that the ambiguity is a free rotation 
                           
                              diag
                              (
                              1
                              ,
                              G
                              )
                           
                         around some fixed axis parallel to the image plane. This axis is the camera’s x-axis, rotated by 
                           
                              diag
                              
                                 
                                    
                                       det
                                       (
                                       V
                                       )
                                       U
                                       
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       det
                                       (
                                       U
                                       )
                                    
                                 
                              
                           
                         around the camera’s z-axis. Choosing 
                           
                              G
                              =
                              I
                           
                         leads to 
                           
                              R
                              ′
                              =
                              R
                           
                        , implying that the solution 
                           
                              R
                           
                         returned by the algebraic procedure always lies in the solution space. The optimal cost can be simplified to 
                           
                              
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              1
                           
                        .


                        Case 4: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In case 4, 
                           
                              U
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              U
                              A
                           
                         and 
                           
                              V
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              V
                              B
                           
                        . The concurrent solutions are thus:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 A
                                 ,
                                 det
                                 (
                                 A
                                 )
                                 det
                                 (
                                 B
                                 )
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 B
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        Defining 
                           
                              H
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              diag
                              (
                              A
                              ,
                              det
                              (
                              A
                              )
                              det
                              (
                              B
                              )
                              )
                              B
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                         with 
                           
                              H
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         since 
                           
                              A
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                              ,
                              B
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              det
                              (
                              H
                              )
                              =
                              1
                           
                        , we rewrite 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                           
                         as:
                           
                              
                                 R
                                 
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 diag
                                 (
                                 U
                                 ,
                                 det
                                 (
                                 U
                                 )
                                 det
                                 (
                                 V
                                 )
                                 )
                                 H
                                 V
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        In case 4, the solution is thus not unique: there is a rotational ambiguity in 
                           
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                        . Geometrically, this means that any rotation solves the problem equally well. In other words, the rotation is unrecoverable. Choosing 
                           
                              H
                              =
                              I
                           
                         leads to 
                           
                              R
                              
                                 
                                 
                                    ′
                                 
                              
                              =
                              R
                           
                        , implying that the solution 
                           
                              R
                           
                         returned by the algebraic procedure always lies in the solution space. The optimal cost can be simplified to a constant value: 2.

The problem of weak-perspective affine correction is formulated as:
                        
                           (4)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                             
                                                R
                                                ∈
                                                
                                                   
                                                      SO
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                              
                              (
                              α
                              ,
                              R
                              )
                              
                              with
                              
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                              
                              (
                              α
                              ,
                              R
                              )
                              
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                              
                              ‖
                              P
                              -
                              α
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     As in the orthographic case, we shall use the reference SVD of matrix 
                        
                           P
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                      first and then its concurrent SVDs. Our algebraic procedure is given in Table 4
                     .

We follow the same steps as in the orthographic case. We first define 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              U
                              
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              V
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    SS
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         and rewrite formulation Eq. (4) as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                   ∈
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         SS
                                                      
                                                      
                                                         2
                                                         ×
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 α
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 α
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 ‖
                                 Σ
                                 -
                                 α
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        We then expand the cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                                 
                                    ′
                                 
                              
                           
                        , using 
                           
                              ‖
                              α
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              2
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                           
                        , as:
                           
                              
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 α
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 ‖
                                 Σ
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ‖
                                 α
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 2
                                 α
                                 tr
                                 (
                                 Σ
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 2
                                 α
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        Since 
                           
                              α
                              ⩾
                              0
                           
                         this lets us find 
                           
                              
                                 
                                    Z
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                              =
                              
                                 
                                    Z
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                              
                              =
                              1
                           
                        , from which 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              =
                              [
                              I
                              
                              
                              
                              0
                              ]
                           
                        , with the same arguments as in the orthographic case, and thus 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              =
                              U
                              [
                              I
                              
                              
                              
                              0
                              ]
                              V
                              
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . The cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                                 
                                    ′
                                 
                              
                           
                         can then be rewritten in terms of 
                           
                              α
                           
                         only as:
                           
                              
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 α
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 α
                                 ,
                                 [
                                 I
                                 
                                 
                                 0
                                 ]
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 2
                                 α
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        Differentiating with respect to 
                           
                              α
                           
                         and nullifying leads to:
                           
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             O
                                          
                                          
                                             WP
                                          
                                          
                                             ″
                                          
                                       
                                    
                                    
                                       ∂
                                       α
                                    
                                 
                                 (
                                 α
                                 )
                                 =
                                 4
                                 α
                                 -
                                 2
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        and finally yields 
                           
                              α
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . This result ensures 
                           
                              α
                              ⩾
                              0
                           
                        . It is easy to verify that the estimated 
                           
                              α
                           
                         corresponds to a minimum of the cost since 
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          WP
                                       
                                       
                                          ″
                                       
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              4
                              >
                              0
                           
                        . By replacing the estimated 
                           
                              α
                           
                         in the cost function 
                           
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                                 
                                    ″
                                 
                              
                           
                        , we obtain the value of the cost for the optimal solution as 
                           
                              
                                 
                                    v
                                 
                                 
                                    WP
                                 
                              
                              =
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                                 
                                    ″
                                 
                              
                              (
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                              )
                           
                        , giving:
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       WP
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        The algebraic procedure of Table 4 simply follows from the derivation above. It handles all four cases of the SVD ambiguities from Table 2, by returning a valid solution which always lies in the solution space, as shown in the next section.

The algebraic procedure in Table 4 solves formulation Eq. (4). Because the former has no degeneracies, it allows us to study the problem’s generic ambiguities by analyzing the solution space. As in the orthographic case, we use the concurrent SVDs of 
                           
                              P
                           
                         in our algebraic procedure. Because the estimated rotation is obtained as in the orthographic case, the ambiguities are the same. We thus only study the ambiguities of the estimated scale.


                        Case 1: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . In case 1, because the singular values are the same up to re-ordering in the reference and concurrent SVDs, we conclude that 
                           
                              
                                 
                                    α
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              α
                           
                        . In case 1, the solution is thus unique. The optimal cost is 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        .


                        Case 2: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                        . In case 2, because the singular values are the same up to re-ordering in the reference and the concurrent SVDs, we conclude that 
                           
                              
                                 
                                    α
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              =
                              σ
                              =
                              α
                           
                        , with 
                           
                              σ
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                        . In case 2, the solution is thus unique. It is trivial to derive that the optimal cost vanishes; this means that the solution is exact, and that 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                         is a sufficient constraint to characterize the family of (2×3) matrices representing a valid weak-perspective projection.


                        Case 3: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In case 3, because the singular values are the same up to re-ordering in the reference and the concurrent SVDs, we conclude that 
                           
                              
                                 
                                    α
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              α
                           
                        . In case 3, the scale is thus unique, while the estimated rotation inherits the ambiguity in 
                           
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         from the orthographic case. The solution thus always lies in the solution space, as in the orthographic case. We note that the optimal scale also simplifies to 
                           
                              α
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                           
                        , and the optimal cost to 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                        .


                        Case 4: 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                           
                        . In case 4, the scale vanishes as 
                           
                              
                                 
                                    α
                                 
                                 
                                    ′
                                 
                              
                              =
                              α
                              =
                              0
                           
                        . It is thus unique, while the rotation inherits the ambiguity in 
                           
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         from the orthographic case. The solution thus always lies in the solution space, as in the orthographic case. The optimal cost vanishes.

For a given matrix 
                        
                           D
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , which encapsulates the direction of projection 
                        
                           
                              
                                 [
                                 
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                 
                                 
                                 -
                                 1
                                 ]
                              
                              
                                 ⊤
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                                 ×
                                 1
                              
                           
                        
                      as 
                        
                           D
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           [
                           I
                           
                           
                           
                           d
                           ]
                        
                     , the problem of paraperspective affine correction is stated as:
                        
                           (5)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                α
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      +
                                                   
                                                
                                             
                                             
                                                R
                                                ∈
                                                
                                                   
                                                      SO
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    O
                                 
                                 
                                    PP
                                 
                              
                              (
                              α
                              ,
                              R
                              )
                              
                              with
                              
                              
                                 
                                    O
                                 
                                 
                                    PP
                                 
                              
                              (
                              α
                              ,
                              R
                              )
                              
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                              
                              ‖
                              P
                              -
                              α
                              D
                              R
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     We shall here first consider 
                        
                           D
                        
                      as a general (2×3) matrix. This more general problem may be called scaled-orthonormal Procrustes analysis from 2 points, as explained below. As in the orthographic and weak-perspective cases, we use the reference SVD 
                        
                           P
                           =
                           U
                           
                              
                              
                                 p
                              
                           
                           
                              
                                 Σ
                              
                              
                                 p
                              
                           
                           V
                           
                              
                              
                                 p
                              
                              
                                 ⊤
                              
                           
                        
                      in our derivation, but also the reference SVD 
                        
                           D
                           =
                           U
                           
                              
                              
                                 d
                              
                           
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           V
                           
                              
                              
                                 d
                              
                              
                                 ⊤
                              
                           
                        
                     . We normalize each of them to 
                        
                           P
                           =
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 p
                              
                           
                           
                              
                                 Σ
                              
                              
                                 p
                              
                           
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ⊤
                              
                           
                        
                      and 
                        
                           D
                           =
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 d
                              
                           
                           
                              
                                 Σ
                              
                              
                                 d
                              
                           
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 d
                              
                              
                                 ⊤
                              
                           
                        
                      so that 
                        
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 p
                              
                           
                           ,
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                        
                      by setting:
                        
                           
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              U
                              
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              U
                              
                                 
                                 
                                    d
                                 
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    =
                                 
                                 
                                    def
                                 
                              
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              .
                           
                        
                     The reference and concurrent SVDs of both 
                        
                           P
                        
                      and 
                        
                           D
                        
                      shall be considered to study the problem’s ambiguities, while only the reference SVDs are considered directly below for etablishing the solution’s existence. Our algebraic procedure is given in Table 5
                     .

By interpreting each of the two rows of 
                        
                           P
                        
                      and 
                        
                           D
                        
                      as a pair of corresponding 3D points, problem Eq. (5) can be readily interpreted as a special case of orthonormal Procrustes analysis. In this special case, there is no translation and only two data points (whose source coordinates are defined by matrix 
                        
                           D
                        
                      and thus in practice have the special form 
                        
                           
                              
                                 [
                                 1
                                 
                                 
                                 
                                 0
                                 
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                      and 
                        
                           
                              
                                 [
                                 0
                                 
                                 
                                 
                                 1
                                 
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              
                                 ⊤
                              
                           
                        
                     ). This cannot be solved by existing orthonormal Procrustes analysis methods: a significant part of them does not estimate scale [13,2,9] and methods which solve for scale either distribute it over both point sets to ensure its independence to the rotation [8] or only apply to non-coplanar points (and so to more than three points), as for instance [14]. Finally, none of the existing Procrustes analysis methods works for only two points. In paraperspective factorization for Structure-from-Motion [11], paraperspective affine correction was solved approximately. The procedure finds a suboptimal initial solution which is then refined by means of iterative nonlinear minimization. It is not clear what cost function the initial solution minimizes. In contrast, our procedure directly finds the Frobenius-norm optimal solution.

Plugging the normalized reference SVD of 
                              
                                 P
                              
                            and 
                              
                                 D
                              
                            into the cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                 
                              
                            gives:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                    
                                    (
                                    α
                                    ,
                                    R
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                -
                                                α
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                R
                                             
                                          
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                α
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                R
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           Introducing 
                              
                                 K
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       ×
                                       2
                                    
                                 
                                 ,
                                 K
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ̃
                                    
                                 
                                 ∈
                                 
                                    
                                       SO
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       3
                                    
                                 
                              
                            (with 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                            the upper (2×3) block of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ̃
                                    
                                 
                              
                           ), 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                                 R
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                           , the problem can be reformulated as:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                      ∈
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            SS
                                                         
                                                         
                                                            2
                                                            ×
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    α
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    
                                    with
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    α
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                [
                                                K
                                                
                                                
                                                
                                                0
                                                ]
                                                -
                                                α
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           We expand the cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ′
                                    
                                 
                              
                            as:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    α
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    =
                                    ‖
                                    K
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    2
                                    α
                                    tr
                                    
                                       
                                          
                                             [
                                             K
                                             
                                             
                                             
                                             0
                                             ]
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                                
                                                   ⊤
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           The first term 
                              
                                 ‖
                                 K
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                            is non minimizable. The second term 
                              
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is minimizable but is independent of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . Because 
                              
                                 α
                                 ⩾
                                 0
                              
                           , the problem can be reduced to:
                              
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   Z
                                                
                                                
                                                   ¯
                                                
                                             
                                             ∈
                                             
                                                
                                                   SS
                                                
                                                
                                                   2
                                                   ×
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    
                                    with
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                    
                                    tr
                                    
                                       
                                          
                                             [
                                             K
                                             
                                             
                                             
                                             0
                                             ]
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Let 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       ×
                                       1
                                    
                                 
                              
                            be the first and second rows of 
                              
                                 [
                                 K
                                 
                                 
                                 
                                 0
                                 ]
                              
                           , and let 
                              
                                 λ
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       ×
                                       1
                                    
                                 
                              
                            be a vector of Lagrange multipliers, designed to enforce the three constraints 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 I
                              
                            from 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       SS
                                    
                                    
                                       2
                                       ×
                                       3
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       ×
                                       1
                                    
                                 
                              
                            be the first and second rows of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . The cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ″
                                    
                                 
                              
                            can be expanded to the following Lagrangian:
                              
                                 
                                    L
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    λ
                                    )
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    ‖
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    1
                                    )
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    ‖
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    1
                                    )
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          1
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           Differentiating with respect to 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                           , and nullifying gives:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   L
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   ¯
                                                
                                             
                                             ,
                                             λ
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   L
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   ¯
                                                
                                             
                                             ,
                                             λ
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           This is equivalent to the following linear system:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      I
                                                   
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      I
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      I
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           It cannot be used at this stage to solve for 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                            since the value of 
                              
                                 λ
                              
                            is unknown, and would require one to reintroduce the three nonlinear orthonormality constraints on 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                            to be able to find a solution. However, the above linear system allows us to express the rows of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                            in terms of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                              
                            as:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          4
                                          
                                             
                                                λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                λ
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      I
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      I
                                                   
                                                
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      I
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           By definition, the last element of 
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                              
                            is zero, and because of the block structure of the above linear relationship, we conclude that the last element of 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                            must be zero too. In other words, the last column of 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                              
                            must be zero, and we can write 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 [
                                 Y
                                 
                                 
                                 
                                 0
                                 ]
                              
                           , for some 
                              
                                 Y
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                              
                           . The problem formulation Eq. (6) can thus be rewritten as:
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                      ∈
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                   
                                                   
                                                      Y
                                                      ∈
                                                      
                                                         
                                                            O
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ‴
                                       
                                    
                                    (
                                    α
                                    ,
                                    Y
                                    )
                                    
                                    with
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ‴
                                       
                                    
                                    (
                                    α
                                    ,
                                    Y
                                    )
                                    
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                    
                                    ‖
                                    [
                                    K
                                    
                                    
                                    
                                    0
                                    ]
                                    -
                                    α
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    [
                                    Y
                                    
                                    
                                    
                                    0
                                    ]
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           The cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ‴
                                    
                                 
                              
                            can obviously be directly rewritten as:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ‴
                                       
                                    
                                    (
                                    α
                                    ,
                                    Y
                                    )
                                    =
                                    ‖
                                    K
                                    -
                                    α
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    Y
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           We define 
                              
                                 X
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 α
                                 Y
                              
                           . Because 
                              
                                 Y
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 X
                              
                            is thus a scaled orthonormal matrix, which, using 
                              
                                 s
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ,
                                 u
                                 ,
                                 v
                                 ∈
                                 R
                              
                           , can be parameterized as:
                              
                                 (7)
                                 
                                    X
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      su
                                                   
                                                   
                                                      v
                                                   
                                                
                                                
                                                   
                                                      -
                                                      sv
                                                   
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           with:
                              
                                 (8)
                                 
                                    α
                                    =
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                v
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           We have that 
                              
                                 s
                                 =
                                 1
                              
                            for 
                              
                                 Y
                                 ∈
                                 
                                    
                                       SO
                                    
                                    
                                       2
                                    
                                 
                              
                           , and 
                              
                                 s
                                 =
                                 -
                                 1
                              
                            for 
                              
                                 Y
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                                 ⧹
                                 
                                    
                                       SO
                                    
                                    
                                       2
                                    
                                 
                              
                           . The problem can thus be reformulated as:
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                      ,
                                                      v
                                                      ∈
                                                      R
                                                   
                                                   
                                                      s
                                                      ∈
                                                      {
                                                      -
                                                      1
                                                      ,
                                                      1
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                       
                                    
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    s
                                    )
                                    
                                    with
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                       
                                    
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    s
                                    )
                                    
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                    
                                    ‖
                                    K
                                    -
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    X
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           We first proceed to solve for 
                              
                                 u
                                 ,
                                 v
                              
                           , and then determine s. We rewrite the cost using the column-wise vectorization operator vect as:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                       
                                    
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    s
                                    )
                                    =
                                    ‖
                                    vect
                                    (
                                    K
                                    )
                                    -
                                    vect
                                    (
                                    
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    X
                                    )
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                vect
                                                (
                                                K
                                                )
                                                -
                                                A
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 vect
                                 (
                                 K
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             K
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                       
                                       
                                       
                                       
                                          
                                             K
                                          
                                          
                                             2
                                             ,
                                             1
                                          
                                       
                                       
                                       
                                       
                                       
                                          
                                             K
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       
                                       
                                       
                                       
                                          
                                             K
                                          
                                          
                                             2
                                             ,
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                              
                            and 
                              
                                 A
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       4
                                       ×
                                       2
                                    
                                 
                              
                            depends on s and is defined as:
                              
                                 
                                    A
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      s
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                      s
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           The solution to this linear least squares problem can be obtained as:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                A
                                                
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                A
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    A
                                    
                                       
                                       
                                          ⊤
                                       
                                    
                                    vect
                                    (
                                    K
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    A
                                    
                                       
                                       
                                          ⊤
                                       
                                    
                                    vect
                                    (
                                    K
                                    )
                                    ,
                                 
                              
                           where we used 
                              
                                 s
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                              
                            to cancel factor 
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                              
                           . We finally obtain u and v as:
                              
                                 (9)
                                 
                                    u
                                    =
                                    
                                       
                                          s
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    v
                                    =
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                          
                                          -
                                          s
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                2
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           The final step to complete this solution is to determine s. The problem can be formulated by plugging the estimated 
                              
                                 u
                                 ,
                                 v
                              
                            in the cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ⁗
                                    
                                 
                              
                           :
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             s
                                             ∈
                                             {
                                             -
                                             1
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                          ′
                                       
                                    
                                    (
                                    s
                                    )
                                    
                                    with
                                    
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                          ′
                                       
                                    
                                    (
                                    s
                                    )
                                    
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                vect
                                                (
                                                K
                                                )
                                                -
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                vect
                                                (
                                                K
                                                )
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                -
                                                I
                                                )
                                                vect
                                                (
                                                K
                                                )
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 A
                                 
                                    
                                       
                                          
                                             A
                                             
                                                
                                                
                                                   ⊤
                                                
                                             
                                             A
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 A
                                 
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           . Matrix 
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˆ
                                    
                                 
                                 -
                                 I
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       4
                                       ×
                                       4
                                    
                                 
                              
                            can be expanded as:
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                    -
                                    I
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      s
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                      s
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      -
                                                      s
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      s
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      -
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           By plugging this expansion in the cost function 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ⁗
                                       ′
                                    
                                 
                              
                           , as well as the definition of 
                              
                                 K
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       ̃
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                              
                            with 
                              
                                 
                                    
                                       U
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   l
                                                   cos
                                                   θ
                                                
                                                
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   -
                                                   l
                                                   sin
                                                   θ
                                                
                                                
                                                   cos
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       O
                                    
                                    
                                       2
                                    
                                 
                              
                           , we obtain the following rewriting:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                          ′
                                       
                                    
                                    (
                                    s
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                -
                                                I
                                                )
                                                vect
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           l
                                                                           cos
                                                                           θ
                                                                        
                                                                        
                                                                           sin
                                                                           θ
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           -
                                                                           l
                                                                           sin
                                                                           θ
                                                                        
                                                                        
                                                                           cos
                                                                           θ
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 σ
                                                                              
                                                                              
                                                                                 p
                                                                                 ,
                                                                                 1
                                                                              
                                                                           
                                                                        
                                                                        
                                                                     
                                                                     
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 σ
                                                                              
                                                                              
                                                                                 p
                                                                                 ,
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           Expanding, we obtain:
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                       
                                          ⁗
                                          ′
                                       
                                    
                                    (
                                    s
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            d
                                                            ,
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  l
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  -
                                                                  s
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  cos
                                                                  θ
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  l
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  -
                                                                  s
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  sin
                                                                  θ
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  ls
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  sin
                                                                  θ
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  ls
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  cos
                                                                  θ
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           The value of s which minimizes the absolute value of each element of the above vector is 
                              
                                 s
                                 =
                                 l
                              
                           . This may be shown by inspecting each element in turn. For the first one, for instance, ignoring the factors 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                              
                            and 
                              
                                 cos
                                 θ
                              
                           , one is left with 
                              
                                 l
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                 
                                 -
                                 s
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                 
                              
                           . Because 
                              
                                 l
                                 ,
                                 s
                                 ∈
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                 
                                 ⩾
                                 0
                              
                           , it is clear that 
                              
                                 s
                                 =
                                 l
                              
                            always minimizes the value of the difference. The same reasoning holds for the four elements involved. Replacing the solution 
                              
                                 s
                                 =
                                 l
                              
                            in the cost 
                              
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ⁗
                                       ′
                                    
                                 
                              
                           , we obtain the value of the cost for the optimal solution as 
                              
                                 
                                    
                                       v
                                    
                                    
                                       PP
                                    
                                 
                                 =
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ⁗
                                       ′
                                    
                                 
                                 (
                                 l
                                 )
                              
                           , giving:
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          PP
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               )
                                                               cos
                                                               θ
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               )
                                                               sin
                                                               θ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           This can be simply rewritten as:
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          PP
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                d
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         p
                                                         ,
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         p
                                                         ,
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         p
                                                         ,
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         p
                                                         ,
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The paraperspective case is merely a special case where 
                              
                                 D
                                 =
                                 [
                                 I
                                 
                                 
                                 
                                 d
                                 ]
                              
                           . The main consequence of this special case is that only case 1 and case 2 in the ambiguities of the SVD of 
                              
                                 D
                              
                            apply, since 
                              
                                 rank
                                 (
                                 [
                                 I
                                 
                                 
                                 
                                 d
                                 ]
                                 )
                                 =
                                 2
                              
                           . This can be easily shown from the (reference) SVD 
                              
                                 D
                                 =
                                 U
                                 
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       d
                                    
                                 
                                 V
                                 
                                    
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           . By multiplying each side of this equation by its transpose, we obtain 
                              
                                 I
                                 +
                                 
                                    
                                       dd
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 U
                                 
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 U
                                 
                                    
                                    
                                       d
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           . Let 
                              
                                 d
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ⊥
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       [
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           . We can verify that 
                              
                                 
                                    
                                       1
                                    
                                    
                                       ‖
                                       d
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 d
                              
                            and 
                              
                                 
                                    
                                       1
                                    
                                    
                                       ‖
                                       d
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            are eigenvectors of 
                              
                                 I
                                 +
                                 
                                    
                                       dd
                                    
                                    
                                       ⊤
                                    
                                 
                              
                            associated respectively to the eigenvalues 
                              
                                 1
                                 +
                                 ‖
                                 d
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                            and 1. The eigenvectors can be directly used as the left singular vector of 
                              
                                 I
                                 +
                                 
                                    
                                       dd
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           , while the square root of the eigenvalues gives us the singular values, leading to:
                              
                                 
                                    U
                                    
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          ‖
                                          d
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            ⊥
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      diag
                                                      (
                                                      
                                                         
                                                            1
                                                            +
                                                            ‖
                                                            d
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      1
                                                      )
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Matrix 
                              
                                 V
                                 
                                    
                                    
                                       d
                                    
                                 
                              
                            can be easily worked out from the SVD equation. This closed-form solution is not directly useful in numerical calculations in practice since it only holds for 
                              
                                 d
                                 
                                 ≠
                                 
                                 0
                              
                            and is unstable for smaller 
                              
                                 ‖
                                 d
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                           . However, it tells us a few useful facts. First, it tells us 
                              
                                 rank
                                 (
                                 D
                                 )
                                 =
                                 2
                              
                            if 
                              
                                 D
                                 =
                                 [
                                 I
                                 
                                 
                                 
                                 d
                                 ]
                              
                            and for any 
                              
                                 d
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                       ×
                                       1
                                    
                                 
                              
                           . Second, it tells us that case 1 of SVD ambiguities occurs for 
                              
                                 d
                                 
                                 ≠
                                 
                                 0
                              
                           , since 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       +
                                       ‖
                                       d
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 =
                                 1
                                 >
                                 0
                                 ⇔
                                 d
                                 
                                 ≠
                                 
                                 0
                              
                           , and case 2 occurs for 
                              
                                 d
                                 =
                                 0
                              
                           , since and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 =
                                 1
                                 >
                                 0
                                 ⇔
                                 d
                                 =
                                 0
                              
                           .

There are several possible ways to turn our theory into an effective algebraic procedure. Our goal is to find the procedure with the least possible computational cost. We chose to proceed in six steps, (S1) to (S6). (S1) is to compute the SVD of 
                           
                              P
                           
                         and 
                           
                              D
                           
                        . (S2) is to form 
                           
                              U
                              =
                              U
                              
                                 
                                 
                                    d
                                 
                                 
                                    ⊤
                                 
                              
                              U
                              
                                 
                                 
                                    p
                                 
                              
                           
                        . We note that 
                           
                              U
                              =
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              
                                 
                                    U
                                 
                                 
                                    ̃
                                 
                              
                           
                        . (S3) is to compute 
                           
                              β
                              ,
                              γ
                              ,
                              δ
                              ∈
                              R
                           
                         as:
                           
                              (11)
                              
                                 β
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                 
                                 ,
                                 
                                 γ
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                 
                                 
                                 and
                                 
                                 δ
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        These three new variables are related to u and v, as follows. By replacing 
                           
                              s
                              =
                              l
                           
                         and the entries of 
                           
                              K
                              =
                              
                                 
                                    U
                                 
                                 
                                    ̃
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                           
                         in Eqs. (9) and (10), and using the fact that 
                           
                              
                                 
                                    U
                                 
                                 
                                    ̃
                                 
                              
                              ∈
                              
                                 
                                    O
                                 
                                 
                                    2
                                 
                              
                           
                        , we obtain:
                           
                              (12)
                              
                                 u
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       δ
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 v
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       δ
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 .
                              
                           
                        (S4) is to compute 
                           
                              η
                           
                         and 
                           
                              α
                           
                        . The former is a new variable related to 
                           
                              β
                              ,
                              γ
                           
                         and 
                           
                              U
                           
                         as:
                           
                              (13)
                              
                                 η
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        By substituting u and v from Eq. (12) in Eq. (8) and noting that 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    2
                                    ,
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                        , we then obtain:
                           
                              (14)
                              
                                 α
                                 =
                                 
                                    
                                       η
                                    
                                    
                                       δ
                                    
                                 
                                 .
                              
                           
                        (S5) is to compute 
                           
                              Z
                              =
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              
                                 
                                    Z
                                 
                                 
                                    ̃
                                 
                              
                           
                        . From Eq. (7), and since 
                           
                              s
                              =
                              l
                           
                        , we obtain by substituting u and v from Eq. (12):
                           
                              (15)
                              
                                 X
                                 =
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 
                                    
                                       1
                                    
                                    
                                       δ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   γ
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   γ
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         2
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   β
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         2
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 
                                    
                                       1
                                    
                                    
                                       δ
                                    
                                 
                                 
                                    
                                       
                                          
                                             β
                                             ,
                                             γ
                                          
                                       
                                    
                                    
                                       ×
                                    
                                 
                                 ⊙
                                 U
                                 .
                              
                           
                        By definition, we have 
                           
                              Y
                              =
                              
                                 
                                    1
                                 
                                 
                                    α
                                 
                              
                              X
                           
                         and 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              =
                              [
                              
                                 
                                    1
                                 
                                 
                                    α
                                 
                              
                              X
                              
                              
                              
                              0
                              ]
                           
                        . Replacing 
                           
                              X
                           
                         by its expression Eq. (15), and forming the third row of 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ̃
                                 
                              
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         as the cross-product of its first two rows, we obtain:
                           
                              (16)
                              
                                 Z
                                 =
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 det
                                 (
                                 V
                                 
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 
                                    
                                       Z
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         η
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                               ,
                                                               γ
                                                            
                                                         
                                                      
                                                      
                                                         ×
                                                      
                                                   
                                                   ⊙
                                                   U
                                                
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   det
                                                   (
                                                   U
                                                   )
                                                   det
                                                   (
                                                   V
                                                   
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                   det
                                                   (
                                                   V
                                                   
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        (S6) is to compute 
                           
                              R
                           
                        . By definition, it simply comes as 
                           
                              R
                              =
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    ̃
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    p
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              det
                              (
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              )
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              Z
                              det
                              (
                              V
                              
                                 
                                 
                                    p
                                 
                              
                              )
                              V
                              
                                 
                                 
                                    p
                                 
                                 
                                    ⊤
                                 
                              
                              =
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              Z
                              V
                              
                                 
                                 
                                    p
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . Our algebraic procedure is summarized in Table 5.

We may obtain a closed-form solution for the scale and rotation from the SVD of 
                           
                              P
                           
                         and 
                           
                              D
                           
                        . By substituting the expressions for 
                           
                              β
                              ,
                              γ
                           
                         and 
                           
                              η
                           
                         from Eqs. (11) and (13) into Eqs. (14) and (16), we arrive at:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             α
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               2
                                                               ,
                                                               2
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     d
                                                                     ,
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     σ
                                                                  
                                                                  
                                                                     p
                                                                     ,
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               1
                                                               ,
                                                               2
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         d
                                                         ,
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             R
                                             =
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                             
                                             
                                             diag
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              p
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              p
                                                                              ,
                                                                              2
                                                                           
                                                                        
                                                                        ,
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              p
                                                                              ,
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              2
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              σ
                                                                           
                                                                           
                                                                              p
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  ×
                                                               
                                                            
                                                            ⊙
                                                            
                                                            U
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  (
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        d
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        σ
                                                                     
                                                                     
                                                                        p
                                                                        ,
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        1
                                                                        ,
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      det
                                                      (
                                                      U
                                                      )
                                                      det
                                                      (
                                                      V
                                                      
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      det
                                                      (
                                                      V
                                                      
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ⊤
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Computing directly this closed-form solution is more expensive than running our algebraic procedure.

The algebraic procedure in Table 5 may degenerate by not returning a valid solution. This specifically happens when 
                           
                              δ
                           
                         or 
                           
                              η
                           
                         (or both) vanishes, since this would cause a division by zero. We have established that a degeneracy occurs when either 
                           
                              rank
                              (
                              P
                              )
                              =
                              0
                           
                         or 
                           
                              rank
                              (
                              D
                              )
                              =
                              0
                           
                         (or both). Both cases may be easily handled as special cases in the algebraic procedure.


                        Case 
                        
                           
                              rank
                              (
                              P
                              )
                              =
                              0
                           
                         
                        and 
                        
                           
                              rank
                              (
                              D
                              )
                              >
                              0
                           
                        . For 
                           
                              rank
                              (
                              P
                              )
                              =
                              0
                           
                        , the cost function can be simplified to 
                           
                              
                                 
                                    O
                                 
                                 
                                    PP
                                 
                              
                              =
                              ‖
                              α
                              D
                              R
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              ‖
                              D
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                        , simplifying formulation Eq. (5) to 
                           
                              
                                 
                                    min
                                 
                                 
                                    α
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                           
                        , and leaving us with the solution 
                           
                              α
                              =
                              0
                           
                         and 
                           
                              R
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                         undetermined. In this case, the algebraic procedure in Table 5 computes 
                           
                              β
                              =
                              γ
                              =
                              0
                           
                        , and thus 
                           
                              η
                              =
                              0
                           
                        . This leads to the correct scale 
                           
                              α
                              =
                              0
                           
                        , but fails to compute 
                           
                              Z
                           
                         since it involves 
                           
                              
                                 
                                    1
                                 
                                 
                                    η
                                 
                              
                           
                        , and thus fails to compute 
                           
                              R
                           
                        .


                        Case 
                        
                           
                              rank
                              (
                              D
                              )
                              =
                              0
                           
                        . For 
                           
                              rank
                              (
                              D
                              )
                              =
                              0
                           
                        , the cost function reduces to the constant value 
                           
                              
                                 
                                    O
                                 
                                 
                                    PP
                                 
                              
                              =
                              ‖
                              P
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                        , leaving us with the solution 
                           
                              α
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              R
                              ∈
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                        , both undetermined. In this case, the algebraic procedure in Table 5 computes 
                           
                              β
                              =
                              γ
                              =
                              0
                           
                        , and thus 
                           
                              η
                              =
                              0
                           
                        , but also 
                           
                              δ
                              =
                              0
                           
                        . This thus fails to compute 
                           
                              α
                           
                         since it involves 
                           
                              
                                 
                                    1
                                 
                                 
                                    δ
                                 
                              
                           
                        , and 
                           
                              Z
                           
                         since it involves 
                           
                              
                                 
                                    1
                                 
                                 
                                    η
                                 
                              
                           
                        , and thus fails to compute 
                           
                              R
                           
                        .

The algebraic procedure in Table 5 solves formulation Eq. (5). Following the discussion directly above, the former degenerates only for 
                           
                              rank
                              (
                              P
                              )
                              =
                              0
                           
                         or 
                           
                              rank
                              (
                              D
                              )
                              =
                              0
                           
                        . In other words, we may, as in the orthographic and weak-perspective cases, use our algebraic procedure to study the problem’s generic ambiguities by analyzing the solution space, in non-degenerate cases. Our analysis proceeds by evaluating our algebraic procedure directly on the concurrent SVDs, and comparing the result with the reference SVDs. Because the SVD of matrices 
                           
                              P
                              ,
                              D
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    ×
                                    3
                                 
                              
                           
                         are involved in the procedure, this leaves 
                           
                              4
                              ×
                              4
                              =
                              16
                           
                         possible combinations of the four cases of SVD ambiguities given in Table 2. We note that in the specific paraperspective case, since one has 
                           
                              D
                              =
                              [
                              I
                              
                              
                              
                              0
                              ]
                           
                         and thus 
                           
                              rank
                              (
                              D
                              )
                              =
                              2
                           
                        , only case 1 and case 2 are left to study in the SVD of 
                           
                              D
                           
                        , leading to an overall number of 
                           
                              2
                              ×
                              4
                              =
                              8
                           
                         relevant cases. For completeness however we shall study the complete set of 16 cases. Our results are summarized in Table 6
                        . The detailed proof can be found in the appendix.

We identified four types of rotational ambiguities: 
                           
                              
                                 
                                    A
                                 
                                 
                                    d
                                 
                              
                              ≡
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                              ≡
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    dp
                                 
                              
                              ≡
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    SO
                                 
                                 
                                    3
                                 
                              
                           
                        . We describe their structure below, and indicate how to obtain the whole spectrum of solutions, from the last step of the algebraic procedure forming the rotation as 
                           
                              R
                              ←
                              V
                              
                                 
                                 
                                    d
                                 
                              
                              Z
                              V
                              
                                 
                                 
                                    p
                                 
                                 
                                    ⊤
                                 
                              
                           
                        :
                           
                              •
                              
                                 Ambiguities of type 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 . This type of ambiguities manifests itself when one may choose any matrix 
                                    
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ∈
                                       
                                          
                                             SO
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to generate an admissible solution as 
                                    
                                       R
                                       ←
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 .


                                 Ambiguities of type 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 . This type of ambiguities manifests itself when one may choose any matrix 
                                    
                                       G
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ∈
                                       
                                          
                                             SO
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to generate an admissible solution as 
                                    
                                       R
                                       ←
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 .


                                 Ambiguities of type 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             dp
                                          
                                       
                                    
                                 
                                 . This type of ambiguities combines types 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             d
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             p
                                          
                                       
                                    
                                 . It manifests itself when one may choose any matrices 
                                    
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ∈
                                       
                                          
                                             SO
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to generate an admissible solution as 
                                    
                                       R
                                       ←
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       Z
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                    
                                 .


                                 Ambiguities of type 
                                 
                                    
                                       
                                          
                                             SO
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 . This type of ambiguities means that the rotation is completely unrecoverable. Any rotation thus solves the problem equally well.

It should be noted from Table 6 that in the paraperspective case, where 
                           
                              rank
                              (
                              D
                              )
                              =
                              2
                           
                        , the procedure is guaranteed to complete and to return a valid solution, in the sense that it always lies in the solution space. The ambiguities are then simple: there are none for 
                           
                              rank
                              (
                              P
                              )
                              =
                              2
                           
                         (case 1 and case 2), there is one in 
                           
                              
                                 
                                    SO
                                 
                                 
                                    2
                                 
                              
                           
                         for 
                           
                              rank
                              (
                              P
                              )
                              =
                              1
                           
                         (case 3), and the rotation is unrecoverable for 
                           
                              rank
                              (
                              P
                              )
                              =
                              0
                           
                         (case 4). The scale is always simple.

For each camera model, we have compared our algebraic procedure, abbreviated by Alg, to an alternative method which we have designed to assess the precision of the numerical results and stability of Alg. The alternative method is based on a quaternion parameterization and global polynomial optimization. It is abbreviated by Poly. The quaternion parameterization is important since 9 entries of a rotation matrix would be too many parameters for current global polynomial optimization toolboxes. We have also used the result of both Alg and Poly to initialize a direct iterative solution of the metric affine correction problems Eqs. (3)–(5) with an interior-point method from Matlab’s optimization toolbox. The resulting methods are respectively abbreviated AlgRef and PolyRef.


                        General methodology for global polynomial optimization correction methods. In Poly, the rotation matrix 
                           
                              R
                           
                         is parameterized by a unit quaternion represented by 
                           
                              a
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    4
                                 
                              
                              ,
                              ‖
                              a
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                        . With this representation, 
                           
                              R
                           
                         becomes a quadratic function of 
                           
                              a
                           
                        , denoted as 
                           
                              R
                              =
                              R
                              (
                              a
                              )
                           
                         and defined as:
                           
                              
                                 R
                                 (
                                 a
                                 )
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         4
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Using the quaternion representation, each metric affine correction problem can be turned into a polynomial optimization problem with 4 unknowns. We used Matlab’s symbolic toolbox to expand each polynomial cost, and used it as a cost function in the Globtipoly 3 toolbox [6]. Globtipoly does global polynomial optimization, and, for our problems, always returns two conjugate solutions representing the same geometric solution, since 
                           
                              R
                              (
                              a
                              )
                              =
                              R
                              (
                              -
                              a
                              )
                           
                        .


                        The orthographic camera. We define 
                           
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                              (
                              a
                              )
                           
                         as the first two rows of 
                           
                              R
                              (
                              a
                              )
                           
                        . Problem Eq. (3) can thus be rewritten as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                   ∈
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                                
                                                   ‖
                                                   a
                                                   
                                                      
                                                         ‖
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 a
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       O
                                    
                                    
                                       OR
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 a
                                 )
                                 
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 
                                 ‖
                                 P
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 a
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        We have changed the original unity constraint 
                           
                              ‖
                              a
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                         to the equivalent quadratic constraint 
                           
                              ‖
                              a
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                        . It is clear that 
                           
                              
                                 
                                    O
                                 
                                 
                                    OR
                                 
                                 
                                    ″
                                 
                              
                           
                         is a quartic polynomial in the entries of 
                           
                              a
                           
                        , which is solved by Globtipoly 3 under the quadratic constraint.


                        The weak-perspective camera. The product 
                           
                              α
                              
                                 
                                    R
                                 
                                 
                                    ¯
                                 
                              
                           
                         involved in problem Eq. (4) can be rewritten as:
                           
                              
                                 α
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 α
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 a
                                 )
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                 
                                 a
                                 )
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                 with
                                 
                                 b
                                 
                                    
                                       =
                                    
                                    
                                       def
                                    
                                 
                                 
                                    
                                       α
                                    
                                 
                                 a
                                 .
                              
                           
                        We have defined 
                           
                              b
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    4
                                 
                              
                           
                         as a general (non-unitary) quaternion. Problem Eq. (4) may thus be reformulated as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          b
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ‴
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       O
                                    
                                    
                                       WP
                                    
                                    
                                       ‴
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 ‖
                                 P
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        It is clear that 
                           
                              
                                 
                                    O
                                 
                                 
                                    WP
                                 
                                 
                                    ‴
                                 
                              
                           
                         is a quartic polynomial in the entries of 
                           
                              b
                           
                        . Once solved by Globtipoly 3, we finally extract the scale as 
                           
                              α
                              ←
                              ‖
                              b
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         and build the rotation as 
                           
                              R
                              ←
                              R
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ‖
                                             b
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .


                        The paraperspective camera. The product 
                           
                              α
                              D
                              R
                           
                         involved in problem Eq. (5) can be rewritten as:
                           
                              
                                 α
                                 D
                                 R
                                 =
                                 α
                                 D
                                 R
                                 (
                                 a
                                 )
                                 =
                                 D
                                 R
                                 (
                                 
                                    
                                       α
                                    
                                 
                                 a
                                 )
                                 =
                                 D
                                 R
                                 (
                                 b
                                 )
                                 .
                              
                           
                        Problem Eq. (5) may thus be reformulated as:
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          b
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ‴
                                       ‴
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                 with
                                 
                                 
                                    
                                       O
                                    
                                    
                                       PP
                                    
                                    
                                       ‴
                                       ‴
                                    
                                 
                                 (
                                 b
                                 )
                                 
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                 
                                 ‖
                                 P
                                 -
                                 D
                                 R
                                 (
                                 b
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        It is clear that 
                           
                              
                                 
                                    O
                                 
                                 
                                    PP
                                 
                                 
                                    ‴
                                    ‴
                                 
                              
                           
                         is a quartic polynomial in the entries of 
                           
                              b
                           
                        . Once solved by Globtipoly 3, we finally extract the scale and rotation from 
                           
                              b
                           
                         as described for the weak-perspective camera.

We simulated orthographic, weak-perspective and paraperspective cameras by randomly drawing scale factors, projection directions and rotations. In order to test the correction methods, we perturbed the simulated perfect camera matrices by random additive gaussian noise with strength varying from 0 to 100% of the camera matrix’ norm. The noise strength thus represents unorthographicity, unweakperspectiveness and unparaperspectiveness respectively. We averaged the results over 10,000 trials for each noise strength. For each camera model, we ran the four methods, and computed their correction residual, given by the value of 
                           
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          OR
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          WP
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          PP
                                       
                                    
                                 
                              
                           
                         from problems Eqs. (3)–(5) respectively, evaluated with the returned solutions. We also computed the discrepancy in rotation and scale (only for the weak-perspective and paraperspective cameras) between PolyRef and the other three methods. The reason we chose PolyRef as a reference here is because it is the one which gives the most objective evaluation of Alg, the method we ultimately want to evaluate here.

@&#EXPERIMENTAL RESULTS@&#


                        Numerical accuracy. Our results are given in Figs. 1–3
                        
                        
                         for the orthographic, weak-perspective and paraperspective cameras respectively. We observe similar trends for the three camera models in several respects. First, we observe that all four methods gave the same correction residual. For the orthographic and weak-perspective cameras, the residual behaves as a quadratic function of the unorthographicity and unweakperspectiveness rates respectively, while for the paraperspective camera, it behaves as a linear function of the unparaperspectiveness rate. The discrepancy between PolyRef and the other methods remains, roughly speaking, at a constant order of magnitude, and is similar for scale and rotation. The discrepancy is of an order of magnitude between 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    4
                                 
                              
                           
                         and 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    5
                                 
                              
                           
                         for Poly, 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    8
                                 
                              
                           
                         for Alg and 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    9
                                 
                              
                           
                         for AlgRef (with the exception of greater than 60% unorthographicity, unweakperspectiveness and unparaperspectiveness rates where it reaches 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    8
                                 
                              
                           
                         in rotation). To be more precise, we report the average discrepancies and standard deviations in Tables 7–9
                        
                        
                        . From these results, it is clear that all methods find very similar results, corresponding to the same geometric solution. PolyRef, Alg and AlgRef all have a very good numerical precision while Poly is slightly less numerically stable.


                        Computation time. We monitored the computation time taken by each method. The following table gives the average and standard deviation over all trials, in seconds:
                           
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                       Poly
                                       
                                       Alg
                                       
                                       AlgRef
                                       
                                       PolyRef
                                       
                                    
                                 
                                 
                                    
                                       Orthographic camera
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                1.0
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                ±
                                                9.0
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                1.0
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      4
                                                   
                                                
                                                ±
                                                1.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                3.5
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                8.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                5.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                2.6
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       Weak-perspective camera
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                9.5
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                7.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                1.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      4
                                                   
                                                
                                                ±
                                                1.9
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                3.6
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                9.1
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                5.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                2.0
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       Paraperspective camera
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                2.1
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                ±
                                                1.5
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                1.7
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      4
                                                   
                                                
                                                ±
                                                5.8
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                4.6
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                1.1
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                6.2
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                                ±
                                                2.7
                                                ×
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      -
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As for the numerical accuracy, we can draw general conclusions valid for the three camera models. As expected, Poly is the slowest, requiring about a tenth of a second per run, followed by AlgRef and PolyRef, being an order of magnitude faster. Finally, Alg is the fastest, as it is three orders of magnitude faster than Poly.


                        Conclusion. For all three camera models, the proposed algebraic procedures Alg are numerically stable as they agree to a very good precision with an iterative interior-point method with two types of initialization: from methods Alg themself (methods AlgRef) and from methods Poly, which are methods using a global polynomial solver (methods PolyRef). Methods Alg are between three and four orders of magnitude more accurate than methods Poly. The algebraic procedures Alg are also between two and three orders of magnitude faster than all other methods.

@&#CONCLUSION@&#

We have given algebraic procedures to solve the problems of finding the closest orthographic, weak-perspective or paraperspective projection matrix to a given general affine projection represented by a (2×3) matrix. These algebraic procedures efficiently implement closed-form solutions which we derived, along with a complete characterization of the problems’ generic ambiguities and solution spaces. We proved that the level of ambiguity can be determined from the input affine projection matrix’ rank. For a full-rank input matrix the solution is always unique. For a rank-one input matrix (representing an affine projection to an image line) the rotation is 1D ambiguous and the weak-perspective and paraperspective scale is unique. For a zero matrix (representing an affine projection to a single image point) the rotation is unrecoverable and the scale vanishes. So as to obtain this complete characterization of ambiguities, we have introduced an original methodology based on the SVD in 
                        
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , which we think could benefit to other problems such as Procrustes analysis. Interesting topics of future work are the detection and handling of ambiguities in the presence of noise.

The Matlab implementation of our three algebraic procedures has been made available under the GPL licence.

@&#ACKNOWLEDGMENT@&#

This research has received funding from the EU’s FP7 through the ERC research Grant 307483 FLEXABLE.

The algebraic procedure in Table 5 solves formulation Eq. (5). The former degenerates for 
                        
                           rank
                           (
                           P
                           )
                           =
                           0
                        
                      or 
                        
                           rank
                           (
                           D
                           )
                           =
                           0
                        
                      (case 4 of the SVD ambiguities in Table 2). We have already established the problem’s specific generic ambiguities for these cases in Section 5.4. Our algebraic procedure thus allows us to study the problem’s generic ambiguities by analyzing the solution space obtained from the concurrent SVDs in 9 cases of SVD ambiguities: cases 1, 2 and 3 for 
                        
                           P
                        
                      combined with cases 1, 2 and 3 for 
                        
                           D
                        
                     . This is done by analyzing the concurrent solutions to our procedure of Table 5 step by step. The 5 remaining cases, corresponding to the algebraic procedure’s degeneracies, are included for completeness, and indicated by an asterisk mark.


                     Preliminaries. We represent a permutation matrix 
                        
                           E
                           ∈
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      by a binary value 
                        
                           e
                           ∈
                           {
                           0
                           ,
                           1
                           }
                        
                      with 
                        
                           E
                           =
                           e
                           I
                           +
                           (
                           1
                           -
                           e
                           )
                           
                              
                                 I
                              
                              
                                 ̃
                              
                           
                        
                     . We use the indicator function 
                        
                           1
                           :
                           {
                           true
                           ,
                           false
                           }
                           →
                           {
                           0
                           ,
                           1
                           }
                        
                     , with:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                e
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                          
                                             
                                                ee
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          (
                                          1
                                          -
                                          e
                                          )
                                          (
                                          1
                                          -
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                e
                                                ≠
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                          e
                                          (
                                          1
                                          -
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          +
                                          (
                                          1
                                          -
                                          e
                                          )
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     We use the rules 
                        
                           
                              
                                 1
                              
                              
                                 e
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 1
                              
                              
                                 e
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           ,
                           
                              
                                 1
                              
                              
                                 e
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 1
                              
                              
                                 e
                                 ≠
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           0
                        
                      and 
                        
                           
                              
                                 1
                              
                              
                                 e
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           +
                           
                              
                                 1
                              
                              
                                 e
                                 ≠
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           1
                        
                     .


                     Case 1–1: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     .
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    E
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          3
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (17)
                                    
                                       U
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (18)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (19)
                                    
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (20)
                                    
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       I
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (22)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          3
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (23)
                                    
                                       U
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (24)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (25)
                                    
                                       V
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             3
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (26)
                                    
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       I
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (28)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (17) and (23) we obtain:
                                 
                                    (29)
                                    
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             U
                                             
                                                
                                                
                                                   d
                                                
                                             
                                             diag
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   s
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             )
                                             E
                                             
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       U
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              This implies 
                                 
                                    |
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    |
                                    =
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    |
                                    U
                                    |
                                    E
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                              , and thus, using Eqs. (20) and (26) we obtain:
                                 
                                    
                                       |
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       I
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       |
                                       U
                                       |
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       I
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       |
                                       U
                                       |
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       |
                                       U
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       |
                                       U
                                       |
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       |
                                       U
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       .
                                    
                                 
                              Because 
                                 
                                    U
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    |
                                    U
                                    |
                                    
                                       
                                          I
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          ̃
                                       
                                    
                                    |
                                    U
                                    |
                                 
                               and 
                                 
                                    |
                                    U
                                    |
                                    =
                                    
                                       
                                          I
                                       
                                       
                                          ̃
                                       
                                    
                                    |
                                    U
                                    |
                                    
                                       
                                          I
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              , and so:
                                 
                                    (30)
                                    
                                       |
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       )
                                       |
                                       U
                                       |
                                       +
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       |
                                       U
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             =
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       |
                                       U
                                       |
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             ≠
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       |
                                       U
                                       |
                                       
                                          
                                             I
                                          
                                          
                                             ̃
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              Using Eqs. (21), (22), (27) and (28) we obtain:
                                 
                                    (31)
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       )
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             =
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       β
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             ≠
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       γ
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (21), (22), (27) and (28) we obtain:
                                 
                                    (32)
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             =
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       γ
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             ≠
                                             
                                                
                                                   e
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       β
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (27) and (28) we obtain:
                                 
                                    (33)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             (
                                             1
                                             -
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             +
                                             (
                                             1
                                             -
                                             
                                                
                                                   e
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       δ
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Eq. (30) implies 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                d
                                             
                                          
                                          =
                                          
                                             
                                                e
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                d
                                             
                                          
                                          ≠
                                          
                                             
                                                e
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                d
                                             
                                          
                                          =
                                          
                                             
                                                e
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                d
                                             
                                          
                                          ≠
                                          
                                             
                                                e
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              , from which we may expand 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                 
                               using Eqs. (31) and (32) as:
                                 
                                    (34)
                                    
                                       
                                          
                                             η
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             +
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       η
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (33) and (34) we obtain 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          δ
                                       
                                    
                                    =
                                    α
                                 
                              .

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Eqs. (31) and (32) imply 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ×
                                       
                                    
                                    =
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                                ,
                                                γ
                                             
                                          
                                       
                                       
                                          ×
                                       
                                    
                                    E
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                               from which we may expand the leading block using Eqs. (29) and (34) as:
                                 
                                    (35)
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ×
                                          
                                       
                                       ⊙
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             η
                                          
                                       
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                   ,
                                                   γ
                                                
                                             
                                          
                                          
                                             ×
                                          
                                       
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       ⊙
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       U
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             η
                                          
                                       
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   β
                                                   ,
                                                   γ
                                                
                                             
                                          
                                          
                                             ×
                                          
                                       
                                       ⊙
                                       (
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       U
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       )
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              From Eqs. (19), (25) and (29) we simplify the bottom right entry to:
                                 
                                    (36)
                                    
                                       det
                                       (
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             3
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (19), (25), (35) and (36) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             3
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                E
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                )
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      3
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      3
                                                   
                                                
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                )
                                                )
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      3
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      3
                                                   
                                                   
                                                      3
                                                   
                                                
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       R
                                       .
                                    
                                 
                              
                           

In case 1–1, the solution is thus unique. The optimal cost is:
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    PP
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   p
                                                   ,
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   p
                                                   ,
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             2
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   1
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   p
                                                   ,
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   σ
                                                
                                                
                                                   d
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   p
                                                   ,
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  


                     Case 1–2: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     . We define 
                        
                           
                              
                                 σ
                              
                              
                                 d
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                        
                     .
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–1.

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (37)
                                    
                                       U
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             d
                                          
                                       
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (38)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (39)
                                    
                                       V
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (40)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (17) and (37) we obtain:
                                 
                                    (41)
                                    
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             U
                                             
                                                
                                                
                                                   d
                                                
                                             
                                             C
                                             
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       C
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (21), (22) and (40) we obtain:
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       β
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (21), (22) and (40) we obtain:
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       )
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       =
                                       γ
                                       .
                                    
                                 
                              We note that 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    γ
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eq. (40) we obtain 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We have seen that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    β
                                    =
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    γ
                                 
                              . Therefore, 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    β
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              . Because 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    1
                                 
                               and this simplifies to 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    β
                                 
                              . Because 
                                 
                                    U
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                 
                              , we also obtain 
                                 
                                    η
                                    =
                                    β
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    β
                                 
                              , and thus 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                              .

Set 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           

We have 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          δ
                                       
                                    
                                    =
                                    α
                                 
                               since 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Because 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                 
                               we have 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ×
                                       
                                    
                                    =
                                    I
                                 
                              , from which, using Eq. (41) we simplify the leading block as:
                                 
                                    (42)
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ×
                                          
                                       
                                       ⊙
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       C
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              Using Eqs. (19), (39) and (41) we simplify the bottom right entry to:
                                 
                                    (43)
                                    
                                       det
                                       (
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (19), (39), (42) and (43) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                U
                                                
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      3
                                                   
                                                
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       
                                          
                                             
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                U
                                                
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      3
                                                   
                                                   
                                                      2
                                                   
                                                
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       R
                                       .
                                    
                                 
                              
                           

In case 1–2, the solution is thus unique. The optimal cost simplifies to 
                        
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       2
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                        
                     . This is the same as the general weak-perspective cost.


                     Case 1–3: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 1–3 almost all the early steps are similar to case 1–1. In fact, they could even be further simplified owing to 
                        
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     , though this is not necessary for the demonstration. We thus here only give the steps which differ from case 1–1.
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (44)
                                    
                                       U
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (45)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (46)
                                    
                                       V
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (47)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (48)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

The leading block is expanded as in case 1–1. From Eqs. (46), (19) and (29) we simplify the bottom right entry to:
                                 
                                    (49)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       det
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              Using Eqs. (19), (35), (46) and (49) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                E
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                )
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      3
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             3
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                1
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                )
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                U
                                                ,
                                                det
                                                (
                                                U
                                                
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                              with 
                                 
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          SO
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    )
                                 
                              .

In case 1–3, the scale 
                        
                           α
                        
                      is thus unique, but the rotation 
                        
                           R
                        
                      has an ambiguity of type 
                        
                           
                              
                                 A
                              
                              
                                 d
                              
                           
                           ≡
                           
                              
                                 SO
                              
                              
                                 2
                              
                           
                        
                     . Choosing 
                        
                           G
                           
                              
                              
                                 d
                              
                           
                           =
                           I
                        
                      leads to 
                        
                           R
                           
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , implying that the solution 
                        
                           R
                        
                      returned by the algebraic procedure always lies in the solution space. The optimal cost simplifies to 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 2
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                        
                     .


                     ∗
                     Case 1–4: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 1–4, 
                        
                           D
                           =
                           O
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , and no information can be retrieved on the scale and the rotation, since they both vanish from the cost function, as studied in Section 5.4. The overall ambiguity space is thus 
                        
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . The cost is constant and given by 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                        
                     .


                     Case 2–1: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     . We define 
                        
                           
                              
                                 σ
                              
                              
                                 p
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                        
                     . Case 2–1 shares similarities with case 1–2 to which we substantially refer.
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (50)
                                    
                                       U
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             p
                                          
                                       
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (51)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (52)
                                    
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (53)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–1.

Set 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

Using Eqs. (23) and (50) we obtain:
                                 
                                    (54)
                                    
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       U
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

By following the same reasoning as in case 1–2 but switching the role of p and d, we obtain from Eqs. (27), (28) and (53) 
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    )
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

By following the same reasoning as in case 1–2 but switching the role of p and d, we obtain from Eqs. (27), (28) and (53) 
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    γ
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–1, 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–2, 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    β
                                    =
                                    η
                                 
                              .

Set 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–2, 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          δ
                                       
                                    
                                    =
                                    α
                                 
                               since 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Following case 1–2, and using Eqs. (25), (52) and (54), the leading block is expanded to 
                                 
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    diag
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    )
                                    U
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                               and the bottom right entry to 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          3
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    det
                                    (
                                    U
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              .

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

By replacing 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                 
                               by its expression directly above, and using Eqs. (25) and (52), we show with similar steps to case 1–2 that 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    V
                                    
                                       
                                       
                                          d
                                       
                                    
                                    Z
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ⊤
                                       
                                    
                                    =
                                    R
                                 
                              .

In case 2–1 the solution is thus unique. The optimal cost simplifies to 
                        
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                 
                                 )
                              
                              
                                 2
                              
                           
                        
                     .


                     Case 2–2: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     . We define 
                        
                           
                              
                                 σ
                              
                              
                                 p
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 σ
                              
                              
                                 d
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                        
                     .
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 2–1.

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–2.

Set 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (37) and (50) we obtain:
                                 
                                    (55)
                                    
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       C
                                       
                                          
                                          
                                             d
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (40) and (53) we obtain 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (40) and (53) we obtain 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    γ
                                 
                              . We note that 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    γ
                                    =
                                    β
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .

Set 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–2, 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–2 and case 2–1, 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    η
                                    =
                                    γ
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           

We have 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          δ
                                       
                                    
                                    =
                                    α
                                 
                               since 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Following case 1–2, and using Eqs. (39), (52) and (55), the leading block is rewritten as 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    C
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ⊤
                                       
                                    
                                    U
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                              . The bottom right entry is rewritten as 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    det
                                    (
                                    U
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              .

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

By replacing 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                 
                               by its expression directly above, and using Eqs. (39) and (52), we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                U
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                   
                                                
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       R
                                       .
                                    
                                 
                              
                           

In case 2–2 the solution is thus unique. The optimal cost vanishes, which means that this is an instance of the exact weak-perspective case.


                     Case 2–3: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . We define 
                        
                           
                              
                                 σ
                              
                              
                                 p
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                        
                     .
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 2–1.

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–3.

Set 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (44) and (50) we obtain:
                                 
                                    (56)
                                    
                                       U
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       )
                                       U
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (47), (48) and (53) we obtain 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           

From Eqs. (47), (48) and (53) we obtain 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    =
                                    γ
                                 
                              . We note that 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    γ
                                    =
                                    β
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .

Set 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           

From Eqs. (47) and (48) we obtain 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                γ
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                
                                                   
                                                      ′
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

See case 1–2 and case 2–1, 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    η
                                    =
                                    γ
                                    =
                                    β
                                 
                              .

Set 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                η
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                           

We have 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          η
                                       
                                       
                                          δ
                                       
                                    
                                    =
                                    α
                                 
                               since 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    η
                                 
                               and 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    δ
                                 
                              .

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

Following case 1–2, and using Eqs. (46), (52) and (56), the leading block simplifies to 
                                 
                                    U
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    E
                                    
                                       
                                       
                                          d
                                       
                                    
                                    diag
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    )
                                    U
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                              . The bottom right entry is rewritten 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    det
                                    (
                                    U
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    det
                                    (
                                    V
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                 
                              .

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

By replacing 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                 
                               by its expression directly above, and using Eqs. (46) and (52), we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       
                                          
                                             
                                                E
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                diag
                                                (
                                                1
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       Z
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                              with, as in case 1–3, 
                                 
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ∈
                                    
                                       
                                          SO
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    )
                                 
                              .

In case 1–3, the estimated scale 
                        
                           α
                        
                      is thus unique, but the rotation 
                        
                           R
                        
                      has an ambiguity of type 
                        
                           
                              
                                 A
                              
                              
                                 d
                              
                           
                           ≡
                           
                              
                                 SO
                              
                              
                                 2
                              
                           
                        
                     . Choosing 
                        
                           G
                           
                              
                              
                                 d
                              
                           
                           =
                           I
                        
                      leads to 
                        
                           R
                           
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , implying that the solution 
                        
                           R
                        
                      returned by the algebraic procedure always lies in the solution space. The optimal cost simplifies to 
                        
                           
                              
                                 σ
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                        
                     .∗
                     Case 2–4: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 2–4, 
                        
                           D
                           =
                           O
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , and no information can be retrieved on the scale and the rotation, since they both vanish from the cost function, as studied in Section 5.4. The overall ambiguity space is thus 
                        
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . Defining 
                        
                           
                              
                                 σ
                              
                              
                                 p
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                        
                     , the optimal cost is 
                        
                           2
                           
                              
                                 σ
                              
                              
                                 p
                              
                              
                                 2
                              
                           
                        
                     .


                     Case 3–1: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     . In case 3–1 almost all the early steps are similar to case 1–1. In fact, they could be further simplified owing to 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     , but this is not necessary for the demonstration. We thus here only give the steps which differ from case 1–1.
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

From Table 2 we have, for 
                                 
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          O
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                    
                                    ∈
                                    {
                                    -
                                    1
                                    ,
                                    1
                                    }
                                 
                              :
                                 
                                    (57)
                                    
                                       U
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       U
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       )
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (58)
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             Σ
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (59)
                                    
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    (60)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    (61)
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       (
                                       1
                                       -
                                       
                                          
                                             e
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

The leading block is expanded as in case 1–1. From Eqs. (25), (29) and (59) we simplify the bottom right entry to:
                                 
                                    (62)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             3
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       det
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (25), (35), (59) and (62) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             3
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                E
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                )
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      3
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                U
                                                diag
                                                (
                                                1
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                              with 
                                 
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          SO
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    )
                                 
                              .

In case 3–1, the estimated scale 
                        
                           α
                        
                      is thus unique, but the rotation 
                        
                           R
                        
                      has an ambiguity of type 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           ≡
                           
                              
                                 SO
                              
                              
                                 2
                              
                           
                        
                     . Choosing 
                        
                           G
                           
                              
                              
                                 p
                              
                           
                           =
                           I
                        
                      leads to 
                        
                           R
                           
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , implying that the solution 
                        
                           R
                        
                      returned by the algebraic procedure always lies in the solution space. The optimal cost simplifies to 
                        
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       d
                                       ,
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           (
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 2
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                           )
                        
                     .


                     Case 3–2: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           >
                           0
                        
                     . In case 3–2 almost all the early steps are similar to case 1–2. In fact, they could be further simplified owing to 
                        
                           
                              
                                 σ
                              
                              
                                 d
                              
                           
                           
                              
                                 =
                              
                              
                                 def
                              
                           
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                        
                     , but this is not necessary for the demonstration. We thus only give the steps which differ from case 1–2.
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 3–1.

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–2.

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

The leading block is expanded as in case 1–2. From Eqs. (39), (41) and (59), we simplify the bottom right entry to:
                                 
                                    (63)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       det
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (39), (42), (59) and (63) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       
                                          
                                             
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       Z
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                              with 
                                 
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          SO
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    )
                                 
                              .

In case 3–2, the estimated scale 
                        
                           α
                        
                      is thus unique, but the rotation 
                        
                           R
                        
                      has an ambiguity of type 
                        
                           
                              
                                 A
                              
                              
                                 p
                              
                           
                           ≡
                           
                              
                                 SO
                              
                              
                                 2
                              
                           
                        
                     . Choosing 
                        
                           G
                           
                              
                              
                                 p
                              
                           
                           =
                           I
                        
                      leads to 
                        
                           R
                           
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , implying that the solution 
                        
                           R
                        
                      returned by the algebraic procedure always lies in the solution space. The optimal cost simplifies to 
                        
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                       ,
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                     .


                     Case 3–3: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 3–3 almost all the early steps are similar to case 1–1. In fact, they could be further simplified owing to 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     , but this is not necessary for the demonstration. We thus only give the steps which differ from case 1–1.
                        
                           •
                           Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    P
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          p
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 3–1.

Set 
                                 
                                    (
                                    U
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ←
                                    SVD
                                    (
                                    D
                                    )
                                    ,
                                    
                                       
                                          Σ
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    [
                                    diag
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    
                                    
                                    
                                    0
                                    ]
                                 
                              
                           

See case 1–3.

Set 
                                 
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    diag
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ×
                                                
                                             
                                             ⊙
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             ,
                                             det
                                             (
                                             U
                                             
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   d
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             det
                                             (
                                             V
                                             
                                                
                                                
                                                   p
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

The leading block is expanded as in case 1–1. From Eqs. (29), (46) and (59) we simplify the bottom right entry to:
                                 
                                    (64)
                                    
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             2
                                          
                                       
                                       det
                                       (
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       C
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       det
                                       (
                                       U
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       det
                                       (
                                       V
                                       
                                          
                                          
                                             p
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Set 
                                 
                                    R
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    ←
                                    V
                                    
                                       
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    Z
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    V
                                    
                                       
                                       
                                          p
                                       
                                       
                                          
                                             
                                                ′
                                             
                                             
                                                ⊤
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Eqs. (35), (46), (59) and (64) we obtain:
                                 
                                    
                                       R
                                       
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             d
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      η
                                                   
                                                
                                                E
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            β
                                                            ,
                                                            γ
                                                         
                                                      
                                                   
                                                   
                                                      ×
                                                   
                                                
                                                ⊙
                                                (
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                U
                                                diag
                                                (
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                )
                                                )
                                                )
                                                E
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      d
                                                      ,
                                                      2
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      p
                                                      ,
                                                      2
                                                   
                                                
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                C
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                                det
                                                (
                                                U
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                                det
                                                (
                                                V
                                                
                                                   
                                                   
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       diag
                                       (
                                       E
                                       
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       1
                                       )
                                       diag
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             p
                                             ,
                                             1
                                          
                                       
                                       ,
                                       C
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       =
                                       V
                                       
                                          
                                          
                                             d
                                          
                                       
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       Z
                                       diag
                                       (
                                       1
                                       ,
                                       G
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       )
                                       V
                                       
                                          
                                          
                                             p
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                              with 
                                 
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    ∈
                                    
                                       
                                          SO
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    G
                                    
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          d
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    )
                                 
                               and 
                                 
                                    G
                                    
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          def
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          p
                                          ,
                                          2
                                       
                                    
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    diag
                                    (
                                    1
                                    ,
                                    det
                                    (
                                    C
                                    
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    )
                                 
                              .

In case 3–3, the estimated scale 
                        
                           α
                        
                      is thus unique, but the rotation 
                        
                           R
                        
                      has an ambiguity of type 
                        
                           
                              
                                 A
                              
                              
                                 dp
                              
                           
                           ≡
                           
                              
                                 SO
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                        
                     . Choosing 
                        
                           G
                           
                              
                              
                                 d
                              
                           
                           =
                           G
                           
                              
                              
                                 p
                              
                           
                           =
                           I
                        
                      leads to 
                        
                           R
                           
                              
                              
                                 ′
                              
                           
                           =
                           R
                        
                     , implying that the solution 
                        
                           R
                        
                      returned by the algebraic procedure always lies in the solution space. The optimal cost simplifies to 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 u
                              
                              
                                 1
                                 ,
                                 2
                              
                              
                                 2
                              
                           
                        
                     .


                     ∗
                     Case 3–4: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           >
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 3–4, 
                        
                           D
                           =
                           O
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , and no information can be retrieved on the scale and the rotation, since they both vanish from the cost function, as studied in Section 5.4. The overall ambiguity space is thus 
                        
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . The optimal cost is 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                              
                                 2
                              
                           
                        
                     .


                     ∗
                     Cases 4–{1,2,3}: 
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           >
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           ⩾
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           ⩾
                           0
                        
                     . In cases 4–1, 4–2 and 4–3 
                        
                           P
                           =
                           O
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     . No information can be recovered on the rotation, but the optimal scale is 
                        
                           
                              
                                 α
                              
                              
                                 ′
                              
                           
                           =
                           α
                           =
                           0
                        
                     , as studied in Section 5.4. The overall ambiguity space is thus 
                        
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                        
                     . The optimal cost vanishes.


                     ∗
                     Case 4–4: 
                     
                        
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 p
                                 ,
                                 2
                              
                           
                           =
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 1
                              
                           
                           =
                           
                              
                                 σ
                              
                              
                                 d
                                 ,
                                 2
                              
                           
                           =
                           0
                        
                     . In case 4–4, 
                        
                           P
                           =
                           D
                           =
                           O
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                                 ×
                                 3
                              
                           
                        
                     , and no information can be retrieved on the scale and the rotation, since they both vanish from the cost function, as studied in Section 5.4. The overall ambiguity space is thus 
                        
                           
                              
                                 SO
                              
                              
                                 3
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . The optimal cost vanishes.

@&#REFERENCES@&#

