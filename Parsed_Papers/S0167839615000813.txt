@&#MAIN-TITLE@&#Univariate subdivision schemes for noisy data with geometric applications

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We construct univariate subdivision schemes for noisy data.


                        
                        
                           
                           The constructed schemes are based on fitting local least squares polynomials.


                        
                        
                           
                           We study the convergence, smoothness, and basic limit functions of these schemes.


                        
                        
                           
                           A statistical model is analyzed and validated by several numerical examples.


                        
                        
                           
                           We present applications of the schemes for data sampled from curves and surfaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Subdivision schemes

Least squares

Convergence analysis

Noisy data

@&#ABSTRACT@&#


               
               
                  We introduce and analyze univariate, linear, and stationary subdivision schemes for refining noisy data by fitting local least squares polynomials. This is the first attempt to design subdivision schemes for noisy data. We present primal schemes, with refinement rules based on locally fitting linear polynomials to the data, and study their convergence, smoothness, and basic limit functions. Then, we provide several numerical experiments that demonstrate the limit functions generated by these schemes from initial noisy data. The application of an advanced local linear regression method to the same data shows that the methods are comparable. In addition, several extensions and variants are discussed and their performance is illustrated by examples. We conclude by applying the schemes to noisy geometric data.
               
            

@&#INTRODUCTION@&#

In recent years, subdivision schemes have become an important tool in many applications and research areas, including animation, computer graphics, and computer aided geometric design, just to name a few (Andersson and Stewart, 2010; Peters and Reif, 2008). A subdivision scheme generates values associated with the vertices of a sequence of nested meshes, with a dense union, by repeated application of a set of local refinement rules. These rules determine the values associated with a refined mesh from the values associated with the coarser mesh. The subdivision scheme is convergent if the generated values converge uniformly to the values of a continuous function, for any set of initial values.

The particular class of interpolatory schemes consists of schemes with refinement rules that keep the values associated with the coarse mesh and only generate new values related to the additional vertices of the refined mesh. An important family of interpolatory schemes is the family of Dubuc–Deslauriers (DD) schemes (Deslauriers and Dubuc, 1989).

Intensive studies have been carried out recently on the generalization of subdivision schemes to more complicated data such as manifold valued data (Wallner and Dyn, 2005; Wallner et al., 2007), matrices (Sharon and Itai, 2013), sets (Dyn and Farkhi, 2002), curves (Itai and Dyn, 2012), and nets of functions (Conti and Dyn, 2011). In Donoho and Yu (2000) subdivision schemes have been used in a multi-resolution fashion to remove heavy-tail noise. In this paper, we propose a way how to approximate a function from its noisy samples by subdivision schemes.

The linear and symmetric refinement rules of the DD schemes and their dual counterparts (Dyn et al., 2005) are based on local polynomial interpolation. These schemes are stationary in the sense that the same rules are applied at all localities in all subdivision steps, and their approximation order is determined by the degree of the local interpolating polynomials.

In this paper we generalize this approach and propose linear and symmetric refinement rules based on local polynomial approximation, where the polynomial is determined by a least squares fit to the data. We call these schemes least squares schemes. The least squares schemes are designed to fit noisy data. Indeed, our numerical experiments indicate that in some cases these schemes outperform an advanced linear regression method.

A very recent paper (Mustafa et al., 2015) computes refined values by local 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                      optimization rather than by local least squares. The lack of explicit expressions for the refined values of the 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                      optimization enables experimental results only, which are compared with the performance of our schemes.

The least squares schemes and their tensor-products can also deal with geometric data, consisting of contaminated samples of curves and of surfaces. The performance of such schemes is demonstrated in the last section on two examples of curves and two examples of surfaces.

The paper is organized as follows. We start by introducing the simplest case of least squares schemes in Section 2. These schemes are based on primal refinement rules and on best fitting linear polynomials to symmetric data points. This is a one parameter family of schemes, with the number of data points as the parameter. We prove convergence and smoothness of these schemes and investigate properties of their basic limit functions. The construction of least squares schemes based on best fitting polynomials of higher degrees and on dual refinement rules is postponed to Section 4. In Section 3 we review a statistical model for fitting noisy data, analyze the suitability of the primal least squares schemes of degree 1 for dealing with this kind of data, and provide several numerical examples. Further numerical examples for primal schemes based on best fitting polynomials of higher degrees are presented in Section 4.4. Section 5 shows the application of the least squares schemes and their tensor-product to geometrical data. Throughout this paper we use several well-known properties of least squares polynomials. A short survey of these properties and a method for the efficient evaluation of our schemes are given in Appendix A.

In this paper we consider the univariate setting. We denote by 
                        
                           
                              f
                           
                           
                              k
                           
                        
                        =
                        
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              )
                           
                           
                              i
                              ∈
                              Z
                           
                        
                      the data at refinement level 
                        k
                        ∈
                        
                           
                              N
                           
                           
                              0
                           
                        
                     . We assume that the initial data 
                        
                           
                              f
                           
                           
                              0
                           
                        
                        =
                        
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           
                              i
                              ∈
                              Z
                           
                        
                      is given at the integers 
                        Z
                      and that 
                        
                           
                              f
                           
                           
                              i
                           
                           
                              k
                           
                        
                      is associated with the dyadic point 
                        
                           
                              t
                           
                           
                              i
                           
                           
                              k
                           
                        
                        =
                        
                           
                              2
                           
                           
                              −
                              k
                           
                        
                        i
                     . The main idea of least squares subdivision is to generate the data at level 
                        k
                        +
                        1
                      by evaluating a polynomial that locally fits the data at level k in a symmetric neighborhood.

In particular, we use polynomials that best fit the data in the least squares sense. That is, for given data 
                        
                           
                              y
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              y
                           
                           
                              m
                           
                        
                      at nodes 
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              m
                           
                        
                     , we are interested in the polynomial 
                        
                           
                              p
                           
                           
                              d
                           
                        
                      of degree d that minimizes the sum of squared residuals,
                        
                           (1)
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      For 
                        d
                        <
                        m
                      this problem has a unique solution and in Appendix A we provide a summary of the relevant theory, which also includes the case 
                        d
                        ≥
                        m
                     .

We start by considering the simplest least squares subdivision schemes corresponding to the case 
                        d
                        =
                        1
                     , which we denote by 
                        
                           
                              S
                           
                           
                              n
                           
                        
                      for 
                        n
                        ≥
                        1
                     . Such a scheme generates the data at level 
                        k
                        +
                        1
                      as follows. On the one hand, the value 
                        
                           
                              f
                           
                           
                              2
                              i
                           
                           
                              k
                              +
                              1
                           
                        
                     , which replaces 
                        
                           
                              f
                           
                           
                              i
                           
                           
                              k
                           
                        
                     , is determined by fitting a linear polynomial to the 
                        2
                        n
                        −
                        1
                      data values in a symmetric neighborhood around 
                        
                           
                              t
                           
                           
                              i
                           
                           
                              k
                           
                        
                      and evaluating it at the associated dyadic point 
                        
                           
                              t
                           
                           
                              i
                           
                           
                              k
                           
                        
                        =
                        
                           
                              t
                           
                           
                              2
                              i
                           
                           
                              k
                              +
                              1
                           
                        
                     . On the other hand, the scheme computes the new value 
                        
                           
                              f
                           
                           
                              2
                              i
                              +
                              1
                           
                           
                              k
                              +
                              1
                           
                        
                      between 
                        
                           
                              f
                           
                           
                              i
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              f
                           
                           
                              i
                              +
                              1
                           
                           
                              k
                           
                        
                      by evaluating at 
                        
                           
                              t
                           
                           
                              2
                              i
                              +
                              1
                           
                           
                              k
                              +
                              1
                           
                        
                        =
                        1
                        /
                        2
                        (
                        
                           
                              t
                           
                           
                              i
                           
                           
                              k
                           
                        
                        +
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                           
                              k
                           
                        
                        )
                      the linear least squares polynomial with respect to the data at the nearest 2n nodes. In this construction the parameter n controls the locality of the scheme and we study its effect in Section 3.

For the case 
                        d
                        =
                        1
                      and equidistant nodes 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        a
                        +
                        i
                        h
                     , let 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                      be the linear least squares polynomial which minimizes (1). The value of 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                      at the centre 
                        c
                        =
                        (
                        
                           
                              x
                           
                           
                              1
                           
                        
                        +
                        ⋯
                        +
                        
                           
                              x
                           
                           
                              m
                           
                        
                        )
                        /
                        m
                      of the nodes is
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              c
                              )
                              =
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    y
                                 
                                 
                                    m
                                 
                              
                              )
                              /
                              m
                              .
                           
                        
                      Thus, the refinement rules of 
                        
                           
                              S
                           
                           
                              n
                           
                        
                      turn out to be
                        
                           (2)
                           
                              
                                 
                                    f
                                 
                                 
                                    2
                                    i
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 1
                                 
                                    2
                                    n
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    −
                                    n
                                    +
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                    +
                                    j
                                 
                                 
                                    k
                                 
                              
                              
                              
                              and
                              
                              
                              
                                 
                                    f
                                 
                                 
                                    2
                                    i
                                    +
                                    1
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              
                                 1
                                 
                                    2
                                    n
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    −
                                    n
                                    +
                                    1
                                 
                                 n
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                    +
                                    j
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                      Consequently, the symbol (Dyn, 1992) of the scheme is
                        
                           (3)
                           
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                              (
                              z
                              )
                              =
                              
                                 1
                                 
                                    2
                                    n
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    −
                                    n
                                    +
                                    1
                                 
                                 n
                              
                              
                                 
                                    z
                                 
                                 
                                    2
                                    j
                                    −
                                    1
                                 
                              
                              +
                              
                                 1
                                 
                                    2
                                    n
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    −
                                    n
                                    +
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    2
                                    j
                                 
                              
                              .
                           
                        
                     
                  

It follows from the symmetry of the nodes determining the linear least squares polynomials, that 
                        
                           
                              a
                           
                           
                              n
                           
                        
                        (
                        z
                        )
                        =
                        
                           
                              a
                           
                           
                              n
                           
                        
                        (
                        1
                        /
                        z
                        )
                     , hence the scheme is odd symmetric (Dyn et al., 2008). As the data at level 
                        k
                        +
                        1
                      depends on at most 2n values at level k, we conclude that 
                        
                           
                              S
                           
                           
                              n
                           
                        
                      is a primal 2n-point scheme. The masks of the first three schemes are
                        
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       =
                                    
                                    
                                       [
                                       1
                                       ,
                                       2
                                       ,
                                       1
                                       ]
                                    
                                    
                                       /
                                       2
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       =
                                    
                                    
                                       [
                                       3
                                       ,
                                       4
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       3
                                       ]
                                    
                                    
                                       /
                                       12
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       =
                                    
                                    
                                       [
                                       5
                                       ,
                                       6
                                       ,
                                       5
                                       ,
                                       6
                                       ,
                                       5
                                       ,
                                       6
                                       ,
                                       5
                                       ,
                                       6
                                       ,
                                       5
                                       ,
                                       6
                                       ,
                                       5
                                       ]
                                    
                                    
                                       /
                                       30
                                       .
                                    
                                 
                              
                           
                        
                      Note that the scheme 
                        
                           
                              S
                           
                           
                              1
                           
                        
                      is the interpolating 2-point scheme, which generates piecewise linear functions in the limit.

Following the usual definition of convergence in Dyn (2002, Chapter 2), we denote the limit of a convergent subdivision scheme S for initial data 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                         by 
                           
                              
                                 S
                              
                              
                                 ∞
                              
                           
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                        .


                        
                           Theorem 1
                           
                              The least squares subdivision scheme 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                               
                              is convergent for 
                              
                                 n
                                 ≥
                                 1
                              
                              .
                           

The explicit form of the symbol in (3) implies that 
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 1
                                 )
                                 =
                                 2
                               and 
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                                 =
                                 0
                              , which are necessary conditions for 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                               to be convergent (Dyn, 1992, Proposition 2.1). In addition, since the coefficients of the symbol in (3) are all positive, and there are at least three such coefficients, it follows from Cavaretta et al. (1991, Theorem 3.3) that the scheme is convergent.  □

Following the analysis in Dyn (1992), we define
                           
                              (4)
                              
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       z
                                       )
                                    
                                    
                                       1
                                       +
                                       z
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       (
                                       2
                                       n
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    (
                                    
                                       ∑
                                       
                                          j
                                          =
                                          −
                                          n
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    (
                                    n
                                    −
                                    j
                                    )
                                    
                                       
                                          z
                                       
                                       
                                          2
                                          j
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          =
                                          −
                                          n
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    (
                                    n
                                    +
                                    j
                                    )
                                    
                                       
                                          z
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         which is the symbol of the difference scheme associated with 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                        . The norm of this scheme,
                           
                              
                                 ‖
                                 
                                    
                                       S
                                    
                                    
                                       [
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 =
                                 max
                                 ⁡
                                 
                                    {
                                    
                                       1
                                       
                                          2
                                          n
                                          (
                                          2
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          −
                                          n
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    |
                                    n
                                    −
                                    j
                                    |
                                    ,
                                    
                                       1
                                       
                                          2
                                          n
                                          (
                                          2
                                          n
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          −
                                          n
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    |
                                    n
                                    +
                                    j
                                    |
                                    }
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       (
                                       2
                                       n
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       2
                                       n
                                       −
                                       1
                                    
                                 
                                 j
                                 =
                                 
                                    1
                                    2
                                 
                                 ,
                              
                           
                         is the least possible, as in the case of the uniform B-spline schemes, indicating “quickest” possible convergence. The structure of 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                         further reveals that the limit functions generated by 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         are 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        .


                        
                           Theorem 2
                           
                              The least squares subdivision scheme 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                               
                              generates 
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               
                              limit functions for 
                              
                                 n
                                 ≥
                                 2
                              
                              .
                           


                        
                           Proof
                           It is known (Dyn, 1992, Theorems 3.2 and 3.4) that in order to prove the theorem, it is sufficient to show that the scheme with symbol 
                                 2
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                               is convergent. By (4),
                                 
                                    
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       1
                                       )
                                       =
                                       2
                                       
                                       
                                       and
                                       
                                       
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       1
                                       )
                                       =
                                       0
                                       ,
                                    
                                 
                               hence 
                                 
                                    
                                       S
                                    
                                    
                                       [
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                 
                               satisfies the necessary conditions for convergence. As in the proof of Theorem 1 we conclude that the scheme 
                                 
                                    
                                       S
                                    
                                    
                                       [
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                 
                              , 
                                 n
                                 ≥
                                 2
                               is convergent, and therefore 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                              , 
                                 n
                                 ≥
                                 2
                               generates 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               limit functions.  □

The statement in Theorem 2 is confirmed by the numerical results presented in Table 1
                        , which were obtained by using 16 iterations of the algorithm in Dyn and Levin (2002) to compute lower bounds on the Hölder regularity. In addition, it is easy to verify that 
                           
                              
                                 q
                              
                              
                                 n
                              
                              
                                 ′
                              
                           
                           (
                           −
                           1
                           )
                           <
                           0
                         and therefore 
                           
                              
                                 (
                                 1
                                 +
                                 z
                                 )
                              
                              
                                 2
                              
                           
                         is not a factor of 
                           
                              
                                 q
                              
                              
                                 n
                              
                           
                           (
                           z
                           )
                         or equivalently that 
                           
                              
                                 (
                                 1
                                 +
                                 z
                                 )
                              
                              
                                 3
                              
                           
                         is not a factor of 
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           (
                           z
                           )
                        . Thus, the scheme 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         does not generate 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         limits from any initial data (Dyn et al., 2008).

Let us denote by 
                           δ
                         the sequence which is zero everywhere except at 0, where it is 1. The basic limit function of the convergent subdivision scheme 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         is then defined as
                           
                              (5)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       ∞
                                    
                                 
                                 δ
                                 .
                              
                           
                         Some examples of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         for small values of n are shown in Fig. 1
                        .

Many properties of a linear subdivision scheme can be derived from its basic limit function. In particular, due to linearity, the limit function generated from the initial data 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              
                                 i
                                 ∈
                                 Z
                              
                           
                         by the scheme 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         has the form
                           
                              (6)
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 −
                                 j
                                 )
                                 .
                              
                           
                        
                     

Our first observation is that the support of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         is 
                           [
                           −
                           2
                           n
                           +
                           1
                           ,
                           2
                           n
                           −
                           1
                           ]
                        , because 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         is a primal 2n-point scheme (Deslauriers and Dubuc, 1989). Moreover, 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         is positive inside its support, because the coefficients of the mask 
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                         are positive in the mask's support, and 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         has the partition of unity property
                           
                              (7)
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 −
                                 j
                                 )
                                 =
                                 1
                                 ,
                              
                           
                         due to the reproduction of constant polynomials by 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                        .

The simple structure of 
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                         further allows us to derive several interesting properties regarding the values of the basic limit function 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         at the integers. These values are of importance, because they constitute the filter which operates on the initial data and generates the final values at the integers. Taking into account that 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         is continuous and therefore vanishes at the end points of its support, we conclude from (6) that the limit at the integers 
                           k
                           ∈
                           Z
                         is
                           
                              (8)
                              
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 (
                                 k
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       2
                                       n
                                       +
                                       2
                                    
                                    
                                       2
                                       n
                                       −
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       k
                                       −
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 j
                                 )
                                 .
                              
                           
                        
                     

The non-zero values of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         at the integers constitute an eigenvector 
                           v
                           =
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              (
                              −
                              2
                              n
                              +
                              2
                              )
                              ,
                              …
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              (
                              2
                              n
                              −
                              2
                              )
                              )
                           
                         corresponding to the eigenvalue 1 of the transposed subdivision matrix (Dyn, 1992), which in this case is the 
                           (
                           4
                           n
                           −
                           3
                           )
                           ×
                           (
                           4
                           n
                           −
                           3
                           )
                         column stochastic, two-slanted band matrix
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                          
                                          
                                             ⋮
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             ⋯
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                          
                                          
                                             ⋮
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         with entries 
                           r
                           =
                           1
                           /
                           (
                           2
                           n
                           −
                           1
                           )
                         and 
                           s
                           =
                           1
                           /
                           (
                           2
                           n
                           )
                        .

The odd symmetry of the mask 
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                         guarantees that 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         is a symmetric function. Thus, the eigenvector 
                           v
                         is also symmetric, as indicated by the structure of 
                           
                              
                                 A
                              
                              
                                 n
                              
                           
                        . Taking these symmetries into account, we get that the vector 
                           
                              
                                 v
                              
                              
                                 ˜
                              
                           
                           =
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              (
                              −
                              2
                              n
                              +
                              2
                              )
                              ,
                              …
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    n
                                 
                              
                              (
                              0
                              )
                              )
                           
                         is an eigenvector corresponding to the eigenvalue 1 of the 
                           (
                           2
                           n
                           −
                           1
                           )
                           ×
                           (
                           2
                           n
                           −
                           1
                           )
                         matrix
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                          
                                          
                                             ⋮
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             ⋯
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                          
                                          
                                             ⋮
                                          
                                          
                                          
                                          
                                             ⋱
                                          
                                          
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                          
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             ⋯
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             2
                                             r
                                          
                                          
                                             2
                                             s
                                          
                                          
                                             r
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         The particular structure of 
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 n
                              
                           
                         allows us to derive the following observation.


                        
                           Proposition 3
                           
                              The values of 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                               
                              at the non-positive integers in its support are strictly increasing,
                              
                                 
                                    
                                       0
                                       <
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       2
                                       n
                                       +
                                       2
                                       )
                                       <
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       2
                                       n
                                       +
                                       3
                                       )
                                       <
                                       ⋯
                                       <
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       1
                                       )
                                       <
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       .
                                    
                                 
                               
                              Moreover,
                              
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       n
                                       )
                                       =
                                       
                                          
                                             n
                                             −
                                             1
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Note that each row of 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                               is equal to the previous row plus at least one positive term. Since 
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                               satisfies 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                               and its components 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 i
                                 −
                                 2
                                 n
                                 +
                                 1
                                 )
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 2
                                 n
                                 −
                                 1
                              , are positive, the latter must be strictly increasing.

To establish the second statement, consider the 
                                 (
                                 n
                                 −
                                 1
                                 )
                              -th and the last row of 
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                              ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       (
                                       r
                                       ,
                                       s
                                       ,
                                       r
                                       ,
                                       s
                                       ,
                                       …
                                       ,
                                       r
                                       ,
                                       s
                                       ,
                                       0
                                       )
                                       
                                       
                                       and
                                       
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       (
                                       2
                                       r
                                       ,
                                       2
                                       s
                                       ,
                                       2
                                       r
                                       ,
                                       2
                                       s
                                       ,
                                       …
                                       ,
                                       2
                                       r
                                       ,
                                       2
                                       s
                                       ,
                                       r
                                       )
                                       ,
                                    
                                 
                               and note that
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       …
                                       ,
                                       0
                                       ,
                                       r
                                       )
                                       .
                                    
                                 
                               Then, since
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                       +
                                       r
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       +
                                       r
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       ,
                                    
                                 
                               the second statement follows directly from the definition of 
                                 
                                    
                                       v
                                    
                                    
                                       ˜
                                    
                                 
                              , because 
                                 r
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       −
                                       1
                                    
                                 
                              .  □

By the symmetry of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                        , the statements of Proposition 3 hold analogously for the values of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         at the non-negative integers. As an immediate consequence we have
                           
                              (9)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 j
                                 )
                                 <
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 0
                                 )
                                 ,
                                 
                                 |
                                 j
                                 |
                                 ≥
                                 n
                                 ,
                              
                           
                         as well as the following bounds on 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                           (
                           0
                           )
                        .


                        
                           Corollary 4
                           
                              The value of 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 0
                                 )
                               
                              satisfies
                              
                                 
                                    (10)
                                    
                                       
                                          1
                                          
                                             3
                                             n
                                             −
                                             2
                                          
                                       
                                       <
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       <
                                       
                                          1
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

The upper bound follows from (7) and Proposition 3, because
                                 
                                    
                                       1
                                       =
                                       
                                          ∑
                                          
                                             |
                                             j
                                             |
                                             ≤
                                             2
                                             n
                                             −
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       j
                                       )
                                       >
                                       
                                          ∑
                                          
                                             |
                                             j
                                             |
                                             ≤
                                             n
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       j
                                       )
                                       >
                                       (
                                       2
                                       n
                                       +
                                       1
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       −
                                       n
                                       )
                                       =
                                       
                                          
                                             (
                                             2
                                             n
                                             +
                                             1
                                             )
                                             (
                                             n
                                             −
                                             1
                                             )
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       .
                                    
                                 
                               Using (9), we further have
                                 
                                    
                                       1
                                       =
                                       
                                          ∑
                                          
                                             n
                                             ≤
                                             |
                                             j
                                             |
                                             ≤
                                             2
                                             n
                                             −
                                             2
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       j
                                       )
                                       +
                                       
                                          ∑
                                          
                                             |
                                             j
                                             |
                                             <
                                             n
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       j
                                       )
                                       <
                                       (
                                       2
                                       n
                                       −
                                       2
                                       )
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       +
                                       (
                                       2
                                       n
                                       −
                                       1
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       0
                                       )
                                       ,
                                    
                                 
                               leading to the lower bound.  □


                        Proposition 3 and its consequences clarify the properties of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         at the integers, which are confirmed by the examples in Fig. 1. A further analysis of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         reveals more details, in particular about the asymptotic behavior for large n as well as an improvement in the upper bound in (10).


                        
                           Theorem 5
                           
                              The basic limit function 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                               
                              and its derivative 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                               
                              converge uniformly to the zero function as n grows. More specifically,
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          n
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           We first observe that the masks corresponding to the refinement rules (2) are positive. Thus, for non-negative data such as 
                                 δ
                               we have 
                                 
                                    
                                       ‖
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       δ
                                       )
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 ≤
                                 
                                    
                                       ‖
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       δ
                                       )
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                               for any integers 
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 >
                                 0
                              . We can therefore bound 
                                 
                                    
                                       ‖
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                               from above,
                                 
                                    (11)
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       =
                                       
                                          
                                             ‖
                                             
                                                
                                                   S
                                                
                                                
                                                   n
                                                
                                                
                                                   ∞
                                                
                                             
                                             (
                                             δ
                                             )
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ≤
                                       
                                          
                                             ‖
                                             
                                                
                                                   S
                                                
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             δ
                                             )
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       ∼
                                       
                                          1
                                          n
                                       
                                       .
                                    
                                 
                              
                           

A similar behavior holds for the derivative 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                              , which exists since 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                               generates 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               limits by Theorem 2. To see this, first recall the definition of 
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                               in (4), which implies the relation (Dyn, 1992, Section 2.3)
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             [
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                          
                                             ∞
                                          
                                       
                                       (
                                       Δ
                                       δ
                                       )
                                       (
                                       x
                                       )
                                       ,
                                    
                                 
                               where Δ is the forward difference operator with 
                                 
                                    
                                       (
                                       Δ
                                       δ
                                       )
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 −
                                 1
                              , 
                                 
                                    
                                       (
                                       Δ
                                       δ
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 1
                              , and zero otherwise. This implies 
                                 
                                    
                                       ‖
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 ≤
                                 
                                    
                                       ‖
                                       
                                          
                                             S
                                          
                                          
                                             [
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                       
                                       Δ
                                       δ
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                              . Further note that 
                                 
                                    
                                       S
                                    
                                    
                                       [
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                 
                               has a positive mask 
                                 (
                                 2
                                 
                                    
                                       q
                                    
                                    
                                       n
                                    
                                 
                                 )
                               with coefficients
                                 
                                    (12)
                                    
                                       
                                          
                                             (
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             2
                                             j
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             n
                                             (
                                             2
                                             n
                                             −
                                             1
                                             )
                                          
                                       
                                       (
                                       n
                                       −
                                       j
                                       )
                                       
                                       
                                       and
                                       
                                       
                                       
                                          
                                             (
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             2
                                             j
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             n
                                             (
                                             2
                                             n
                                             −
                                             1
                                             )
                                          
                                       
                                       (
                                       n
                                       +
                                       j
                                       )
                                    
                                 
                               for 
                                 j
                                 =
                                 −
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                               and 
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       2
                                       j
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       2
                                       
                                          
                                             q
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       2
                                       j
                                    
                                 
                                 =
                                 0
                               for 
                                 |
                                 j
                                 |
                                 ≥
                                 n
                              .

A direct calculation yields
                                 
                                    (13)
                                    
                                       |
                                       
                                          
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   [
                                                   2
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ]
                                                
                                             
                                             Δ
                                             δ
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   /
                                                   n
                                                   (
                                                   2
                                                   n
                                                   −
                                                   1
                                                   )
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   −
                                                   2
                                                   n
                                                   −
                                                   1
                                                   <
                                                   j
                                                   <
                                                   2
                                                   n
                                                   −
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   /
                                                   n
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   j
                                                   =
                                                   −
                                                   2
                                                   n
                                                   −
                                                   1
                                                   
                                                   or
                                                   
                                                   j
                                                   =
                                                   2
                                                   n
                                                   −
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               From (12) and (13) we then conclude that each summand in
                                 
                                    (14)
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   [
                                                   2
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   2
                                                
                                             
                                             Δ
                                             δ
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             Z
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             j
                                             −
                                             2
                                             i
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   [
                                                   2
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ]
                                                
                                             
                                             Δ
                                             δ
                                             )
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               is of order 
                                 1
                                 /
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                              , except for at most one summand of order 
                                 1
                                 /
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              . Since there are at most 
                                 2
                                 n
                                 −
                                 1
                               non-zero terms in the sum (14), the order of the sum is 
                                 1
                                 /
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              . Thus, we have 
                                 
                                    
                                       ‖
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 ≤
                                 
                                    
                                       ‖
                                       
                                          
                                             S
                                          
                                          
                                             [
                                             2
                                             
                                                
                                                   q
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                       Δ
                                       δ
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 ∼
                                 1
                                 /
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              .  □


                        Proposition 3 and Theorem 5 provide a good understanding of the basic limit function 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                        , which is supported by our numerical tests.

The schemes 
                        
                           
                              S
                           
                           
                              n
                           
                        
                      for 
                        n
                        >
                        1
                      are designed to deal with noisy data, which is confirmed by the following discussions and experiments. We first introduce a statistical model and then compare the performance of our schemes and an advanced local linear regression method.

Let 
                           f
                           :
                           R
                           →
                           R
                         be a continuous scalar function and suppose we are given a discrete set of noisy samples
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 f
                                 (
                                 i
                                 h
                                 )
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 Z
                                 ,
                              
                           
                         where 
                           
                              
                                 {
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 ∈
                                 Z
                              
                           
                         are independent random variables, normally distributed with zero mean and variance 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        . As an estimator 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         of f we use the limit (6) of 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                        , that is,
                           
                              (15)
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 −
                                 j
                                 )
                                 .
                              
                           
                         Note that 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                           (
                           x
                           )
                         is a random variable and the estimation quality of 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         is given by the expectation of the squared error.

With E denoting the expectation operator, the “bias-variance decomposition” (see e.g., Hastie et al., 2009, Chapter 7) of the expected squared error for 
                           x
                           ∈
                           R
                         is
                           
                              (16)
                              
                                 E
                                 
                                 
                                    [
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          f
                                          (
                                          x
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       −
                                       j
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             Z
                                          
                                       
                                       f
                                       (
                                       j
                                       h
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       −
                                       j
                                       )
                                       −
                                       f
                                       (
                                       x
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

The first term in (16) is the product of the variance of the noise 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         and the function
                           
                              (17)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       −
                                       j
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         The second term is the square of the deterministic approximation error corresponding to data without noise. We first study 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         and come back to the second term later.

It follows from (16) that the effect of the noise on the estimator 
                           
                              
                                 f
                              
                              
                                 ˆ
                              
                           
                         is small if 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         is small, which motivates us to further analyze 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         and establish upper bounds. First note that by (7) and the positivity of 
                           
                              
                                 ϕ
                              
                              
                                 n
                              
                           
                         we have
                           
                              (18)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                                 ≤
                                 1
                                 ,
                              
                           
                         with strict inequality for 
                           n
                           >
                           1
                        , namely for non-interpolatory schemes. For the interpolatory scheme 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                        , we have 
                           
                              
                                 ψ
                              
                              
                                 1
                              
                           
                           (
                           x
                           )
                           =
                           1
                         at 
                           x
                           ∈
                           Z
                        , which matches the common knowledge that interpolation is not appropriate for noisy data. This behavior is confirmed by Fig. 2
                        , which presents several numerical evaluations of 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         and indicates that 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         becomes smaller and tends to be the constant zero function as n grows. This is indeed the case, as the following summary of properties of 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         shows.


                        
                           Theorem 6
                           
                              The function 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                               
                              in 
                              (17) 
                              is positive, symmetric, and periodic with period 1. Moreover,
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ψ
                                                
                                                
                                                   n
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          n
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ψ
                                                
                                                
                                                   n
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           By definition, 
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                               is positive, periodic, and finite. The symmetry of 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                               implies the symmetry of 
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                              . In addition, we have that 
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                               is symmetric about 1/2 due to the periodicity of 
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                              .

The first asymptotic bound follows from the definition of 
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                               in (17) after noting that only 
                                 4
                                 n
                                 −
                                 2
                               terms in the sum are non-zero, and that each term is of order 
                                 1
                                 /
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               by Theorem 5. The second asymptotic bound follows by similar arguments using the chain rule, the explicit bound on 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                 
                               in (11), and the asymptotic bound on 
                                 
                                    
                                       ϕ
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                               in Theorem 5,
                                 
                                    
                                       |
                                       
                                          
                                             ψ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                       ≤
                                       2
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             Z
                                          
                                       
                                       |
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       −
                                       j
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       −
                                       j
                                       )
                                       |
                                       ≤
                                       2
                                       
                                          2
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             Z
                                          
                                       
                                       |
                                       
                                          
                                             ϕ
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       x
                                       −
                                       j
                                       )
                                       |
                                       ∼
                                       
                                          1
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                                □

The second term of the expected squared error in (16) is the deterministic error or the approximation error. We use the approximation order as a standard measure for the quality of the approximation; see for example Dyn and Levin (2002, Chapter 7). For the case of schemes based on linear least squares polynomials, the approximation order is 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        , where h is the distance between the sampled points of the initial data. This observation follows from the polynomial reproduction property of our schemes, that is, the reconstruction of any linear polynomial from its samples.

In conclusion, there is a trade-off between the deterministic approximation error and the effect of the noise on the expected squared error. In particular, higher values of n decrease the effect of noise but increase the deterministic error due to averaging of the values 
                           
                              
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 ∈
                                 Z
                              
                           
                         by weights with a large support.

We illustrate the performance of some of the schemes by several numerical examples, starting from noisy data. We compare their performance with the algorithm of local linear regression (LLR) for local fitting of noisy data. This local estimator around a given data point 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                         is obtained by including kernel weights into the least squares minimization problem in the neighborhood of 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                        ,
                           
                              
                                 
                                    min
                                    
                                       α
                                       ,
                                       β
                                    
                                 
                                 ⁡
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       α
                                       −
                                       β
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 Ker
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 .
                              
                           
                         This approach can be generalized to higher degree polynomials as well; see Härdle et al. (2004, Chapter 4) for more details. Although the concept of LLR is rather simple, it is one of the most important statistical approaches used.

We take the LLR variant which is based on the normal kernel with the kernel parameters chosen dynamically, and we compare it with the limits of several subdivision schemes with different support sizes, for various types of functions and levels of noise. The noise we consider is normally distributed and measured using the signal-to-noise ratio (SNR). The SNR is defined as the ratio between the 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         norm of the signal (true function and additional noise) and the 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         norm of the noise. Thus, when this ratio tends to one, the noise becomes as significant as the signal itself. The standard unit is decibel (dB) which is calculated in a logarithmic scale. We examine the range of (roughly) 1–20 dB and consider 1–5 dB a very high level, 5–7 a high level, and 10–12 a low level of noise. Noise levels 
                           >
                           12
                            
                           dB
                         are considered negligible. In each example we plot the relative approximation error of LLR and the subdivision scheme, as a function of the noise levels. This relative error is defined as the ratio between the norm of the approximation error and the norm of the function.

In the first examples we consider the slowly varying function
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 sin
                                 ⁡
                                 
                                    x
                                    10
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          x
                                          50
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and examine the three subdivision schemes 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 7
                              
                           
                        . Due to the dynamic implementation of LLR, we can use it as a benchmark for all cases. As discussed in Section 3.1, the subdivision scheme 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         with smaller support is more sensitive to the variance of the noise than 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 7
                              
                           
                        . We observe in Fig. 3
                         (left) that for all levels of noise, LLR gives a smaller reconstruction error. The difference in the actual function reconstruction for a specific noise level is illustrated in Fig. 3 (right). The same presentation is repeated for 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 7
                              
                           
                         in Figs. 4 and 5
                        
                        , respectively. For the slowly varying function 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                        , the subdivision scheme 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         behaves almost identically to LLR, while 
                           
                              
                                 S
                              
                              
                                 7
                              
                           
                         is even better. These trials match our theory which suggests that as the support gets larger, the corresponding function 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                           
                         becomes smaller, resulting in a weaker response to noise.

In our second example we sample the oscillatory function
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 cos
                                 ⁡
                                 
                                    
                                       2
                                       x
                                    
                                    5
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          x
                                          40
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         and compare LLR with 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        . The results are presented in Figs. 6 and 7
                        
                         and show that the smaller support of 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         makes it more suitable for these type of functions (except for extremely high noise), while 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         provides inferior results for any reasonable level of noise.

To conclude, we observe from the numerical examples that there is a range of parameters for which a subdivision scheme outperforms LLR. Also, the numerical examples support our understanding about the trade-off between the effect of noise and the deterministic approximation error, as discussed in Section 3.1.

The family of primal least squares schemes of degree 1 can be extended in several ways. We first discuss the extension to dual schemes (Section 4.1), as well as minor variations of both primal and dual schemes (Section 4.2). A further extension relies on fitting least squares polynomials of higher degree (Section 4.3) and we provide a few numerical examples of such schemes (Section 4.4).

The idea of the schemes 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                         in Section 2 is to fit linear least squares polynomials and to evaluate them in a primal way, that is, at the points and the midpoints of the current mesh. Another option is to design subdivision schemes based on dual evaluation (Dyn et al., 2008). The dual least squares scheme 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         is obtained by fitting a linear polynomial to the 2n data values at the points 
                           
                              
                                 t
                              
                              
                                 i
                                 −
                                 n
                                 +
                                 1
                              
                              
                                 k
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 n
                              
                              
                                 k
                              
                           
                         at level k and evaluating this polynomial at 1/4 and 3/4 between 
                           
                              
                                 t
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 k
                              
                           
                         to compute the new data 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                                 +
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        .

The refinement rules of 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         are slightly more complicated to derive than those of the primal schemes, but they still have a rather simple closed form,
                           
                              (19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          6
                                          j
                                          −
                                          3
                                       
                                       
                                          8
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                       +
                                       1
                                    
                                    n
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          6
                                          j
                                          −
                                          3
                                       
                                       
                                          8
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         The corresponding symbol is
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    z
                                    +
                                    
                                       
                                          6
                                          j
                                          +
                                          3
                                       
                                       
                                          8
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                       
                                    
                                    (
                                    1
                                    −
                                    z
                                    )
                                    )
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                       j
                                    
                                 
                                 ,
                              
                           
                         and it is easy to verify that 
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                           (
                           z
                           )
                           z
                           =
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                           (
                           1
                           /
                           z
                           )
                        , which confirms that 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         is an even symmetric scheme (Dyn et al., 2008). Overall we conclude that 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         is a dual 2n-point scheme and the support of its basic limit function 
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         is 
                           [
                           −
                           2
                           n
                           ,
                           2
                           n
                           −
                           1
                           ]
                        . The masks of the first three schemes are
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                       
                                       
                                          [
                                          1
                                          ,
                                          3
                                          ,
                                          3
                                          ,
                                          1
                                          ]
                                       
                                       
                                          /
                                          4
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                       
                                       
                                          [
                                          7
                                          ,
                                          13
                                          ,
                                          9
                                          ,
                                          11
                                          ,
                                          11
                                          ,
                                          9
                                          ,
                                          13
                                          ,
                                          7
                                          ]
                                       
                                       
                                          /
                                          40
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          =
                                       
                                       
                                          [
                                          55
                                          ,
                                          85
                                          ,
                                          61
                                          ,
                                          79
                                          ,
                                          67
                                          ,
                                          73
                                          ,
                                          73
                                          ,
                                          67
                                          ,
                                          79
                                          ,
                                          61
                                          ,
                                          85
                                          ,
                                          55
                                          ]
                                       
                                       
                                          /
                                          420
                                          ,
                                       
                                    
                                 
                              
                           
                         and we recognize 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 1
                              
                           
                         as Chaikin's corner cutting scheme (Chaikin, 1974).

The proofs of Theorems 1 and 2 carry over to the dual schemes, and so the limit functions generated by 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         are at least 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         for 
                           n
                           ≥
                           1
                        . But unlike the primal schemes, the symbols of the dual schemes are divisible by 
                           
                              
                                 (
                                 1
                                 +
                                 z
                                 )
                              
                              
                                 3
                              
                           
                        , and so they may potentially generate 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         limits. However, there is no simple proof as for 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         in Theorem 2, because the symbol 
                           4
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                           (
                           z
                           )
                           /
                           
                              
                                 (
                                 1
                                 +
                                 z
                                 )
                              
                              
                                 2
                              
                           
                         has negative coefficients. Table 2
                         lists lower bounds on the Hölder regularity of the first few schemes, computed using 16 iterations of the algorithm in Dyn and Levin (2002), demonstrating that the limits of 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                         are in fact 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        , at least for 
                           2
                           ≤
                           n
                           ≤
                           10
                        .

In addition to the dual 2n-point schemes 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                           
                        , it is also possible to define dual 
                           (
                           2
                           n
                           +
                           1
                           )
                        -point schemes. These schemes fit a linear polynomial to the 
                           2
                           n
                           +
                           1
                         data values in a symmetric neighborhood around 
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                         and evaluate it at 1/4 the distance to the left (right) neighbor to define the new data 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                                 −
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         (
                           
                              
                                 f
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        ). The resulting refinement rules are
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                       −
                                       1
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                    
                                    n
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          3
                                          j
                                       
                                       
                                          4
                                          n
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                    
                                    n
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          3
                                          j
                                       
                                       
                                          4
                                          n
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         and the support of the corresponding basic limit function is 
                           [
                           −
                           2
                           n
                           −
                           1
                           ,
                           2
                           n
                           ]
                        . The masks of the first three schemes of this kind are
                           
                              
                                 
                                    
                                       
                                          n
                                          =
                                          1
                                          :
                                       
                                       
                                          [
                                          5
                                          ,
                                          11
                                          ,
                                          8
                                          ,
                                          8
                                          ,
                                          11
                                          ,
                                          5
                                          ]
                                       
                                       
                                          /
                                          24
                                          ,
                                       
                                    
                                    
                                       
                                          n
                                          =
                                          2
                                          :
                                       
                                       
                                          [
                                          6
                                          ,
                                          10
                                          ,
                                          7
                                          ,
                                          9
                                          ,
                                          8
                                          ,
                                          8
                                          ,
                                          9
                                          ,
                                          7
                                          ,
                                          10
                                          ,
                                          6
                                          ]
                                       
                                       
                                          /
                                          40
                                          ,
                                       
                                    
                                    
                                       
                                          n
                                          =
                                          3
                                          :
                                       
                                       
                                          [
                                          13
                                          ,
                                          19
                                          ,
                                          14
                                          ,
                                          18
                                          ,
                                          15
                                          ,
                                          17
                                          ,
                                          16
                                          ,
                                          16
                                          ,
                                          17
                                          ,
                                          15
                                          ,
                                          18
                                          ,
                                          14
                                          ,
                                          19
                                          ,
                                          13
                                          ]
                                       
                                       
                                          /
                                          112
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Similarly, we can define primal 
                           (
                           2
                           n
                           +
                           1
                           )
                        -point schemes as variants of the primal 2n-point schemes 
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                        . We simply replace the refinement rule for 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         in (2) by
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       −
                                       n
                                    
                                    n
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                              
                           
                         and keep the rule for 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                                 +
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . For these schemes, the support of the basic limit function is 
                           [
                           −
                           2
                           n
                           ,
                           2
                           n
                           ]
                        , and the masks of the first three schemes are
                           
                              
                                 
                                    
                                       
                                          n
                                          =
                                          1
                                          :
                                       
                                       
                                          [
                                          2
                                          ,
                                          3
                                          ,
                                          2
                                          ,
                                          3
                                          ,
                                          2
                                          ]
                                       
                                       
                                          /
                                          6
                                          ,
                                       
                                    
                                    
                                       
                                          n
                                          =
                                          2
                                          :
                                       
                                       
                                          [
                                          4
                                          ,
                                          5
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          4
                                          ,
                                          5
                                          ,
                                          4
                                          ]
                                       
                                       
                                          /
                                          20
                                          ,
                                       
                                    
                                    
                                       
                                          n
                                          =
                                          3
                                          :
                                       
                                       
                                          [
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ,
                                          7
                                          ,
                                          6
                                          ]
                                       
                                       
                                          /
                                          42
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Adapting the proofs of Theorems 1 and 2, one can show that both variants generate 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         limit functions, and our numerical results demonstrate that the dual 
                           (
                           2
                           n
                           +
                           1
                           )
                        -point schemes are even 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         for 
                           1
                           ≤
                           n
                           ≤
                           10
                        .

The least squares schemes of degree 1 reproduce linear polynomials by construction, but they do not reproduce polynomials of any higher degree. So, their approximation order is only 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        , unless the data is being pre-processed (Dyn et al., 2008). We can improve this by using least squares polynomials of higher degrees 
                           d
                           >
                           1
                        .

To derive the refinement rules at level k, let 
                           
                              
                                 p
                              
                              
                                 n
                                 ,
                                 i
                              
                              
                                 d
                              
                           
                         be the least squares polynomial of degree d for the 
                           2
                           n
                           −
                           1
                         data
                           
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 
                                 j
                                 =
                                 −
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                              
                           
                         in a symmetric neighborhood of 
                           
                              
                                 t
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        , and let 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 n
                                 ,
                                 i
                              
                              
                                 d
                              
                           
                         be the polynomial of degree d that fits the 2n data
                           
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 
                                 j
                                 =
                                 −
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                         in a symmetric neighborhood of 
                           
                              
                                 t
                              
                              
                                 2
                                 i
                                 +
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . The polynomials 
                           
                              
                                 p
                              
                              
                                 n
                                 ,
                                 i
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 n
                                 ,
                                 i
                              
                              
                                 d
                              
                           
                         are well-defined for 
                           d
                           <
                           2
                           n
                           −
                           1
                         and 
                           d
                           <
                           2
                           n
                        , respectively (see Appendix A.1).

The primal 2n-point least squares scheme of degree d is then characterized by the refinement rules
                           
                              (21)
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       n
                                       ,
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                 
                                 and
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 
                                    (
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    /
                                    2
                                    )
                                 
                                 ,
                              
                           
                         which simplifies to the rules in (2) for 
                           d
                           =
                           1
                        . The resulting subdivision scheme 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         reproduces polynomials of degree d by construction, and thus has approximation order 
                           
                              
                                 h
                              
                              
                                 d
                                 +
                                 1
                              
                           
                        . It is well-defined for 
                           d
                           <
                           2
                           n
                        , even though for 
                           d
                           =
                           2
                           n
                           −
                           1
                         the rule for 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is based on an underdetermined problem. In that case we get 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                         (see Remark 9 in Appendix A.1), hence 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 2
                                 n
                                 −
                                 1
                              
                           
                         is the interpolating Dubuc–Deslauriers 2n-point scheme.

As shown in Remark 12 in Appendix A.3, it is sufficient to consider only primal 2n-point least squares schemes of even degree, because 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 2
                                 d
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 2
                                 d
                                 +
                                 1
                              
                           
                         are identical. This also means that the schemes of degree 2d reproduce polynomials of one degree more than expected by construction. This is in accordance to the observation in Dyn et al. (2008) that the reproduction of odd degree polynomials comes “for free” by the primal symmetry. In particular, this shows that the refinement rule of the interpolating 4-point scheme (Dubuc, 1986) for 
                           
                              
                                 f
                              
                              
                                 2
                                 i
                                 +
                                 1
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         can be derived not only from fitting a cubic polynomial to the data 
                           
                              
                                 f
                              
                              
                                 i
                                 −
                                 1
                              
                              
                                 k
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 f
                              
                              
                                 i
                                 +
                                 2
                              
                              
                                 k
                              
                           
                        , but also by fitting a quadratic polynomial in the least squares sense to the same data.

We can also generalize the construction in Section 4.1 and define the dual 2n-point least squares scheme of degree d by the refinement rules
                           
                              (22)
                              
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 
                                    (
                                    (
                                    3
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    /
                                    4
                                    )
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       n
                                       ,
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 
                                    (
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    3
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    /
                                    4
                                    )
                                 
                                 ,
                              
                           
                         which simplify to the rules in (19) for 
                           d
                           =
                           1
                        . Like 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                        , the scheme 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         reproduces polynomials of degree d by construction and its approximation order is 
                           
                              
                                 h
                              
                              
                                 d
                                 +
                                 1
                              
                           
                        . Moreover, the scheme 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 2
                                 n
                                 −
                                 1
                              
                           
                         is the dual 2n-point scheme (Dyn et al., 2005).

Similar constructions lead to primal and dual 
                           (
                           2
                           n
                           +
                           1
                           )
                        -point least squares schemes of degree d, but we omit the details as they are straightforward. Apart from the increased approximation order, these schemes also tend to have a higher smoothness. For example, we verified numerically that the schemes 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 3
                              
                           
                         generate 
                           
                              
                                 C
                              
                              
                                 3
                              
                           
                         limit functions for 
                           n
                           =
                           4
                         and 
                           n
                           =
                           5
                        , but we do not recommend using them, because the rules become more complicated and the benefit of using them for reconstructing functions from noisy data is marginal, as shown in the next section.

The statistical model presented in Section 3.1 is also valid for schemes based on higher degree least squares polynomials, due to the linearity of the schemes (see also Appendix A.2), but proving asymptotic bounds for 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         becomes difficult, because the mask of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         is no longer positive and not given explicitly for 
                           d
                           >
                           1
                        . However, our numerical tests, which are summarized in Table 3
                         and Fig. 8
                        , indicate that the bounds in Theorem 6 for the special case 
                           d
                           =
                           1
                         also hold for 
                           d
                           >
                           1
                        .


                        
                           Conjecture 7
                           
                              Let 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                               
                              be defined as in 
                              (17) 
                              for schemes based on least squares polynomials of degree d. Then,
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ψ
                                                
                                                
                                                   n
                                                
                                                
                                                   d
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          n
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ψ
                                                      
                                                      
                                                         n
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ∼
                                       
                                          1
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

The deterministic error in (16) is strongly related to d. This can be seen by the polynomial reproduction property of our schemes, that is, the reconstruction of any polynomial of degree d from its values at the integers by the limit of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                        . The latter property implies that the approximation order is at least 
                           
                              
                                 h
                              
                              
                                 d
                                 +
                                 1
                              
                           
                        . Thus, for larger d the contribution of the deterministic error decreases, while we conjecture that the effect of the noise increases. This relates to the following predicted behavior of 
                           
                              
                                 ψ
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         with respect to d and n and is supported by the results shown in Fig. 9
                        .


                        
                           Conjecture 8
                           
                              For any fixed support size n and different degrees 
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             n
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                       ≥
                                       
                                          
                                             ψ
                                          
                                          
                                             n
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                       ,
                                       
                                       x
                                       ∈
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                       .
                                    
                                 
                               
                              For any fixed degree d and different support size 
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       x
                                       )
                                       ≥
                                       
                                          
                                             ψ
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       x
                                       )
                                       ,
                                       
                                       x
                                       ∈
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                       .
                                    
                                 
                              
                           

To further back up this conjecture, let us consider some numerical experiments, similar to those in Section 3.2. We first compare the schemes 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 3
                              
                           
                        , applied to noisy data taken from the slowly varying function
                           
                              (23)
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 cos
                                 ⁡
                                 
                                    x
                                    10
                                 
                                 −
                                 
                                    
                                       (
                                       
                                          x
                                          50
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 ,
                              
                           
                         for which the deterministic error is expected to be small. Fig. 10
                         shows that 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 1
                              
                           
                        , which is based on locally fitting linear polynomials, gives better reconstructions, as long as the noise is significant. However, as the noise decays, the deterministic error becomes more relevant and the scheme 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 3
                              
                           
                        , which is based on locally fitting cubic polynomials and therefore has approximation order 
                           
                              
                                 h
                              
                              
                                 4
                              
                           
                        , manages to estimate the function more accurately than 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 1
                              
                           
                        , whose approximation order is only 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        . This example emphasizes the trade-off between the deterministic approximation error and the effect of noise on the expected squared error, and this effect becomes even clearer if we consider the function
                           
                              (24)
                              
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 cos
                                 ⁡
                                 
                                    
                                       2
                                       x
                                    
                                    5
                                 
                                 −
                                 
                                    
                                       (
                                       
                                          x
                                          50
                                       
                                       −
                                       
                                          4
                                          5
                                       
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                         Due to the oscillations of this function, the deterministic error is dominant and the results in Fig. 11
                         confirm that 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 3
                              
                           
                         outperforms 
                           
                              
                                 S
                              
                              
                                 5
                              
                              
                                 1
                              
                           
                         for all noise levels.

Finally, we repeat the experiments with the test functions 
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                         for the schemes 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 9
                              
                              
                                 3
                              
                           
                        , which are both based on locally fitting cubic polynomials but have different support sizes. Fig. 12
                         shows that the larger support helps to smooth out noise if the deterministic error is small. But if the deterministic error is more relevant than the noise, than the smaller support leads to smaller reconstruction errors for all noise levels, as illustrated in Fig. 13
                        .

We conclude the paper by presenting applications of our least squares subdivision schemes to noisy samples of curves and of surfaces. We measure the level of the noise by SNR, although this measure in the geometrical setting is less informative than in the functional setting, because the significance of the noise also depends highly on the geometry.

The parametrization of a curve enables us to apply our univariate subdivision schemes to each of its components. By doing so, we can construct an approximation to the curve from its noisy samples. We introduce two such examples.

The first example consists of an alpha-like curve, given by
                           
                              (25)
                              
                                 x
                                 (
                                 t
                                 )
                                 =
                                 3
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 1
                                 ,
                                 
                                 y
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       5
                                    
                                 
                                 −
                                 2
                                 t
                                 ,
                              
                           
                         sampled equidistantly over 
                           [
                           −
                           1.4
                           ,
                           1.4
                           ]
                        , that is, with samples taken at 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           =
                           −
                           7
                           /
                           5
                           +
                           i
                           h
                        , where 
                           h
                           =
                           14
                           /
                           145
                         and 
                           i
                           =
                           0
                           ,
                           …
                           ,
                           29
                        . This curve and its sample points are shown in Figs. 14(a) and 14(b)
                        . The first set of noisy samples with a relatively low level of noise is shown in Fig. 14(c). We apply 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         (both based on linear fitting, see Section 2) to these samples, giving the limit curves in Figs. 15(a) and 15(b)
                        , respectively. The limits of both schemes retain the general shape of the curve, but a minor artifact appears on the limit curve generated by 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         since it closely fits the noisy samples. Perturbing the samples with high level noise, as seen in Fig. 14(d), reveals an overfitting by the limit curve of 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         in Fig. 15(c), while the limit curve generated by 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         in Fig. 15(d) preserves the topology of the original curve.

In the second example we apply four different least squares schemes to noisy samples of a star-shaped curve, given by
                           
                              (26)
                              
                                 x
                                 (
                                 t
                                 )
                                 =
                                 4
                                 cos
                                 ⁡
                                 (
                                 t
                                 )
                                 +
                                 cos
                                 ⁡
                                 (
                                 4
                                 t
                                 )
                                 ,
                                 
                                 y
                                 (
                                 t
                                 )
                                 =
                                 4
                                 sin
                                 ⁡
                                 (
                                 t
                                 )
                                 −
                                 sin
                                 ⁡
                                 (
                                 4
                                 t
                                 )
                                 .
                              
                           
                         We sample this curve at 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           =
                           i
                           /
                           (
                           100
                           π
                           )
                         for 
                           i
                           =
                           0
                           ,
                           …
                           ,
                           49
                        . This curve and its sample points are shown in Figs. 16(a) and 16(b)
                        . In this example we compare the performance of four schemes: two schemes based on linear fitting, 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        , and two schemes based on cubic fitting, 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                        . As in the first example, we start by investigating the case of low level noise, with the samples shown in Fig. 16(c). The limits of all schemes are presented in the upper row of Fig. 17
                        . They all have the shape of a star, except for the limit of 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        , which is more similar to a pentagon than to a star. By zooming in, it can be seen that the limit curve generated by 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 3
                              
                           
                         suffers from a minor artifact next to its lowest vertex, this being consequence of trying to fit the noisy data. For the set of samples with high level noise in Fig. 16(d), the results confirm our previous observation. Namely, both 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                         generate reasonable results, while the limit curves generated by 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 3
                              
                           
                         suffer from geometrical artifacts caused by oversmoothing and overfitting, respectively. These limits are presented in the lower row of Fig. 17.

Equipped with univariate least squares subdivision schemes, we use tensor-product bivariate schemes based on them. These bivariate schemes are applied to noisy samples of surfaces, given at vertices of quadrilateral grids. Two examples are provided to illustrate the application of these bivariate schemes to noisy data.

The first surface we examine is a torus surface, given by
                           
                              (27)
                              
                                 
                                    x
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    =
                                    cos
                                    ⁡
                                    (
                                    u
                                    )
                                    (
                                    10
                                    +
                                    5
                                    cos
                                    ⁡
                                    (
                                    v
                                    )
                                    )
                                    ,
                                 
                              
                              
                                 
                                    y
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    =
                                    sin
                                    ⁡
                                    (
                                    u
                                    )
                                    (
                                    10
                                    +
                                    5
                                    cos
                                    ⁡
                                    (
                                    v
                                    )
                                    )
                                    ,
                                 
                              
                              
                                 
                                    z
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    =
                                    5
                                    sin
                                    ⁡
                                    (
                                    v
                                    )
                                    ,
                                 
                              
                           
                         sampled every 15 degrees, that is, at 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           =
                           i
                           π
                           /
                           12
                         and 
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           =
                           j
                           π
                           /
                           12
                         for 
                           i
                           ,
                           j
                           =
                           0
                           ,
                           …
                           ,
                           23
                        . This surface and its sample points are shown in Figs. 18(a) and 18(b)
                        . We investigate the limits of the bivariate tensor-product schemes 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        . First, we study the application of these schemes to the samples with low level noise in Fig. 18(c). The limits of both schemes in Figs. 19(a) and 19(b)
                         are fairly good. For the samples with high level noise in Fig. 18(d), the limit of 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         in Fig. 19(c) keeps the general shape but is a poor approximation to the torus, while the limit of 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         in Fig. 19(d) provides a better approximation.

The surface of the second example is not a mathematical surface but a scan of a mechanical element, parameterized by a quadrilateral grid, and given in terms of 
                           49
                           ×
                           81
                           =
                           3969
                         vertices. Figs. 20(a) and 20(b)
                         show the surface and its sample points, respectively. Similarly to the second example in the curve case, we investigate the limit surfaces generated by the four tensor product schemes: 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                        , 
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 4
                              
                              
                                 3
                              
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                        . We compare their limits from a set of samples with a low level of noise and a set of samples with a high level of noise. These sets of samples are given in Figs. 20(c) and 20(d), respectively. The limit surfaces for the samples with low level noise, shown in the upper row of Fig. 21
                        , indicate that 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 6
                              
                              
                                 3
                              
                           
                         outperform the other two schemes. For the samples with high level noise, the performance of 
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                           ⊗
                           
                              
                                 S
                              
                              
                                 5
                              
                           
                         is superior to that of the other three, as can be seen in the lower row of Fig. 21.

@&#ACKNOWLEDGEMENT@&#

We wish to thank Prof. Felix Abramovich for his help in formulating the statistical model for the expected squared error.

In this appendix we derive several properties of least squares polynomials used throughout this paper. Some of the properties can be considered common knowledge, but we present them here in order to keep the paper as self-contained as possible.

Our subdivision schemes are based on least squares polynomial fitting. We denote by 
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                         the space of polynomials of degree at most d. Fitting data 
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                         given at the nodes 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                         by a polynomial 
                           p
                           ∈
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                         with 
                           d
                           <
                           m
                         requires finding the polynomial 
                           
                              
                                 p
                              
                              
                                 ⁎
                              
                           
                         which minimizes the sum of squared errors,
                           
                              (A.1)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       (
                                       p
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         among all 
                           p
                           ∈
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                        . The coefficients 
                           β
                           =
                           (
                           
                              
                                 β
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 β
                              
                              
                                 d
                              
                           
                           )
                         of 
                           
                              
                                 p
                              
                              
                                 ⁎
                              
                           
                           (
                           x
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 d
                              
                           
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                         are typically determined by setting the gradient of the functional in (A.1) to zero, resulting in the normal equations
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 β
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 y
                                 ,
                              
                           
                         where A is the 
                           m
                           ×
                           (
                           d
                           +
                           1
                           )
                         
                        Vandermonde matrix with entries 
                           
                              
                                 A
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 j
                              
                           
                         and 
                           y
                           =
                           (
                           
                              
                                 y
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 y
                              
                              
                                 m
                              
                           
                           )
                         is the data vector. The matrix 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                         is invertible for any set of distinct nodes 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                         and the solution of the normal equations is given by
                           
                              (A.2)
                              
                                 β
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       †
                                    
                                 
                                 y
                                 ,
                              
                           
                         where 
                           
                              
                                 A
                              
                              
                                 †
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 )
                              
                              
                                 −
                                 1
                              
                           
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                         is the Moore–Penrose pseudoinverse (Penrose, 1955) of A.


                        
                           Remark 9
                           If 
                                 d
                                 =
                                 m
                                 −
                                 1
                              , then 
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                               is the unique interpolating polynomial to the data. Furthermore, this ansatz can also be used in the case 
                                 d
                                 ≥
                                 m
                               to pick among all interpolating polynomials the one with the smallest 
                                 
                                    
                                       ℓ
                                    
                                    
                                       2
                                    
                                 
                              -norm of the coefficients 
                                 β
                              . This can be achieved by using 
                                 
                                    
                                       A
                                    
                                    
                                       †
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       A
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                               in (A.2), but then the solution depends on the particular basis of 
                                 
                                    
                                       Π
                                    
                                    
                                       d
                                    
                                 
                               chosen to represent 
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                              . However, 
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              , independently of that choice.

Let us now express the solution 
                           
                              
                                 p
                              
                              
                                 ⁎
                              
                           
                         which minimizes (A.1) for 
                           d
                           <
                           m
                         in terms of orthonormal polynomials. Recall the notion of orthonormal polynomials with respect to a discrete inner product. Let 
                           X
                           =
                           {
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 m
                              
                           
                           }
                         be a set of distinct nodes and define for any two functions 
                           f
                           ,
                           g
                           :
                           R
                           →
                           R
                         the discrete inner product
                           
                              (A.3)
                              
                                 
                                    
                                       〈
                                       f
                                       ,
                                       g
                                       〉
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 g
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

A family 
                           L
                           =
                           {
                           
                              
                                 L
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           }
                         of 
                           k
                           +
                           1
                         polynomials in 
                           
                              
                                 Π
                              
                              
                                 d
                              
                           
                         with 
                           k
                           ≤
                           d
                        , is orthonormal over 
                           X
                         if
                           
                              (A.4)
                              
                                 
                                    
                                       〈
                                       
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                       〉
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 i
                                 ,
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 k
                                 ,
                              
                           
                         where 
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is the standard Kronecker delta, that is, 
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           1
                         for 
                           i
                           =
                           j
                         and 
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           0
                        , otherwise. Under the assumption that 
                           
                              
                                 L
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 Π
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           0
                           ,
                           …
                           ,
                           k
                        , there exists a unique family 
                           L
                         satisfying (A.4). The coefficients of the least squares solution 
                           
                              
                                 p
                              
                              
                                 ⁎
                              
                           
                         with respect to this unique family for 
                           k
                           =
                           d
                         are simply
                           
                              
                                 
                                    
                                       γ
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 X
                                 )
                                 ,
                                 y
                                 〉
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 ,
                              
                           
                         that is,
                           
                              (A.5)
                              
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    d
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 x
                                 )
                                 .
                              
                           
                         For more details, see Eisinberg and Fedele (2007) and the references therein.

A naive implementation of the refinement rules in (21) and (22) for the least squares schemes of higher degree is computationally expensive, because the solution of each least squares problem is equivalent to the solution of a linear system, and it needs to be solved for every new data value 
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . However, it turns out that the subdivision schemes 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         and 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         for 
                           d
                           >
                           1
                         are stationary, just like the schemes of degree 
                           d
                           =
                           1
                        , so that
                           
                              (A.6)
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                       −
                                       2
                                       j
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                         where the coefficients 
                           
                              
                                 {
                                 
                                    
                                       α
                                    
                                    
                                       ℓ
                                    
                                 
                                 }
                              
                              
                                 ℓ
                                 ∈
                                 Z
                              
                           
                         are independent of i and k and only a finite number of these coefficients are non-zero. To see this, we first prove that least squares polynomials are invariant under affine transformations.


                        
                           Proposition 10
                           
                              Let 
                              
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                               
                              be the least squares polynomial of degree d for the data 
                              
                                 y
                                 =
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       m
                                    
                                 
                                 )
                               
                              given at the nodes 
                              
                                 X
                                 =
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 }
                               
                              and let 
                              
                                 φ
                                 (
                                 x
                                 )
                                 =
                                 a
                                 x
                                 +
                                 b
                               
                              with 
                              
                                 a
                                 ≠
                                 0
                               
                              be an affine transformation. Then 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∘
                                 
                                    
                                       φ
                                    
                                    
                                       −
                                       1
                                    
                                 
                               
                              is the least squares polynomial of degree d for the same data y given at the transformed nodes 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 φ
                                 (
                                 X
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 }
                               
                              with 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              , 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              
                              .
                           

Let 
                                 L
                                 =
                                 {
                                 
                                    
                                       L
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                 
                                 }
                               be the unique family of orthonormal polynomials over 
                                 X
                              . Then the family of polynomials 
                                 
                                    
                                       L
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 }
                               with 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                 
                                 ∘
                                 
                                    
                                       φ
                                    
                                    
                                       −
                                       1
                                    
                                 
                              , 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                               is orthonormal over 
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                              , because
                                 
                                    
                                       
                                          
                                             〈
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             〉
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             L
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             〈
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                             〉
                                          
                                          
                                             X
                                          
                                       
                                       =
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       ,
                                    
                                 
                               according to (A.3) and (A.4). The statement then follows using (A.5), since
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             
                                                φ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          x
                                          )
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             ⁎
                                          
                                       
                                       
                                          (
                                          
                                             
                                                φ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          x
                                          )
                                          )
                                       
                                       .
                                    
                                 
                                □

For the derivation of the masks of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         we introduce for 
                           n
                           ≥
                           d
                           ≥
                           1
                         two sets of points
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 {
                                 −
                                 2
                                 n
                                 +
                                 2
                                 ,
                                 −
                                 2
                                 n
                                 +
                                 4
                                 ,
                                 …
                                 ,
                                 2
                                 n
                                 −
                                 2
                                 }
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 {
                                 −
                                 2
                                 n
                                 +
                                 1
                                 ,
                                 −
                                 2
                                 n
                                 +
                                 3
                                 ,
                                 …
                                 ,
                                 2
                                 n
                                 −
                                 1
                                 }
                                 ,
                              
                           
                         and denote the corresponding families of 
                           d
                           +
                           1
                         orthonormal polynomials by
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 .
                              
                           
                        
                     


                        
                           Corollary 11
                           
                              For any 
                              
                                 n
                                 ≥
                                 1
                               
                              and 
                              
                                 d
                                 ≥
                                 1
                               
                              with 
                              
                                 d
                                 <
                                 2
                                 n
                              
                              , the subdivision scheme 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                               
                              is stationary and the coefficients of its mask 
                              
                                 [
                                 
                                    
                                       α
                                    
                                    
                                       −
                                       2
                                       n
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       2
                                       n
                                       −
                                       1
                                    
                                 
                                 ]
                               
                              are
                              
                                 
                                    (A.7)
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          
                                             L
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       −
                                       2
                                       i
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       0
                                       )
                                       ,
                                       
                                       i
                                       =
                                       −
                                       n
                                       +
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             i
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       −
                                       2
                                       i
                                       −
                                       1
                                       )
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       0
                                       )
                                       ,
                                       
                                       i
                                       =
                                       −
                                       n
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                       .
                                    
                                 
                              
                           

Let 
                                 
                                    
                                       L
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                 
                               be the orthonormal polynomials over 
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       −
                                       n
                                       +
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       n
                                       −
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 }
                              . Then, by (21) and (A.5),
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             2
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                l
                                                =
                                                −
                                                n
                                                +
                                                1
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                l
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                +
                                                l
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ,
                                    
                                 
                               Since these nodes relate to the nodes 
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                               by the affine transformation 
                                 φ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       −
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 x
                                 +
                                 2
                                 i
                                 )
                              , that is, 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 φ
                                 (
                                 j
                                 )
                              , 
                                 j
                                 =
                                 −
                                 2
                                 n
                                 +
                                 2
                                 ,
                                 −
                                 2
                                 n
                                 +
                                 4
                                 ,
                                 …
                                 ,
                                 2
                                 n
                                 −
                                 2
                              , we can apply Proposition 10 to get
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             2
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                l
                                                =
                                                −
                                                n
                                                +
                                                1
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          2
                                          l
                                          )
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                +
                                                l
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          
                                             L
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       0
                                       )
                                       =
                                       
                                          ∑
                                          
                                             l
                                             =
                                             −
                                             n
                                             +
                                             1
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                j
                                                =
                                                0
                                             
                                             d
                                          
                                          
                                             
                                                L
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          2
                                          l
                                          )
                                          
                                             
                                                L
                                             
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          0
                                          )
                                          )
                                       
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             +
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       .
                                    
                                 
                               Substituting l by 
                                 l
                                 −
                                 i
                               and comparing terms with 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                               as given in (A.6) we get the coefficients in (A.7). The coefficients with odd indices can be found similarly, replacing 
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                               by 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                              .  □

Explicit formulas for the mask coefficients of the dual schemes 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         and the other variants mentioned in Section 4.3 can be derived analogously.


                        Corollary 11 suggests computing the mask coefficients of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         by evaluating the orthonormal polynomials 
                           
                              
                                 L
                              
                              
                                 n
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                              
                                 i
                              
                           
                        , which can be derived from the explicit formulae for orthonormal polynomials over equidistant nodes in Eisinberg and Fedele (2007, Proposition 2), using Proposition 10 and suitable affine transformations. For example,
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          2
                                          n
                                          −
                                          1
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    x
                                    
                                       
                                          (
                                          2
                                          n
                                          −
                                          2
                                          )
                                          (
                                          2
                                          n
                                          −
                                          1
                                          )
                                          2
                                          n
                                          /
                                          3
                                       
                                    
                                 
                              
                           
                         and
                           
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    1
                                    
                                       
                                          2
                                          n
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    x
                                    
                                       
                                          (
                                          2
                                          n
                                          −
                                          1
                                          )
                                          2
                                          n
                                          (
                                          2
                                          n
                                          +
                                          1
                                          )
                                          /
                                          3
                                       
                                    
                                 
                                 .
                              
                           
                         Note that 
                           
                              
                                 L
                              
                              
                                 n
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                              
                                 1
                              
                           
                         are odd polynomials. Therefore, 
                           
                              
                                 L
                              
                              
                                 n
                              
                              
                                 1
                              
                           
                           (
                           0
                           )
                           =
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                              
                                 1
                              
                           
                           (
                           0
                           )
                           =
                           0
                        , and Corollary 11 confirms that the coefficients of the least squares schemes of degree 
                           d
                           =
                           1
                         are 
                           
                              
                                 α
                              
                              
                                 2
                                 i
                              
                           
                           =
                           1
                           /
                           (
                           2
                           n
                           −
                           1
                           )
                         and 
                           
                              
                                 α
                              
                              
                                 2
                                 i
                                 −
                                 1
                              
                           
                           =
                           1
                           /
                           (
                           2
                           n
                           )
                        , as stated in (2).


                        
                           Remark 12
                           More generally, it follows from the formula in Eisinberg and Fedele (2007) that 
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                               are odd polynomials for odd i and even polynomials otherwise. Thus, 
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                 
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                    
                                       2
                                       i
                                       +
                                       1
                                    
                                 
                                 (
                                 0
                                 )
                                 =
                                 0
                              , and so by Corollary 11 the coefficients of the schemes 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       2
                                       d
                                    
                                 
                               and 
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       2
                                       d
                                       +
                                       1
                                    
                                 
                               are identical.

However, a direct algorithm for computing the mask coefficients of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                        , independent of the orthonormal polynomials, is given by the following observation.


                        
                           Proposition 13
                           
                              For any 
                              
                                 n
                                 ≥
                                 1
                               
                              and 
                              
                                 d
                                 ≥
                                 1
                               
                              with 
                              
                                 d
                                 <
                                 2
                                 n
                              
                              , let A and 
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˜
                                    
                                 
                               
                              be the Vandermonde matrices with 
                              
                                 d
                                 +
                                 1
                               
                              columns for the nodes 
                              
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                              
                              , respectively. Further let 
                              
                                 
                                    
                                       A
                                    
                                    
                                       1
                                       ,
                                       •
                                    
                                    
                                       †
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                       ,
                                       •
                                    
                                    
                                       †
                                    
                                 
                               
                              be the first rows of the pseudo-inverses 
                              
                                 
                                    
                                       A
                                    
                                    
                                       †
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       †
                                    
                                 
                              
                              . The mask coefficients of the subdivision scheme 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       d
                                    
                                 
                               
                              are then given by
                              
                                 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             n
                                             −
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             n
                                             −
                                             4
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             −
                                             2
                                             n
                                             +
                                             2
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             1
                                             ,
                                             •
                                          
                                          
                                             †
                                          
                                       
                                       
                                       
                                       
                                          and
                                       
                                       
                                       
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             n
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             n
                                             −
                                             3
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             −
                                             2
                                             n
                                             +
                                             1
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                             ,
                                             •
                                          
                                          
                                             †
                                          
                                       
                                       .
                                    
                                 
                              
                           

For any 
                                 i
                                 ∈
                                 {
                                 −
                                 n
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                                 }
                              , observe that by (A.5) the least squares polynomial over 
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                               for the data 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       −
                                       n
                                       +
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 )
                               with 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                               is of the form
                                 
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             n
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          
                                             L
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       2
                                       i
                                       )
                                       
                                          
                                             L
                                          
                                          
                                             n
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          d
                                       
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                    
                                 
                               where according to (A.2) 
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       †
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              . The statement on the coefficients with even indices then follows from (A.7), because
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             n
                                          
                                          
                                             −
                                             i
                                          
                                       
                                       (
                                       0
                                       )
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             1
                                             ,
                                             n
                                             −
                                             i
                                          
                                          
                                             †
                                          
                                       
                                       .
                                    
                                 
                               The statement regarding the coefficients with odd indices can be derived analogously.  □

Overall, this means that the main cost for computing the mask of 
                           
                              
                                 S
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         is the inversion of the two 
                           (
                           d
                           +
                           1
                           )
                           ×
                           (
                           d
                           +
                           1
                           )
                         matrices 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                         and 
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 T
                              
                           
                           
                              
                                 A
                              
                              
                                 ˆ
                              
                           
                        . The masks of the dual schemes 
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 n
                              
                              
                                 d
                              
                           
                         and the other variants mentioned in Section 4.3 can be computed similarly.

@&#REFERENCES@&#

