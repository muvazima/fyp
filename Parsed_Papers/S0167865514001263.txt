@&#MAIN-TITLE@&#Modelling mammographic microcalcification clusters using persistent mereotopology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel multi-scale shape descriptor using persistent discrete mereotopology.


                        
                        
                           
                           Introduces the mereotopological barcode that brings together work from discrete mereotopology and computational topology.


                        
                        
                           
                           The method is applied to mammographic microcalcifications with results comparable to state of the art.


                        
                        
                           
                           Describes how mereotopological barcodes could be used in a clinical setting.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discrete mereotopology

Image morphology

Mammographic image analysis

Topological image analysis

@&#ABSTRACT@&#


               
               
                  In mammographic imaging, the presence of microcalcifications, small deposits of calcium in the breast, is a primary indicator of breast cancer. However, not all microcalcifications are malignant and their distribution within the breast can be used to indicate whether clusters of microcalcifications are benign or malignant. Computer-aided diagnosis (CAD) systems can be employed to help classify such microcalcification clusters. In this paper a novel method for classifying microcalcification clusters is presented by representing discrete mereotopological relations between the individual microcalcifications over a range of scales in the form of a mereotopological barcode. This barcode based representation is able to model complex relations between multiple regions and the results on mammographic microcalcification data shows the effectiveness of this approach. Classification accuracies of 95% and 80% are achieved on the MIAS and DDSM datasets, respectively. These results are comparable to existing state-of-the art methods. This work also demonstrates that mereotopological barcodes could be used to help trained clinicians in their diagnosis by providing a clinical interpretation of barcodes that represent both benign and malignant cases.
               
            

@&#INTRODUCTION@&#

Breast cancer remains one of the leading forms of cancer, with studies indicating that 1.38 million women were diagnosed with the disease in 2008, accounting for nearly a quarter of all cancer cases worldwide [11]. Although incidence statistics remain high, mortality rates for breast cancer are dropping, thanks in part to improved early detection. One of the most reliable and effective methods for detecting early stage cancer is mammographic screening [33]. Regular screening of women over the age of 50 has proved effective at detecting changes in the breast parenchyma that could lead to the development of cancer [13].

Microcalcifications, as shown in Fig. 1
                     , are small deposits of calcium in breast tissue that appear as small bright spots in mammograms [29,19]. The presence of microcalcification clusters within a mammographic image is a primary sign of breast cancer. The radiological definition of a microcalcification cluster is an area of 1cm2 that contains more than 5 microcalcifications [25,9]. Although the high spatial resolution of mammography enables the detection of microcalcifications at an early stage, not all microcalcification clusters indicate the presence of cancer. Only certain kinds of microcalcification cluster are associated with a high probability of malignancy [30,9], whilst the rest are considered as benign. For clinicians, it is a time consuming and difficult task to identify and classify malignant or benign microcalcifications resulting in a high rate of unnecessary biopsies [7]. To improve diagnostic accuracy, computer-aided diagnosis (CAD) systems have been applied to reduce the false positive rate whilst maintaining sensitivity [7,22].

Various automatic approaches have been suggested to help classify microcalcifications into either benign or malignant [10]. These methods use such features as shape, morphology, cluster based features, and intensity or texture [7,10]. Many of these methods will examine the shape and morphology of individual calcifications [29,19]. However, there are a range of techniques that concentrate on the global, contextual, features of the microcalcification clusters. Two recent and robust methods that use cluster level features are those of Ren [28] and Chen et al. [6]. In [28], features are extracted from the microcalcification clusters before a neural network or support vector machine classifier is used to classify the clusters into either benign or malignant. Chen et al. [6] present a multi-scale topological approach to microcalcification cluster classification by building a multi-scale graph of the inter-microcalcification relationships. Various graph metrics are then extracted from this graph and are fed into a k-nearest neighbour classifier to produce the final classification results.

In this paper a multi-scale topological approach to microcalcification modelling and classification is presented based on extending the area of discrete mereotopology [12] to incorporate persistence. Although topological modelling of microcalcification clusters is not new [6], no investigation has been made into the use of mereotopology for microcalcification classification. By extending the domain of mereotopology to handle persistence — changes in relationships over the growth of a scale parameter — the relationships between microcalcifications within a cluster can be modelled. A novel descriptor, the mereotopological barcode, is used to represent the persistent mereotopology of a microcalcification cluster and is not only useful for classification, but also acts as a visual snapshot of the mereotopology of the cluster, that in turn can be given a direct clinical interpretation.

The remainder of this paper is structured as follows. Section 2 outlines the fundamental building blocks of discrete mereotopology and describes the eight connectivity relationships. In Section 3 mereotopological persistence is introduced with particular emphasis on the mereotopological barcode and its metric space. The data used in the experiments along with the experimental setup is described in Section 4. The results of the experiments are presented in Section 5 and a discussion of these results is made in Section 6. Finally, Section 7 draws conclusions from this work and points to possible paths for future research.

Discrete mereotopology (DM) [12] is a discrete version of classic Region Connection Calculus (RCC) [26] that can also be expressed in terms of mathematical morphology [27]. Throughout this paper, the notation is the same as that of Landini et al. [18] where lower-case letters denote pixels, upper-case letters denote regions, functions are strings of lower-case letters, and predicates are strings of upper-case or lower-case letters prefixed with upper-case letters. As well as this, the symbols used are: 
                        
                           ∧
                        
                      denotes and, 
                        
                           ∨
                        
                      denotes or, 
                        
                           ∀
                        
                      denotes for all, 
                        
                           ∃
                        
                      denotes exists, 
                        
                           →
                        
                      denotes materially implies, 
                        
                           ¬
                        
                      denotes not, and 
                        
                           ≡
                        
                      denotes if and only if.

DM is a first-order spatial logic that brings together mereology — the theory of parthood relations — and topology. In terms of image analysis, mereotopological approaches assume the discrete space (image) is made up of a set of primitive elements (pixels) with a relation, A, that determines which pixels are immediately accessible from any given pixel. This adjacency relation A is both reflexive and symmetric such that 
                        
                           ∀
                           xA
                           (
                           x
                           ,
                           x
                           )
                           ,
                           ∀
                           x
                           ,
                           y
                           (
                           A
                           (
                           x
                           ,
                           y
                           )
                           →
                           A
                           (
                           y
                           ,
                           x
                           )
                           )
                        
                     . Of more interest in DM are regions, denoted by upper case letters, which are sets of arbitrary aggregates of pixels. The simplest region is an atom, which contains exactly one pixel:
                        
                           (1)
                           
                              Atom
                              (
                              X
                              )
                              ≡
                              def
                              
                              ∃
                              xX
                              =
                              {
                              x
                              }
                           
                        
                     
                  

The one-to-one mapping between atoms and pixels is guaranteed via the following axiom given by [27]
                     
                        
                           (2)
                           
                              ∀
                              
                              x
                              
                              ∃
                              
                              X
                              
                              ∀
                              
                              y
                              
                              (
                              y
                              ∈
                              X
                              ↔
                              y
                              =
                              x
                              )
                           
                        
                     
                  

The RCC8D relationships define a set of true mereotopological relations through the introduction of the topological notion of connectivity [27]. The RCC8D relations are discrete versions of the 8 Region Connection Calculus (RCC) relations that describe the possible relationships that exist between regions. The RCC8D relationships can be cast in DM terms using the following topological notion of connection:
                           
                              (3)
                              
                                 C
                                 (
                                 X
                                 ,
                                 Y
                                 )
                                 ≡
                                 def
                                 
                                 ∃
                                 xy
                                 (
                                 x
                                 ∈
                                 X
                                 ∧
                                 y
                                 ∈
                                 Y
                                 ∧
                                 A
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 )
                              
                           
                        where A is the adjacency relation that determines which pixels are accessible from a given pixel [27]. This definition of connectivity along with the set-theoretic relation of inclusion:
                           
                              (4)
                              
                                 X
                                 ⊆
                                 Y
                                 ≡
                                 def
                                 
                                 ∀
                                 x
                                 (
                                 x
                                 ∈
                                 X
                                 →
                                 x
                                 ∈
                                 Y
                                 )
                              
                           
                        allow for the set of full discrete mereotopology relations to be defined. These relations, referred to as RCC8D, are: disconnection (DC), external connection (EC), partial overlap (PO), tangential proper part (TPP) and non tangential proper part (NTPP) along with their inverses (TPPi, NTPPi), and equality (EQ). The tangential proper part relations are built on the idea of parthood (P) and proper parthood (PP) which are defined as
                           
                              (5)
                              
                                 P
                                 (
                                 X
                                 ,
                                 Y
                                 )
                                 ≡
                                 def
                                 
                                 X
                                 ⊆
                                 Y
                                 ∧
                                 X
                                 
                                 ≠
                                 
                                 ∅
                              
                           
                        
                        
                           
                              (6)
                              
                                 PP
                                 (
                                 X
                                 ,
                                 Y
                                 )
                                 ≡
                                 def
                                 
                                 P
                                 (
                                 X
                                 ,
                                 Y
                                 )
                                 ∧
                                 X
                                 
                                 ≠
                                 
                                 Y
                              
                           
                        but are not considered as a member of the RCC8D family of relations. The definition of each of the RCC8D relations are given in the left hand column of Table 1
                        . The eight relationships form a jointly exhaustive pairwise disjoint set which is a discrete analogue of RCC8 [27].

As shown by Randell et al. [27] and Bloch [4], the RCC8D relationships described above can be implemented using mathematical morphology [31]. To do so, the dilation operator, with a 
                           
                              3
                              ×
                              3
                           
                         structuring element B, is used [18]. The mathematical morphology implementations of the RCC8D relations are given in the right hand column of Table 1.

A single measure of discrete mereotopology is often not a rich enough representation to describe the mereotopological relationships of multiple regions. More often than not it is desirable to observe the change in relationships over a range of scales so as to identify important, persistent, regions and relationships. The basic premise of persistent mereotopology is to ‘grow’ the regions in an image by morphologically dilating them at multiple scales. At each scale, the mereotopological relationships between each region are recorded. The change of relationships over the span of all scales is captured in the form of a barcode that provides a visual snapshot of the change in mereotopology over the increase in scales (Fig. 2
                     ). This representation can then be used to distinguish between different microcalcification distributions. Different microcalcification clusters will yield different barcodes because certain features will persist in some cases but not in others. For example, a microcalcification cluster that is tightly packed will contain a large number of PO and NTPP regions that persist throughout the entire lifespan of the barcode and are also ‘born’ quickly (i.e. they begin to appear in the barcode at small scales). In contrast, a microcalcification cluster that is spread out will have persistent DC regions with PO and NTPP regions beginning to appear and persist towards the end of the lifespan. These two definitions are closely related to the clinical definitions of benign and malignant microcalcification clusters [3], whereby a benign microcalcification cluster will be generally spread over a larger area whereas a malignant cluster is more likely to be tightly packed.

The formulation of a mereotopological barcode, an example of which is shown in Fig. 2, is based firmly in existing work from the field of persistent topology [5,8,34]. In persistent topology, a barcode is used to represent a visual snapshot of the filtration of a complex over a range of a ‘growth’ parameter 
                           
                              ∊
                           
                        . The bars in the barcodes, referred to as intervals, indicate the life span of certain topological features. The basic intuition is that the left end point of an interval denotes its birth, the right endpoint signals its death, and the length of the interval can be related to the importance of that topological attribute. This motivates the following definition:
                           Definition 1
                           A mereotopological barcode is defined as a finite family of intervals that are bounded below.

The intervals correspond to mereotopological features (RCC8D relations) that appear in the life of the filtration. A vertical slice through the barcode at a given scale reveals the RCC8D relations between all regions at that scale. More formally, let K denote the indexed disjoint set of all n regions within the image, that is 
                           
                              K
                              =
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    
                                 
                              
                              
                              
                                 
                                    X
                                 
                                 
                                    2
                                 
                              
                              
                              
                                 
                                    
                                 
                              
                              
                              …
                              
                              
                                 
                                    
                                 
                              
                              
                              
                                 
                                    X
                                 
                                 
                                    n
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    
                                 
                              
                           
                         corresponds to the disjoint union operator. Recall that the multi-scale approach is achieved by performing morphological dilation over an increasing range of scales. Therefore, let 
                           
                              
                                 
                                    B
                                 
                                 
                                    ∊
                                 
                              
                           
                         denote a disk structuring element with radius of 
                           
                              ∊
                           
                         pixels, where 
                           
                              ∊
                              ∈
                              φ
                              ⊂
                              
                                 
                                    Z
                                 
                                 
                                    +
                                 
                              
                           
                        . Here, 
                           
                              φ
                           
                         is the set of all possible scales. The image under morphological dilation at a given scale, 
                           
                              ∊
                           
                        , is represented as 
                           
                              K
                              ⊕
                              
                                 
                                    B
                                 
                                 
                                    ∊
                                 
                              
                           
                        . However, since K is a disjoint union of regions, the morphological dilation is performed on a per-region basis such that
                           
                              (7)
                              
                                 K
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       ∊
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       ∊
                                    
                                 
                                 )
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       ∊
                                    
                                 
                                 )
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                 …
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       n
                                    
                                 
                                 ⊕
                                 
                                    
                                       B
                                    
                                    
                                       ∊
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

To simplify notation, the image under dilation at scale parameter 
                           
                              ∊
                           
                         will be represented as 
                           
                              
                                 
                                    K
                                 
                                 
                                    ∊
                                 
                              
                              
                              ≜
                              
                              K
                              ⊕
                              
                                 
                                    B
                                 
                                 
                                    ∊
                                 
                              
                           
                         and similarly a region under dilation is represented 
                           
                              
                                 
                                    X
                                 
                                 
                                    ∊
                                 
                              
                              
                              ≜
                              
                              X
                              ⊕
                              
                                 
                                    B
                                 
                                 
                                    ∊
                                 
                              
                           
                        .

Given that most mammographic microcalcification clusters are composed of more than one microcalcification [24,9], it is reasonable to assume that the image may contain more than one region. As such, the mereotopological barcode needs to encode these multiple relationships. This is done by working on a per-region basis, such that for a given region, 
                           
                              
                                 
                                    X
                                 
                                 
                                    ∊
                                 
                              
                           
                        , its RCC8D relationships are measured with respect to the remaining regions in the set 
                           
                              
                                 
                                    K
                                 
                                 
                                    ∊
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    ∊
                                 
                              
                           
                        . A matching, 
                           
                              N
                           
                        , is therefore used that returns a set of region pairs such that
                           
                              (8)
                              
                                 N
                                 (
                                 
                                    
                                       K
                                    
                                    
                                       ∊
                                    
                                 
                                 )
                                 ⊆
                                 
                                    
                                       K
                                    
                                    
                                       ∊
                                    
                                 
                                 ×
                                 
                                    
                                       K
                                    
                                    
                                       ∊
                                    
                                 
                                 =
                                 {
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                    
                                       ∊
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       j
                                    
                                    
                                       ∊
                                    
                                 
                                 )
                                 
                                 |
                                 i
                                 
                                 ≠
                                 
                                 j
                                 }
                                 .
                              
                           
                        
                     

It is worth noting that the above matching 
                           
                              N
                           
                         is a greedy matching because it seeks a match between every region and every other remaining region. This is not however the only matching available. It is possible to imagine a localised matching that is based on the closest regions as defined by some distance metric. Nevertheless, in this work the greedy matching method is used. The greedy matching returns the set of all possible pairs of regions for which RCC8D relations need to be computed. To achieve this a set of eight binary matrices are introduced — 
                           
                              DC
                           
                        , 
                           
                              EC
                           
                        , 
                           
                              PO
                           
                        , 
                           
                              TPP
                           
                        , 
                           
                              NTPP
                           
                        , 
                           
                              TPPi
                           
                        , 
                           
                              NTPPi
                           
                        , 
                           
                              EQ
                           
                         — to store the RCC8D relationships of each region at a given scale. Each matrix is of size 
                           
                              n
                              ×
                              s
                           
                         where n is the number of regions in the image and s is the total number of scales used. Taking the partial overlap (PO) relation as an example, entry i, j of 
                           
                              PO
                           
                         corresponds to whether the region 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           
                         is partially overlapping any other region at scale j. That is, 
                           
                              
                                 
                                    PO
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              1
                           
                         if 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           
                         partially overlaps with any other region at scale j, and 0 if not.

Collectively these matrices record the change in RCC8D relations over a range of scales. For every scale, 
                           
                              ∊
                              ∈
                              φ
                           
                        , the morphologically dilated regions are computed according to Eq. (7). Then, for each matched pair of regions in 
                           
                              N
                           
                        , the RCC8D relationships are computed and stored in the associated matrices. The matrices therefore contain the relation-specific barcodes with intervals corresponding to sequences of ones across rows of the matrix.

An interval, I, is the pair of integers such that 
                           
                              I
                              =
                              (
                              a
                              ,
                              b
                              )
                           
                        , where a indicates the birth position (the first column containing a 1) of the interval and b indicates its death position (the last column containing a 1). The length of the interval 
                           
                              |
                              I
                              |
                           
                         is given by 
                           
                              |
                              I
                              |
                              =
                              |
                              a
                              -
                              b
                              |
                           
                        . The overall matrix barcode is obtained by concatenating the individual matrices into one 
                           
                              (
                              8
                              n
                              ×
                              s
                              )
                           
                         matrix. A barcode, S, is then composed of a family of intervals such that 
                           
                              S
                              =
                              
                                 
                                    {
                                    
                                       
                                          I
                                       
                                       
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                           
                        .

To employ barcodes as the basis for a classification system a metric needs to be defined over the space of barcodes so that the similarity (distance) between two barcodes can be measured. In this work, we adopt the definition given by Carlsson et al. [5] and Collins et al. [8] for a mereotopological barcode metric.

The definition is in fact a quasi-metric because 
                           
                              ∞
                           
                         is a possible value with 
                           
                              x
                              +
                              ∞
                              =
                              ∞
                           
                         and 
                           
                              ∞
                              +
                              ∞
                              =
                              ∞
                           
                        . Following the definitions given by Carlsson et al. [5], let 
                           
                              I
                           
                         denote the collection of all possible barcodes. A quasi-metric is sought, 
                           
                              D
                              (
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , on all pairs of barcodes, with 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              ∈
                              I
                           
                        , so that if the endpoint of a single interval in either 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         or 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         is changed by a factor of 
                           
                              ∊
                              ,
                              D
                              (
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         changes by no more than 
                           
                              ∊
                           
                        . Given two intervals, denoted I and J, their dissimilarity, 
                           
                              δ
                           
                        , is measured as their symmetric difference such that 
                           
                              δ
                              (
                              I
                              ,
                              J
                              )
                              =
                              μ
                              (
                              I
                              ∪
                              J
                              -
                              I
                              ∩
                              J
                              )
                           
                        . Here 
                           
                              μ
                           
                         is used to denote a one-dimensional measure.

The key insight made by Carlsson et al. [5] and Collins et al. [8] with respect to the barcode metric space is that the distance between two barcodes can be formulated as a matching problem. Given two barcodes, 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                        , a matching can be defined as 
                           
                              M
                              (
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              )
                              ⊆
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              =
                              {
                              (
                              I
                              ,
                              J
                              )
                              |
                              I
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              
                              and
                              
                              J
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              }
                           
                         so that any interval in 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         or 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         occurs in at most one pair 
                           
                              (
                              I
                              ,
                              J
                              )
                           
                        . Let 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                           
                         be the intervals from 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         respectively that are matched in M. Let N corresponds to the set of all unmatched intervals 
                           
                              N
                              =
                              (
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              )
                              ∪
                              (
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . For a specific matching, M, the distance between 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         is
                           
                              (9)
                              
                                 
                                    
                                       D
                                    
                                    
                                       M
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          I
                                          ,
                                          J
                                          )
                                          ∈
                                          M
                                       
                                    
                                 
                                 δ
                                 (
                                 I
                                 ,
                                 J
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          L
                                          ∈
                                          N
                                       
                                    
                                 
                                 μ
                                 (
                                 L
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    L
                                    ∈
                                    N
                                 
                              
                              μ
                              (
                              L
                              )
                           
                         is the sum of lengths of the unmatched intervals.

To calculate the matching between two barcodes 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         the problem is expressed in terms of similarity as opposed to dissimilarity. Given that, for a pair of intervals 
                           
                              (
                              I
                              ,
                              J
                              )
                           
                        , it is known that 
                           
                              δ
                              (
                              I
                              ,
                              J
                              )
                              =
                              μ
                              (
                              I
                              )
                              +
                              μ
                              (
                              J
                              )
                              -
                              2
                              μ
                              (
                              I
                              ∩
                              J
                              )
                           
                        , Carlsson et al. [5] showed that the similarity of two barcodes 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         can be defined as
                           
                              (10)
                              
                                 
                                    
                                       S
                                    
                                    
                                       M
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          I
                                          ,
                                          J
                                          )
                                          ∈
                                          M
                                       
                                    
                                 
                                 μ
                                 (
                                 I
                                 ∩
                                 J
                                 )
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          μ
                                          (
                                          I
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          μ
                                          (
                                          J
                                          )
                                          -
                                          
                                             
                                                D
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          I
                                          ,
                                          J
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

With this definition in place it is possible to see that minimising 
                           
                              
                                 
                                    D
                                 
                                 
                                    M
                                 
                              
                           
                         is the same as maximising 
                           
                              
                                 
                                    S
                                 
                                 
                                    M
                                 
                              
                           
                        . This maximisation takes the form of a graph matching problem. A weighted bipartite graph 
                           
                              G
                              =
                              〈
                              V
                              ,
                              E
                              〉
                           
                         is formed with the vertex set, V, corresponding to the set of all intervals 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ∪
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                        . The edge set E is built by constructing an edge between the vertices corresponding to intervals I and J where 
                           
                              (
                              I
                              ,
                              J
                              )
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                           
                         with edge weight 
                           
                              μ
                              (
                              I
                              ∩
                              J
                              )
                           
                        . As stated by Carlsson et al. [5], with this graph in place, maximising 
                           
                              
                                 
                                    S
                                 
                                 
                                    M
                                 
                              
                           
                         is the same as the maximum weight bipartite matching problem, the solution to which can be found by utilising the Hungarian algorithm [17].

It is now possible to define the quasi-metric over the space of all barcodes:
                           Definition 2
                           The barcode metric can be defined as 
                                 
                                    D
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              .

Classification using mereotopological barcodes can therefore be performed by employing a nearest neighbour based strategy between a test barcode and the set of all training barcodes using the above metric as the distance metric.

The experimentation seeks to assess the efficacy of the proposed mereotopological barcode approach when applied to the task of classifying mammographic microcalcification clusters as either benign or malignant. The data used in the experiments consists of two datasets that are composed of image patches of different cases taken from different mammograms. Although the two datasets contain multiple mammograms, not all of these mammograms will contain microcalcification clusters. As such, the number of patches relating to microcalcification clusters are much lower than the total number of images in the datasets. The first dataset was taken from the MIAS database [32], containing 20 image patches each of size 
                        
                           512
                           ×
                           512
                        
                      pixels. These patches were manually identified and annotated by expert radiologists. The spatial resolution is 
                        
                           50
                           
                           μ
                           m
                           ×
                           50
                           
                           μ
                           m
                        
                      per pixel and quantised to 8 bits with a linear optical density in the range 0–3.2. The second dataset was extracted from the Digital Database for Screening Mammography (DDSM)
                        1
                        DDSM Database available online at: http://marathon.csee.usf.edu/Mammography/Database.html.
                     
                     
                        1
                      database [15] and contains 300 image patches with varying dimensions. The microcalcification patches from this dataset were detected using the approach developed by Oliver et al. [21]. The mammograms in the DDSM database were digitised by one of four different scanners: DBA M2100 ImageClear (42μm per pixel, 16 bits), Howtek 960 (43.5μm per pixel, 12 bits), Lumisys 200 Laser (50μm per pixel, 12 bits), and Howtek MultiRad850 (43.5μm per pixel, 12 bits).

Each image patch from each of the datasets described above contains a microcalcification cluster. The diagnostic status (benign or malignant) of each microcalcification was confirmed by biopsy: for the MIAS dataset there are 9 malignant and 11 benign clusters and for the DDSM dataset there are 141 malignant and 159 benign clusters.

Model selection was used to find the best pair of parameters as well as to avoid introducing any bias into the experimentation. The range of parameters used were 
                           
                              k
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              16
                              }
                           
                        , given that classification was performed using k-nearest neighbours with the barcode metric, and for the size of the structuring element in Eq. (7), 
                           
                              s
                              =
                              {
                              1
                              ,
                              2
                              ,
                              4
                              ,
                              8
                              ,
                              16
                              ,
                              32
                              ,
                              64
                              ,
                              128
                              }
                           
                        .

For both datasets a stratified cross-validation approach was employed to find the hyper parameters (k and s) and perform evaluation. For the DDSM dataset a 3-fold stratified cross-validation was used. The first two folds were used for training and test to find the best performing values of k and s, with performance being assessed based on the area under the ROC curve [2]. Once these best values of k and s were found, the third fold was used for validation with folds one and two being used as training. This was repeated so that every fold was used once for validation.

A nested leave-one-out cross validation was used for the MIAS database. This strategy used 19 of the 20 patches to determine the best performing values of k and s. These values were found by performing an inner leave-one-out cross validation method on the 19 patches. The 1 remaining patch was then used as validation with the remaining 19 used as training with the values of k and s found as a result of the inner-cross validation. This was repeated so that every patch was used as validation and the results were combined.

@&#RESULTS@&#

The results of applying the proposed mereotopological barcode approach to the two datasets described above are shown in Table 2
                     . The overall classification accuracies (CA) are recorded for each dataset as well as the area under the ROC curve (AUC), denoted 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                        
                      
                     [2]. The classification accuracy is defined as the percentage of true positives and true negatives with respect to the total number of objects in the dataset. The area under the ROC curve is used to assess the predictive ability of a classifier. It is a statistically consistent measure which is equivalent to the Wilcoxon signed ranks test [16,20]. The standard errors (SE) associated with the ROC curves are also shown in Table 2. The standard error is defined by Hanley and McNeil [14] as
                        
                           (12)
                           
                              SE
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                z
                                             
                                          
                                          (
                                          1
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                z
                                             
                                          
                                          )
                                          +
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          +
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                b
                                             
                                          
                                          -
                                          1
                                          )
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                A
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                        
                      and 
                        
                           
                              
                                 n
                              
                              
                                 b
                              
                           
                        
                      are the number of malignant and benign cases respectively, and 
                        
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           /
                           (
                           2
                           -
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 Q
                              
                              
                                 2
                              
                           
                           =
                           2
                           
                              
                                 A
                              
                              
                                 z
                              
                              
                                 2
                              
                           
                           /
                           (
                           1
                           +
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           )
                        
                     .

In Table 3
                         the results of the proposed method are compared to those of four existing algorithms for microcalcification cluster classification [6,19,28]. Ma et al. [19] is a simple thresholding approach that assigns a microcalcification cluster as malignant if the corresponding feature of a selected microcalcification is above a certain threshold. The method of Ren [28] extracts multiple features, both intensity and shape related, from each microcalcification and uses a support vector machine (SVM) classifier to achieve the final benign or malignant classification. Chen et al. [6] uses a multi-scale topological approach extracted from a neighbourhood graph of the microcalcifications over multiple scales. For all of these methods the results were obtained on the datasets described in this paper to enable a direct comparison of performance.

@&#DISCUSSION@&#

The results in Table 2 show how well the developed persistent mereotopology approach performs when classifying microcalcification clusters. The MIAS data set provides the best results with CA of 95% being achieved, whilst the DDSM dataset achieves an accuracy of 80%. The 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                        
                      scores for the MIAS and DDSM datasets are 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           =
                           0.80
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           =
                           0.82
                        
                     , respectively.

For the MIAS dataset, the proposed barcodes approach is able to achieve state-of-the-art classification accuracy with 
                        
                           CA
                           =
                           95
                           %
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           =
                           0.80
                        
                     . This is only slightly worse than the leading approach of Chen et al. [6] where a classification accuracy of 
                        
                           CA
                           =
                           95
                           %
                        
                      is achieved with 
                        
                           
                              
                                 A
                              
                              
                                 z
                              
                           
                           =
                           0.96
                        
                     . The results show that mereotopological barcodes are able to sufficiently model the features that discriminate between benign and malignant microcalcification clusters.

When observing the comparison in performance between the proposed approach and existing methods on the DDSM dataset, it is possible to see that the proposed approach does not perform quite as well. There are two possible reasons for this. First, as noted by Oliver et al. [21], the detection results for the DDSM dataset produce lower probability scores than other datasets meaning that the detection algorithm has a lower accuracy on the DDSM dataset. It is worth noting that all the approaches displayed in Table 2 show a drop in performance for the DDSM data. The second possible reason for a drop in performance is to do with the regions being morphologically grown so that they extend beyond the boundary of the image. The DDSM dataset contains image regions of various sizes with some being tightly cropped around the microcalcification cluster. As such, the RCC8D relations become unstable when the regions are grown beyond the boundary of the image. This could lead to unreliable RCC8D measures being taken with a compounding effect on the later classification results.

What is of particular interest is whether the mereotopological barcodes capture the clinical features that are used to discern whether a microcalcification cluster is benign or malignant. Simplistically, benign microcalcifications will usually be larger than those associated with malignancy [1]; as well as this, malignant clusters will tend to be tightly clustered within a smaller area whilst benign clusters are more spread out [3]. With these simple generalisations in mind it is possible to move towards a clinical interpretation of mereotopological barcodes. A barcode that represents a benign microcalcification cluster is expected to have a smaller number of microcalcifications that exhibit disconnected (DC) relationships for a range of lower scales. Over medium to large scales these relationships are expected to transfer from DC to partial overlap (PO). The justification for this becomes apparent when considering the fact that benign calcifications have a tendency to be spread over a larger area with larger microcalcifications [3]. As the mereotopological filtration is grown, the individual microcalcifications will remain disconnected for smaller scales (since they are widely separated) and then will partially overlap for larger scales but not necessarily move to tangential or non-tangential proper parthood since they are large microcalcifications. Similarly, for malignant microcalcifications, the disconnected regions at a small scale will be replaced quickly by partially overlapping regions due to the fact that the microcalcifications are tightly clustered. In addition, tangential or non-tangential proper parthood will be observed at medium to high scales since the microcalcifications are relatively small.


                        Fig. 3
                         shows two barcodes from which it is possible to derive a clinically consistent interpretation. The benign barcode contains mainly disconnected and partially overlapping regions throughout the life of the filtration. However, the malignant barcode contains mainly partially overlapping and non-tangential proper part regions, signifying that the microcalcification cluster is tightly clustered. This clinical interpretation of the mereotopological barcodes is an area that will be further explored in future research. The mereotopological barcode could serve as a visual snapshot of the microcalcification cluster which could be used to further help trained radiologists’ interpretation and diagnosis. At present, work has only investigated the coarse classification of a microcalcification into either benign or malignant. Future work will extend the classification of malignant microcalcifications into intracystic/microcystic calcifications, which layer into ‘tea cup’ shapes on later mammograms, and rounded well circumscribed calcifications which exhibit the typical ‘paw print’ distribution [23].

@&#CONCLUSIONS@&#

In this work a novel approach to modelling the relationships between discrete regions has been presented in the form of mereotopological barcodes. These barcodes encode mereotopological relationships (RCC8D relations) over multiple scales and have proved successful when applied to mammographic microcalcification classification. The results presented are comparable to existing state-of-the-art microcalcification modelling methods. One added benefit of the mereotopological barcode approach is that they can be used as a visual snapshot of the relationships between microcalcifications. This work shows that the barcodes for benign and malignant microcalcification clusters exhibit different properties that can be directly related to features found in the clinical literature. The development of a mereotopological barcode tool to aid clinicians in interpretation and diagnosis is an area of future research.

The work of mereotopological barcodes could be extended by examining different region matching algorithms. The greedy approach presented in this work could be replaced by a localised matching algorithm which could be useful for cases where the number of regions per image is large. From a clinical perspective, future work will investigate how mereotopological barcodes can model different distribution modifiers [1] and so provide a richer classification of microcalcification clusters.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the anonymous reviewers for their comments and insight which helped to shape the final version of this paper. This work was funded in part by the NISCHR Biomedical Research Unit for Advanced Medical Imaging and Visualization.

@&#REFERENCES@&#

